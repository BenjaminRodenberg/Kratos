{
    "Dimension"                      : 3,

    "GravityX"                       : 0.0,
    "GravityY"                       : 0.0,
    "GravityZ"                       : 0.0,
    "RotationOption"                 : false,


    "strategy_parameters"            : {
        "strategy"                   : "plasma_sphere_strategy",
        "RemoveBallsInitiallyTouchingWalls" : false
    },
    "do_print_results_option"        : true,
    "full_particle_history_watcher"  : "Empty",

    "OutputFileType"                 : "ascii",
    "Multifile"                      : "multiple_files",



    "TranslationalIntegrationScheme" : "Symplectic_Euler",
    "RotationalIntegrationScheme"    : "Direct_Integration",
    "MaxTimeStep"                    : 1e-6,
    "FinalTime"                      : 1e-4,
    "ControlTime"                    : 5.0,
    "OutputTimeStep"                 : 1e-6,
    "output_interval"                : 1e-6,

    "coupling_level_type"            : 0,
    "do_search_neighbours" : false,
    "do_solve_dem" : true,

    "ElementType"                    : "IonParticle3D", 
    "echo_level"                     : 1,
    "problem_data"                   : {
        "problem_name"                 : "Particles_in_a_cylinder_under_an_x_oriented_electric_field",
        "parallel_type"                : "OpenMP",
        "echo_level"                   : 1,
        "start_time"                   : 0.0,
        "end_time"                     : 1e-4
    },

    "plasma_dynamics_output_processes" : {
        "gid_output" : [{    
            "python_module" : "gid_output_process",
            "kratos_module" : "KratosMultiphysics",
            "process_name"  : "GiDOutputProcess",
            "help"          : "This process writes postprocessing files for GiD",
            "Parameters"    : {
                "model_part_name"        : "Particles_in_a_cylinder",
                "output_name"            : "Electrically_accelerated_ions",
                "postprocess_parameters" : {
                    "result_file_configuration" : {
                        "gidpost_flags"       : {
                            "GiDPostMode"           : "GiD_PostAscii",
                            "WriteDeformedMeshFlag" : "WriteDeformed",
                            "WriteConditionsFlag"   : "WriteElementsOnly",
                            "MultiFileFlag"         : "MultipleFiles"
                        },
                        "file_label"          : "step",
                        "output_control_type" : "time",
                        "output_frequency"    : 1e-6,
                        "body_output"         : true,
                        "node_output"         : true,
                        "skin_output"         : false,
                        "plane_output"        : [],
                        "nodal_results"       : ["DISPLACEMENT","REACTION","VELOCITY","ACCELERATION"],
                        "gauss_point_results" : []
                    },
                    "point_data_configuration"  : []
                }
            }
        }]
    },

    "meso_scale_length" : 0.0002,

    "dem_nodal_results" : {
        "EXTERNAL_APPLIED_FORCE" : false,
        "ELECTRIC_FIELD_PROJECTED_TO_PARTICLE": false,
        "MACROPARTICLE_ION_DENSITY": false,
        "PARTICLE_ION_VELOCITY" : false
    },

    "fluid_nodal_results" : {"ELECTRIC_POTENTIAL": false,
        "FLUID_ION_DENSITY": false,
        "FLUID_ELECTRON_DENSITY": false,
        "FLUID_NEUTRAL_DENSITY": false,
        "ELECTRIC_FIELD": false,
        "MAGNETIC_FIELD": false
    },
    "fluid_domain_volume"            : 1.0,

    "problem_name"                   : "Plasma_Dynamics_test_particles_in_a_virtual_cylinder",



    "properties": [{
        "model_part_name": "particles_in_a_cylinder",
        "properties_id": 1,
        "plasma_dynamics_law_parameters": {
            "name": "DEM_electromagnetic"
            }
        },
        {"electromagnetic_field_parameters":{
            "external_electric_field_X": 10.0,
            "external_electric_field_Y": 0.0,
            "external_electric_field_Z": 0.0,
            "external_magnetic_field_X": 0.0,
            "external_magnetic_field_Y": 0.0,
            "external_magnetic_field_Z": 0.0
        }
        
    }],

    "fluid_parameters" : {
        "solver_settings"   :{
            "time_stepping": {
                "time_step": 1e-5
            },
            "domain_size": 3
        }
    },

    "dem_parameters" : {
        "problem_data"     : {
            "problem_name"  : "Plasma_Dynamics_test_particles_in_a_virtual_cylinder_DEM",
            "parallel_type" : "OpenMP",
            "echo_level"    : 1,
            "start_time"    : 0.0,
            "end_time"      : 1e-4
        },
        "solver_settings"   :{
            "strategy" : "plasma_sphere_strategy",
            "RemoveBallsInitiallyTouchingWalls" : false
        },
        "do_print_results_option"          : true,
        "Dimension"                        : 3,
        "PeriodicDomainOption"             : true,
        "BoundingBoxOption"                : true,
        "AutomaticBoundingBoxOption"       : false,
        "BoundingBoxEnlargementFactor"     : 1.0,
        "BoundingBoxStartTime"             : 0.0,
        "BoundingBoxStopTime"              : 1000.0,
        "BoundingBoxMaxX"                  : 1000.0,
        "BoundingBoxMaxY"                  : 1000.0,
        "BoundingBoxMaxZ"                  : 1000.0,
        "BoundingBoxMinX"                  : -1000.0,
        "BoundingBoxMinY"                  : -1000.0,
        "BoundingBoxMinZ"                  : -1000.0,

        "dem_inlet_option"                 : false,
        "GravityX"                         : 0.0,
        "GravityY"                         : 0.0,
        "GravityZ"                         : 0.0,

        "VelocityTrapOption"               : false,
        "RotationOption"                   : false,
        "RemoveBallsInEmbeddedOption"      : true,

        "DeltaOption"                      : "Absolute",
        "SearchTolerance"                  : 0.0001,
        "CoordinationNumber"               : 10,
        "AmplifiedSearchRadiusExtension"   : 0.0,
        "ModelDataInfo"                    : false,
        "VirtualMassCoefficient"           : 1.0,
        "RollingFrictionOption"            : false,
        "DontSearchUntilFailure"           : false,
        "ContactMeshOption"                : false,
        "OutputFileType"                   : "ascii",
        "Multifile"                        : "multiple_files",

        "TranslationalIntegrationScheme"   : "Symplectic_Euler",
        "RotationalIntegrationScheme"      : "Direct_Integration",
        "DeltaTimeSafetyFactor"            : 1.0,
        "MaxTimeStep"                      : 1e-6,
        "FinalTime"                        : 1e-4,
        "ControlTime"                      : 5.0,
        "NeighbourSearchFrequency"         : 1,
        "TestType"                         : "None",
        "ElementType"                      : "IonParticle3D",
        "problem_name"                     : "Plasma_Dynamics_test_particles_in_a_virtual_cylinder_DEM",
        "GraphExportFreq"                  : 1e-3,
        "VelTrapGraphExportFreq"           : 1e-3,
        "OutputTimeStep"                   : 0.01,
        "PostDisplacement"                 : true,
        "PostVelocity"                     : true,
        "PostElasticForces"                : false,
        "PostContactForces"                : false,
        "PostRigidElementForces"           : false,
        "PostTangentialElasticForces"      : false,
        "PostTotalForces"                  : false,
        "PostShearStress"                  : false,
        "PostNonDimensionalVolumeWear"     : false,
        "PostNodalArea"                    : false,
        "PostRHS"                          : false,
        "PostDampForces"                   : false,
        "PostAppliedForces"                : false,
        "PostRadius"                       : true,
        "PostGroupId"                      : false,
        "PostExportId"                     : false,
        "PostAngularVelocity"              : false,
        "PostParticleMoment"               : false,
        "PostEulerAngles"                  : false,
        "PostBoundingBox"                  : false
    },

    "custom_dem" : {
        "do_solve_dem" : true,
        "do_search_neighbours" : false,
        "type_of_dem_inlet" : "VelocityImposed",
        "type_of_dem_inlet_comment" : "VelocityImposed or ForceImposed",
        "translational_integration_scheme" : "Symplectic_Euler"
    },   

    "custom_fluid" : {
        "fluid_already_calculated" : false,
        "embedded_option" : false,
        "embedded_option_comment" : "the embedded domain tools are to be used",
        "do_impose_flow_from_field_option" : false,
        "body_force_on_fluid_option" : true,
        "ALE_option" : false,
        "fluid_model_type" : 1,
        "fluid_model_type_comment" : " untouched, velocity incremented by 1/fluid_fraction (0), modified mass conservation only (1)"
    },

    "stationarity" : {
        "stationary_problem_option" : false,
        "stationary_problem_option_comment" : " stationary, stop calculating the fluid after it reaches the stationary state",
        "max_pressure_variation_rate_tol" : 1e-3,
        "max_pressure_variation_rate_tol_comment": " for stationary problems, criterion to stop the fluid calculations",
        "time_steps_per_stationarity_step" : 15,
        "time_steps_per_stationarity_step_comment": " number of fluid time steps between consecutive assessment of stationarity steps",
        "time_steps_per_analytic_processing_step": 1
    },
    
    "coupling" : {
        "coupling_level_type" : 1,
        "coupling_weighing_type" : 2,
        "coupling_weighing_type_comment" : "{fluid_to_DEM, DEM_to_fluid, fluid_fraction} = {lin, lin, imposed} (-1), {lin, const, const} (0), {lin, lin, const} (1), {lin, lin, lin} (2), averaging method (3)",
        "interaction_start_time" : 0.0,
        "time_averaging_type" : 0,

        "backward_coupling" : {
            "meso_scale_length" : 0.2,
            "meso_scale_length_comment" : " the radius of the support of the averaging function for homogenization (<=0 for automatic calculation)",
            "shape_factor" : 0.5,
            "filter_velocity_option" : false,
            "apply_time_filter_to_fluid_fraction_option" : false,
            "min_fluid_fraction" : 0.2,
            "fluid_fraction_grad_type" : 0,
            "calculate_diffusivity_option" : false,
            "viscosity_modification_type" : 0
        }
    },


    "time_stepping" : {
        "automatic_time_step" : false,
        "time_step"           : 1e-6
    }

}
