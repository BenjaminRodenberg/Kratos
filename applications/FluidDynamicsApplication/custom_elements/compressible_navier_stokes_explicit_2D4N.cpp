//    |  /           |
//    ' /   __| _` | __|  _ \   __|
//    . \  |   (   | |   (   |\__ `
//   _|\_\_|  \__,_|\__|\___/ ____/
//                   Multi-Physics
//
//  License:         BSD License
//                   Kratos default license: kratos/license.txt
//
//  Main authors:    Eduard Gómez, Eduard Gómez
//

/**
 *
 *                          WARNING! THIS FILE IS READ-ONLY
 *
 * This file has been auto-generated by compressible_navier_stokes_symbolic_generator.py
 * located in the symbolic_generation directories of the FluidDynamicsApplication
 *
 * Any modifications to this file will be overwritten if and when that script is run again.
 *
 * In order to do any lasting changes, modify the template used by the script:
 * templates/compressible_navier_stokes_explicit_template_2D4N.cpp
 * located in the symbolic_generation directories of the FluidDynamicsApplication.
 *
 * In order to change the formulation you will have to modify the script itself.
 */

// System includes


// External includes


// Project includes
#include "includes/checks.h"
#include "utilities/element_size_calculator.h"

// Application includes
#include "custom_elements/compressible_navier_stokes_explicit.h"


namespace Kratos {

template <>
void CompressibleNavierStokesExplicit<2,4>::EquationIdVector(
    EquationIdVectorType &rResult,
    const ProcessInfo &rCurrentProcessInfo) const
{
    KRATOS_TRY

    if (rResult.size() != DofSize) {
        rResult.resize(DofSize);
    }

    unsigned int local_index = 0;
    const auto& r_geometry = GetGeometry();
    const unsigned int den_pos = r_geometry[0].GetDofPosition(DENSITY);
    const unsigned int mom_pos = r_geometry[0].GetDofPosition(MOMENTUM);
    const unsigned int enr_pos = r_geometry[0].GetDofPosition(TOTAL_ENERGY);
    for (unsigned int i_node = 0; i_node < NumNodes; ++i_node) {
        rResult[local_index++] = r_geometry[i_node].GetDof(DENSITY, den_pos).EquationId();
        rResult[local_index++] = r_geometry[i_node].GetDof(MOMENTUM_X, mom_pos).EquationId();
        rResult[local_index++] = r_geometry[i_node].GetDof(MOMENTUM_Y, mom_pos + 1).EquationId();
        rResult[local_index++] = r_geometry[i_node].GetDof(TOTAL_ENERGY, enr_pos).EquationId();
    }

    KRATOS_CATCH("");
}

template <>
void CompressibleNavierStokesExplicit<2,4>::GetDofList(
    DofsVectorType &ElementalDofList,
    const ProcessInfo &rCurrentProcessInfo) const
{
    KRATOS_TRY

    if (ElementalDofList.size() != DofSize) {
        ElementalDofList.resize(DofSize);
    }

    unsigned int local_index = 0;
    const auto& r_geometry = GetGeometry();
    const unsigned int den_pos = r_geometry[0].GetDofPosition(DENSITY);
    const unsigned int mom_pos = r_geometry[0].GetDofPosition(MOMENTUM);
    const unsigned int enr_pos = r_geometry[0].GetDofPosition(TOTAL_ENERGY);
    for (unsigned int i_node = 0; i_node < NumNodes; ++i_node) {
        ElementalDofList[local_index++] = r_geometry[i_node].pGetDof(DENSITY, den_pos);
        ElementalDofList[local_index++] = r_geometry[i_node].pGetDof(MOMENTUM_X, mom_pos);
        ElementalDofList[local_index++] = r_geometry[i_node].pGetDof(MOMENTUM_Y, mom_pos + 1);
        ElementalDofList[local_index++] = r_geometry[i_node].pGetDof(TOTAL_ENERGY, enr_pos);
    }

    KRATOS_CATCH("");
}


template <>
array_1d<double,3> CompressibleNavierStokesExplicit<2,4>::CalculateMidPointVelocityRotational() const
{
    // Get geometry data
    const auto& r_geom = GetGeometry();
    Geometry<Node<3>>::ShapeFunctionsGradientsType dNdX_container;
    r_geom.ShapeFunctionsIntegrationPointsGradients(dNdX_container, GeometryData::IntegrationMethod::GI_GAUSS_1);
    const auto& r_dNdX = dNdX_container[0];

    // Calculate midpoint magnitudes
    double midpoint_rho = 0.0;
    double midpoint_dmy_dx = 0.0;
    double midpoint_dmx_dy = 0.0;
    double midpoint_rho_dx = 0.0;
    double midpoint_rho_dy = 0.0;
    array_1d<double,3> midpoint_mom = ZeroVector(3);
    for (unsigned int i_node = 0; i_node < NumNodes; ++i_node) {
        auto& r_node = r_geom[i_node];
        const auto node_dNdX = row(r_dNdX, i_node);
        const auto& r_mom = r_node.FastGetSolutionStepValue(MOMENTUM);
        const double& r_rho = r_node.FastGetSolutionStepValue(DENSITY);
        midpoint_rho += r_rho;
        midpoint_mom += r_mom;
        midpoint_dmy_dx += r_mom[1] * node_dNdX[0];
        midpoint_dmx_dy += r_mom[0] * node_dNdX[1];
        midpoint_rho_dx += r_rho * node_dNdX[0];
        midpoint_rho_dy += r_rho * node_dNdX[1];
    }
    midpoint_rho /= static_cast<double>(NumNodes);
    midpoint_mom /= static_cast<double>(NumNodes);

    // Calculate velocity rotational
    // Note that the formulation is written in conservative variables. Hence we do rot(mom/rho).
    const double dvy_dx = (midpoint_dmy_dx * midpoint_rho - midpoint_mom[1] * midpoint_rho_dx) / std::pow(midpoint_rho, 2);
    const double dvx_dy = (midpoint_dmx_dy * midpoint_rho - midpoint_mom[0] * midpoint_rho_dy) / std::pow(midpoint_rho, 2);
    array_1d<double,3> midpoint_rot_v;
    midpoint_rot_v[0] = 0.0;
    midpoint_rot_v[1] = 0.0;
    midpoint_rot_v[2] = dvy_dx - dvx_dy;
    return midpoint_rot_v;
}

template <>
BoundedMatrix<double, 3, 3> CompressibleNavierStokesExplicit<2, 4>::CalculateMidPointVelocityGradient() const
{
    KRATOS_TRY

    // Get geometry data
    const auto& r_geom = GetGeometry();
    Geometry<Node<3>>::ShapeFunctionsGradientsType dNdX_container;
    r_geom.ShapeFunctionsIntegrationPointsGradients(dNdX_container, GeometryData::IntegrationMethod::GI_GAUSS_1);
    const auto& r_dNdX = dNdX_container[0];

    // Calculate midpoint magnitudes
    double midpoint_rho = 0.0;
    double midpoint_dmx_dx = 0.0;
    double midpoint_dmx_dy = 0.0;
    double midpoint_dmy_dx = 0.0;
    double midpoint_dmy_dy = 0.0;
    double midpoint_rho_dx = 0.0;
    double midpoint_rho_dy = 0.0;
    array_1d<double,3> midpoint_mom = ZeroVector(3);
    for (unsigned int i_node = 0; i_node < NumNodes; ++i_node) {
        auto& r_node = r_geom[i_node];
        const auto node_dNdX = row(r_dNdX, i_node);
        const auto& r_mom = r_node.FastGetSolutionStepValue(MOMENTUM);
        const double& r_rho = r_node.FastGetSolutionStepValue(DENSITY);
        midpoint_rho += r_rho;
        midpoint_mom += r_mom;
        midpoint_dmx_dx += r_mom[0] * node_dNdX[0];
        midpoint_dmx_dy += r_mom[0] * node_dNdX[1];
        midpoint_dmy_dx += r_mom[1] * node_dNdX[0];
        midpoint_dmy_dy += r_mom[1] * node_dNdX[1];
        midpoint_rho_dx += r_rho * node_dNdX[0];
        midpoint_rho_dy += r_rho * node_dNdX[1];
    }
    midpoint_rho /= static_cast<double>(NumNodes);
    midpoint_mom /= static_cast<double>(NumNodes);

    // Calculate velocity gradient
    // Note that the formulation is written in conservative variables. Hence we do grad(mom/rho).
    BoundedMatrix<double, 3, 3> midpoint_grad_v = ZeroMatrix(3, 3);
    midpoint_grad_v(0,0) = (midpoint_dmx_dx * midpoint_rho - midpoint_mom[0] * midpoint_rho_dx);
    midpoint_grad_v(0,1) = (midpoint_dmx_dy * midpoint_rho - midpoint_mom[0] * midpoint_rho_dy);
    midpoint_grad_v(1,0) = (midpoint_dmy_dx * midpoint_rho - midpoint_mom[1] * midpoint_rho_dx);
    midpoint_grad_v(1,1) = (midpoint_dmy_dy * midpoint_rho - midpoint_mom[1] * midpoint_rho_dy);
    midpoint_grad_v /= std::pow(midpoint_rho, 2);

    return midpoint_grad_v;

    KRATOS_CATCH("")
}

template <>
void CompressibleNavierStokesExplicit<2,4>::CalculateMomentumProjection(const ProcessInfo& rCurrentProcessInfo)
{
    KRATOS_TRY

    // Struct to pass around the data
    ElementDataStruct data;
    this->FillElementData(data, rCurrentProcessInfo);

    // Calculate shock capturing values
    BoundedVector<double, Dim*NumNodes> mom_proj = ZeroVector(Dim*NumNodes);

    Vector N;
    Matrix DN_DX_iso;
    Matrix DN_DX;
    Matrix Jinv;

    auto& r_geometry = GetGeometry();
    const auto& gauss_points = r_geometry.IntegrationPoints(GeometryData::IntegrationMethod::GI_GAUSS_2);
    for(const auto& gauss_point: gauss_points)
    {
        r_geometry.ShapeFunctionsValues(N, gauss_point.Coordinates());
        r_geometry.InverseOfJacobian(Jinv, gauss_point.Coordinates());
        r_geometry.ShapeFunctionsLocalGradients(DN_DX_iso, gauss_point.Coordinates());
        GeometryUtils::ShapeFunctionsGradients(DN_DX_iso, Jinv, DN_DX);

const double cmom_proj0 =             data.gamma - 1;
const double cmom_proj1 =             N(0)*data.U(0,0) + N(1)*data.U(1,0) + N(2)*data.U(2,0) + N(3)*data.U(3,0);
const double cmom_proj2 =             DN_DX(0,1)*data.U(0,1) + DN_DX(1,1)*data.U(1,1) + DN_DX(2,1)*data.U(2,1) + DN_DX(3,1)*data.U(3,1);
const double cmom_proj3 =             1.0/cmom_proj1;
const double cmom_proj4 =             N(0)*data.U(0,2) + N(1)*data.U(1,2) + N(2)*data.U(2,2) + N(3)*data.U(3,2);
const double cmom_proj5 =             cmom_proj3*cmom_proj4;
const double cmom_proj6 =             DN_DX(0,1)*data.U(0,2) + DN_DX(1,1)*data.U(1,2) + DN_DX(2,1)*data.U(2,2) + DN_DX(3,1)*data.U(3,2);
const double cmom_proj7 =             N(0)*data.U(0,1) + N(1)*data.U(1,1) + N(2)*data.U(2,1) + N(3)*data.U(3,1);
const double cmom_proj8 =             cmom_proj3*cmom_proj7;
const double cmom_proj9 =             DN_DX(0,0)*data.U(0,2) + DN_DX(1,0)*data.U(1,2) + DN_DX(2,0)*data.U(2,2) + DN_DX(3,0)*data.U(3,2);
const double cmom_proj10 =             1.0*cmom_proj0;
const double cmom_proj11 =             DN_DX(0,0)*data.U(0,1) + DN_DX(1,0)*data.U(1,1) + DN_DX(2,0)*data.U(2,1) + DN_DX(3,0)*data.U(3,1);
const double cmom_proj12 =             1.0*data.gamma - 3.0;
const double cmom_proj13 =             pow(cmom_proj1, -2);
const double cmom_proj14 =             cmom_proj13*(DN_DX(0,1)*data.U(0,0) + DN_DX(1,1)*data.U(1,0) + DN_DX(2,1)*data.U(2,0) + DN_DX(3,1)*data.U(3,0));
const double cmom_proj15 =             cmom_proj4*cmom_proj7;
const double cmom_proj16 =             pow(cmom_proj7, 2);
const double cmom_proj17 =             pow(cmom_proj4, 2);
const double cmom_proj18 =             -cmom_proj0*(0.5*cmom_proj16 + 0.5*cmom_proj17);
const double cmom_proj19 =             cmom_proj13*(DN_DX(0,0)*data.U(0,0) + DN_DX(1,0)*data.U(1,0) + DN_DX(2,0)*data.U(2,0) + DN_DX(3,0)*data.U(3,0));
const double cmom_proj20 =             N(0)*data.dUdt(0,1) + N(1)*data.dUdt(1,1) + N(2)*data.dUdt(2,1) + N(3)*data.dUdt(3,1) + cmom_proj0*(DN_DX(0,0)*data.U(0,3) + DN_DX(1,0)*data.U(1,3) + DN_DX(2,0)*data.U(2,3) + DN_DX(3,0)*data.U(3,3)) - cmom_proj1*(N(0)*data.f_ext(0,0) + N(1)*data.f_ext(1,0) + N(2)*data.f_ext(2,0) + N(3)*data.f_ext(3,0)) - cmom_proj10*cmom_proj5*cmom_proj9 - cmom_proj11*cmom_proj12*cmom_proj8 - cmom_proj14*cmom_proj15 - cmom_proj19*(cmom_proj16 + cmom_proj18) + cmom_proj2*cmom_proj5 + cmom_proj6*cmom_proj8;
const double cmom_proj21 =             N(0)*data.dUdt(0,2) + N(1)*data.dUdt(1,2) + N(2)*data.dUdt(2,2) + N(3)*data.dUdt(3,2) + cmom_proj0*(DN_DX(0,1)*data.U(0,3) + DN_DX(1,1)*data.U(1,3) + DN_DX(2,1)*data.U(2,3) + DN_DX(3,1)*data.U(3,3)) - cmom_proj1*(N(0)*data.f_ext(0,1) + N(1)*data.f_ext(1,1) + N(2)*data.f_ext(2,1) + N(3)*data.f_ext(3,1)) - cmom_proj10*cmom_proj2*cmom_proj8 + cmom_proj11*cmom_proj5 - cmom_proj12*cmom_proj5*cmom_proj6 - cmom_proj14*(cmom_proj17 + cmom_proj18) - cmom_proj15*cmom_proj19 + cmom_proj8*cmom_proj9;
            mom_proj[0] += -N(0)*cmom_proj20;
            mom_proj[1] += -N(0)*cmom_proj21;
            mom_proj[2] += -N(1)*cmom_proj20;
            mom_proj[3] += -N(1)*cmom_proj21;
            mom_proj[4] += -N(2)*cmom_proj20;
            mom_proj[5] += -N(2)*cmom_proj21;
            mom_proj[6] += -N(3)*cmom_proj20;
            mom_proj[7] += -N(3)*cmom_proj21;

    }

    // Here we assume that all the weights of the gauss points are the same so we multiply at the end by Volume/NumNodes
    mom_proj *= data.volume / NumNodes;

    // Assembly the projection contributions
    for (IndexType i_node = 0; i_node < NumNodes; ++i_node) {
        const IndexType aux = i_node * Dim;
        auto& r_mom_proj = r_geometry[i_node].GetValue(MOMENTUM_PROJECTION);
        for (IndexType d = 0; d < Dim; ++d) {
            AtomicAdd(r_mom_proj[d], mom_proj[aux + d]);
        }
    }

    KRATOS_CATCH("")
}


template <>
void CompressibleNavierStokesExplicit<2,4>::CalculateDensityProjection(const ProcessInfo& rCurrentProcessInfo)
{
    KRATOS_TRY

    // Struct to pass around the data
    ElementDataStruct data;
    this->FillElementData(data, rCurrentProcessInfo);

    // Calculate shock capturing values
    BoundedVector<double, NumNodes> rho_proj = ZeroVector(NumNodes);

    Vector N;
    Matrix DN_DX_iso;
    Matrix DN_DX;
    Matrix Jinv;

    auto& r_geometry = GetGeometry();
    const auto& gauss_points = r_geometry.IntegrationPoints(GeometryData::IntegrationMethod::GI_GAUSS_2);
    for(const auto& gauss_point: gauss_points)
    {
        r_geometry.ShapeFunctionsValues(N, gauss_point.Coordinates());
        r_geometry.InverseOfJacobian(Jinv, gauss_point.Coordinates());
        r_geometry.ShapeFunctionsLocalGradients(DN_DX_iso, gauss_point.Coordinates());
        GeometryUtils::ShapeFunctionsGradients(DN_DX_iso, Jinv, DN_DX);

const double crho_proj0 =             DN_DX(0,0)*data.U(0,1) + DN_DX(0,1)*data.U(0,2) + DN_DX(1,0)*data.U(1,1) + DN_DX(1,1)*data.U(1,2) + DN_DX(2,0)*data.U(2,1) + DN_DX(2,1)*data.U(2,2) + DN_DX(3,0)*data.U(3,1) + DN_DX(3,1)*data.U(3,2) + N(0)*data.dUdt(0,0) - N(0)*data.m_ext(0) + N(1)*data.dUdt(1,0) - N(1)*data.m_ext(1) + N(2)*data.dUdt(2,0) - N(2)*data.m_ext(2) + N(3)*data.dUdt(3,0) - N(3)*data.m_ext(3);
            rho_proj[0] += -N(0)*crho_proj0;
            rho_proj[1] += -N(1)*crho_proj0;
            rho_proj[2] += -N(2)*crho_proj0;
            rho_proj[3] += -N(3)*crho_proj0;

    }

    // Here we assume that all the weights of the gauss points are the same so we multiply at the end by Volume/NumNodes
    rho_proj *= data.volume / NumNodes;

    // Assembly the projection contributions
    for (IndexType i_node = 0; i_node < NumNodes; ++i_node) {
        AtomicAdd(r_geometry[i_node].GetValue(DENSITY_PROJECTION), rho_proj[i_node]);
    }

    KRATOS_CATCH("")
}


template <>
void CompressibleNavierStokesExplicit<2,4>::CalculateTotalEnergyProjection(const ProcessInfo& rCurrentProcessInfo)
{
    KRATOS_TRY

    // Struct to pass around the data
    ElementDataStruct data;
    this->FillElementData(data, rCurrentProcessInfo);

    // Calculate shock capturing values
    BoundedVector<double, NumNodes> tot_ener_proj = ZeroVector(NumNodes);

    Vector N;
    Matrix DN_DX_iso;
    Matrix DN_DX;
    Matrix Jinv;

    auto& r_geometry = GetGeometry();
    const auto& gauss_points = r_geometry.IntegrationPoints(GeometryData::IntegrationMethod::GI_GAUSS_2);
    for(const auto& gauss_point: gauss_points)
    {
        r_geometry.ShapeFunctionsValues(N, gauss_point.Coordinates());
        r_geometry.InverseOfJacobian(Jinv, gauss_point.Coordinates());
        r_geometry.ShapeFunctionsLocalGradients(DN_DX_iso, gauss_point.Coordinates());
        GeometryUtils::ShapeFunctionsGradients(DN_DX_iso, Jinv, DN_DX);

const double ctot_ener_proj0 =             N(0)*data.U(0,0) + N(1)*data.U(1,0) + N(2)*data.U(2,0) + N(3)*data.U(3,0);
const double ctot_ener_proj1 =             N(0)*data.U(0,1) + N(1)*data.U(1,1) + N(2)*data.U(2,1) + N(3)*data.U(3,1);
const double ctot_ener_proj2 =             N(0)*data.U(0,2) + N(1)*data.U(1,2) + N(2)*data.U(2,2) + N(3)*data.U(3,2);
const double ctot_ener_proj3 =             1.0/ctot_ener_proj0;
const double ctot_ener_proj4 =             ctot_ener_proj3*data.gamma;
const double ctot_ener_proj5 =             pow(ctot_ener_proj0, -2);
const double ctot_ener_proj6 =             data.gamma - 1;
const double ctot_ener_proj7 =             1.0*ctot_ener_proj6;
const double ctot_ener_proj8 =             ctot_ener_proj1*ctot_ener_proj2*ctot_ener_proj5*ctot_ener_proj7;
const double ctot_ener_proj9 =             pow(ctot_ener_proj1, 2);
const double ctot_ener_proj10 =             ctot_ener_proj3*ctot_ener_proj7;
const double ctot_ener_proj11 =             N(0)*data.U(0,3);
const double ctot_ener_proj12 =             N(1)*data.U(1,3);
const double ctot_ener_proj13 =             N(2)*data.U(2,3);
const double ctot_ener_proj14 =             N(3)*data.U(3,3);
const double ctot_ener_proj15 =             pow(ctot_ener_proj2, 2);
const double ctot_ener_proj16 =             ctot_ener_proj3*(0.5*ctot_ener_proj15 + 0.5*ctot_ener_proj9);
const double ctot_ener_proj17 =             ctot_ener_proj11 + ctot_ener_proj12 + ctot_ener_proj13 + ctot_ener_proj14;
const double ctot_ener_proj18 =             ctot_ener_proj6*(-ctot_ener_proj16 + ctot_ener_proj17);
const double ctot_ener_proj19 =             -ctot_ener_proj11 - ctot_ener_proj12 - ctot_ener_proj13 - ctot_ener_proj14 - ctot_ener_proj18;
const double ctot_ener_proj20 =             ctot_ener_proj5*(-ctot_ener_proj16*ctot_ener_proj6 + ctot_ener_proj17 + ctot_ener_proj18);
const double ctot_ener_proj21 =             N(0)*data.dUdt(0,3) + N(1)*data.dUdt(1,3) + N(2)*data.dUdt(2,3) + N(3)*data.dUdt(3,3) - ctot_ener_proj0*(N(0)*data.r_ext(0) + N(1)*data.r_ext(1) + N(2)*data.r_ext(2) + N(3)*data.r_ext(3)) - ctot_ener_proj1*ctot_ener_proj20*(DN_DX(0,0)*data.U(0,0) + DN_DX(1,0)*data.U(1,0) + DN_DX(2,0)*data.U(2,0) + DN_DX(3,0)*data.U(3,0)) + ctot_ener_proj1*ctot_ener_proj4*(DN_DX(0,0)*data.U(0,3) + DN_DX(1,0)*data.U(1,3) + DN_DX(2,0)*data.U(2,3) + DN_DX(3,0)*data.U(3,3)) - ctot_ener_proj1*(N(0)*data.f_ext(0,0) + N(1)*data.f_ext(1,0) + N(2)*data.f_ext(2,0) + N(3)*data.f_ext(3,0)) - ctot_ener_proj2*ctot_ener_proj20*(DN_DX(0,1)*data.U(0,0) + DN_DX(1,1)*data.U(1,0) + DN_DX(2,1)*data.U(2,0) + DN_DX(3,1)*data.U(3,0)) + ctot_ener_proj2*ctot_ener_proj4*(DN_DX(0,1)*data.U(0,3) + DN_DX(1,1)*data.U(1,3) + DN_DX(2,1)*data.U(2,3) + DN_DX(3,1)*data.U(3,3)) - ctot_ener_proj2*(N(0)*data.f_ext(0,1) + N(1)*data.f_ext(1,1) + N(2)*data.f_ext(2,1) + N(3)*data.f_ext(3,1)) - ctot_ener_proj3*(ctot_ener_proj10*ctot_ener_proj15 + ctot_ener_proj19)*(DN_DX(0,1)*data.U(0,2) + DN_DX(1,1)*data.U(1,2) + DN_DX(2,1)*data.U(2,2) + DN_DX(3,1)*data.U(3,2)) - ctot_ener_proj3*(ctot_ener_proj10*ctot_ener_proj9 + ctot_ener_proj19)*(DN_DX(0,0)*data.U(0,1) + DN_DX(1,0)*data.U(1,1) + DN_DX(2,0)*data.U(2,1) + DN_DX(3,0)*data.U(3,1)) - ctot_ener_proj8*(DN_DX(0,0)*data.U(0,2) + DN_DX(1,0)*data.U(1,2) + DN_DX(2,0)*data.U(2,2) + DN_DX(3,0)*data.U(3,2)) - ctot_ener_proj8*(DN_DX(0,1)*data.U(0,1) + DN_DX(1,1)*data.U(1,1) + DN_DX(2,1)*data.U(2,1) + DN_DX(3,1)*data.U(3,1));
            tot_ener_proj[0] += -N(0)*ctot_ener_proj21;
            tot_ener_proj[1] += -N(1)*ctot_ener_proj21;
            tot_ener_proj[2] += -N(2)*ctot_ener_proj21;
            tot_ener_proj[3] += -N(3)*ctot_ener_proj21;

    }

    // Here we assume that all the weights of the gauss points are the same so we multiply at the end by Volume/NumNodes
    tot_ener_proj *= data.volume / NumNodes;

    // Assembly the projection contributions
    for (IndexType i_node = 0; i_node < NumNodes; ++i_node) {
        AtomicAdd(r_geometry[i_node].GetValue(TOTAL_ENERGY_PROJECTION), tot_ener_proj[i_node]);
    }

    KRATOS_CATCH("")
}


template <>
void CompressibleNavierStokesExplicit<2,4>::CalculateRightHandSideInternal(
    BoundedVector<double, DofSize> &rRightHandSideBoundedVector,
    const ProcessInfo &rCurrentProcessInfo)
{
    KRATOS_TRY

    std::fill(rRightHandSideBoundedVector.begin(), rRightHandSideBoundedVector.end(), 0.0);

    // Struct to pass around the data
    ElementDataStruct data;
    this->FillElementData(data, rCurrentProcessInfo);

    // Stabilization parameters
    constexpr double stab_c1 = 12.0;
    constexpr double stab_c2 = 2.0;
    constexpr double stab_c3 = 1.0;

    const auto& r_geometry = GetGeometry();
    const auto& gauss_points = r_geometry.IntegrationPoints(GeometryData::IntegrationMethod::GI_GAUSS_2);

    Vector N;
    Matrix DN_DX_iso;
    Matrix DN_DX;
    Matrix Jinv;

    if (data.UseOSS)
    {
        for(const auto& gauss_point: gauss_points)
        {
            r_geometry.ShapeFunctionsValues(N, gauss_point.Coordinates());
            r_geometry.InverseOfJacobian(Jinv, gauss_point.Coordinates());
            r_geometry.ShapeFunctionsLocalGradients(DN_DX_iso, gauss_point.Coordinates());
            GeometryUtils::ShapeFunctionsGradients(DN_DX_iso, Jinv, DN_DX);

const double crRightHandSideBoundedVector0 =             N(0)*data.m_ext(0);
const double crRightHandSideBoundedVector1 =             N(1)*data.m_ext(1);
const double crRightHandSideBoundedVector2 =             N(2)*data.m_ext(2);
const double crRightHandSideBoundedVector3 =             N(3)*data.m_ext(3);
const double crRightHandSideBoundedVector4 =             crRightHandSideBoundedVector0 + crRightHandSideBoundedVector1 + crRightHandSideBoundedVector2 + crRightHandSideBoundedVector3;
const double crRightHandSideBoundedVector5 =             N(0)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector6 =             DN_DX(0,1)*data.U(0,2);
const double crRightHandSideBoundedVector7 =             DN_DX(1,1)*data.U(1,2);
const double crRightHandSideBoundedVector8 =             DN_DX(2,1)*data.U(2,2);
const double crRightHandSideBoundedVector9 =             DN_DX(3,1)*data.U(3,2);
const double crRightHandSideBoundedVector10 =             crRightHandSideBoundedVector6 + crRightHandSideBoundedVector7 + crRightHandSideBoundedVector8 + crRightHandSideBoundedVector9;
const double crRightHandSideBoundedVector11 =             DN_DX(0,0)*data.U(0,1);
const double crRightHandSideBoundedVector12 =             DN_DX(1,0)*data.U(1,1);
const double crRightHandSideBoundedVector13 =             DN_DX(2,0)*data.U(2,1);
const double crRightHandSideBoundedVector14 =             DN_DX(3,0)*data.U(3,1);
const double crRightHandSideBoundedVector15 =             crRightHandSideBoundedVector11 + crRightHandSideBoundedVector12 + crRightHandSideBoundedVector13 + crRightHandSideBoundedVector14;
const double crRightHandSideBoundedVector16 =             crRightHandSideBoundedVector10 + crRightHandSideBoundedVector15;
const double crRightHandSideBoundedVector17 =             DN_DX(0,0)*data.U(0,0) + DN_DX(1,0)*data.U(1,0) + DN_DX(2,0)*data.U(2,0) + DN_DX(3,0)*data.U(3,0);
const double crRightHandSideBoundedVector18 =             N(0)*data.alpha_sc_nodes(0) + N(1)*data.alpha_sc_nodes(1) + N(2)*data.alpha_sc_nodes(2) + N(3)*data.alpha_sc_nodes(3);
const double crRightHandSideBoundedVector19 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector18;
const double crRightHandSideBoundedVector20 =             DN_DX(0,1)*data.U(0,0) + DN_DX(1,1)*data.U(1,0) + DN_DX(2,1)*data.U(2,0) + DN_DX(3,1)*data.U(3,0);
const double crRightHandSideBoundedVector21 =             crRightHandSideBoundedVector18*crRightHandSideBoundedVector20;
const double crRightHandSideBoundedVector22 =             N(0)*data.U(0,0) + N(1)*data.U(1,0) + N(2)*data.U(2,0) + N(3)*data.U(3,0);
const double crRightHandSideBoundedVector23 =             1.0/crRightHandSideBoundedVector22;
const double crRightHandSideBoundedVector24 =             fabs(crRightHandSideBoundedVector22);
const double crRightHandSideBoundedVector25 =             N(0)*data.U(0,1) + N(1)*data.U(1,1) + N(2)*data.U(2,1) + N(3)*data.U(3,1);
const double crRightHandSideBoundedVector26 =             pow(crRightHandSideBoundedVector25, 2);
const double crRightHandSideBoundedVector27 =             N(0)*data.U(0,2) + N(1)*data.U(1,2) + N(2)*data.U(2,2) + N(3)*data.U(3,2);
const double crRightHandSideBoundedVector28 =             pow(crRightHandSideBoundedVector27, 2);
const double crRightHandSideBoundedVector29 =             data.gamma - 1;
const double crRightHandSideBoundedVector30 =             0.5*crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector31 =             0.5*crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector32 =             crRightHandSideBoundedVector30 + crRightHandSideBoundedVector31;
const double crRightHandSideBoundedVector33 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector32;
const double crRightHandSideBoundedVector34 =             N(0)*data.U(0,3);
const double crRightHandSideBoundedVector35 =             N(1)*data.U(1,3);
const double crRightHandSideBoundedVector36 =             N(2)*data.U(2,3);
const double crRightHandSideBoundedVector37 =             N(3)*data.U(3,3);
const double crRightHandSideBoundedVector38 =             crRightHandSideBoundedVector34 + crRightHandSideBoundedVector35 + crRightHandSideBoundedVector36 + crRightHandSideBoundedVector37;
const double crRightHandSideBoundedVector39 =             -crRightHandSideBoundedVector33 + crRightHandSideBoundedVector38;
const double crRightHandSideBoundedVector40 =             crRightHandSideBoundedVector29*crRightHandSideBoundedVector39;
const double crRightHandSideBoundedVector41 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector42 =             1.0/data.gamma;
const double crRightHandSideBoundedVector43 =             N(0)*data.r_ext(0) + N(1)*data.r_ext(1) + N(2)*data.r_ext(2) + N(3)*data.r_ext(3);
const double crRightHandSideBoundedVector44 =             pow(crRightHandSideBoundedVector43, 2);
const double crRightHandSideBoundedVector45 =             N(0)*data.f_ext(0,0) + N(1)*data.f_ext(1,0) + N(2)*data.f_ext(2,0) + N(3)*data.f_ext(3,0);
const double crRightHandSideBoundedVector46 =             N(0)*data.f_ext(0,1) + N(1)*data.f_ext(1,1) + N(2)*data.f_ext(2,1) + N(3)*data.f_ext(3,1);
const double crRightHandSideBoundedVector47 =             crRightHandSideBoundedVector41*data.gamma*(pow(crRightHandSideBoundedVector45, 2) + pow(crRightHandSideBoundedVector46, 2));
const double crRightHandSideBoundedVector48 =             0.70710678118654757*crRightHandSideBoundedVector24*crRightHandSideBoundedVector42*stab_c3*sqrt((crRightHandSideBoundedVector44 + 2.0*crRightHandSideBoundedVector47 + 2.0*sqrt(0.25*crRightHandSideBoundedVector44 + crRightHandSideBoundedVector47)*fabs(crRightHandSideBoundedVector43))/(pow(crRightHandSideBoundedVector29, 2)*pow(crRightHandSideBoundedVector39, 2))) + stab_c2*(sqrt(crRightHandSideBoundedVector41)*sqrt(data.gamma) + sqrt(crRightHandSideBoundedVector26 + crRightHandSideBoundedVector28)/crRightHandSideBoundedVector24)/data.h;
const double crRightHandSideBoundedVector49 =             1.0*(N(0)*data.ResProj(0,0) + N(0)*data.dUdt(0,0) + N(1)*data.ResProj(1,0) + N(1)*data.dUdt(1,0) + N(2)*data.ResProj(2,0) + N(2)*data.dUdt(2,0) + N(3)*data.ResProj(3,0) + N(3)*data.dUdt(3,0) - crRightHandSideBoundedVector0 - crRightHandSideBoundedVector1 + crRightHandSideBoundedVector16 - crRightHandSideBoundedVector2 - crRightHandSideBoundedVector3)/crRightHandSideBoundedVector48;
const double crRightHandSideBoundedVector50 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector49;
const double crRightHandSideBoundedVector51 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector52 =             crRightHandSideBoundedVector29*crRightHandSideBoundedVector32;
const double crRightHandSideBoundedVector53 =             pow(crRightHandSideBoundedVector22, -2);
const double crRightHandSideBoundedVector54 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector55 =             1.0*data.gamma;
const double crRightHandSideBoundedVector56 =             3.0 - crRightHandSideBoundedVector55;
const double crRightHandSideBoundedVector57 =             crRightHandSideBoundedVector15*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector58 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector57;
const double crRightHandSideBoundedVector59 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector60 =             DN_DX(0,0)*data.U(0,2);
const double crRightHandSideBoundedVector61 =             DN_DX(1,0)*data.U(1,2);
const double crRightHandSideBoundedVector62 =             DN_DX(2,0)*data.U(2,2);
const double crRightHandSideBoundedVector63 =             DN_DX(3,0)*data.U(3,2);
const double crRightHandSideBoundedVector64 =             crRightHandSideBoundedVector60 + crRightHandSideBoundedVector61 + crRightHandSideBoundedVector62 + crRightHandSideBoundedVector63;
const double crRightHandSideBoundedVector65 =             1.0*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector66 =             crRightHandSideBoundedVector64*crRightHandSideBoundedVector65;
const double crRightHandSideBoundedVector67 =             -crRightHandSideBoundedVector59*crRightHandSideBoundedVector66;
const double crRightHandSideBoundedVector68 =             DN_DX(0,0)*data.U(0,3) + DN_DX(1,0)*data.U(1,3) + DN_DX(2,0)*data.U(2,3) + DN_DX(3,0)*data.U(3,3);
const double crRightHandSideBoundedVector69 =             DN_DX(0,1)*data.U(0,1);
const double crRightHandSideBoundedVector70 =             DN_DX(1,1)*data.U(1,1);
const double crRightHandSideBoundedVector71 =             DN_DX(2,1)*data.U(2,1);
const double crRightHandSideBoundedVector72 =             DN_DX(3,1)*data.U(3,1);
const double crRightHandSideBoundedVector73 =             crRightHandSideBoundedVector69 + crRightHandSideBoundedVector70 + crRightHandSideBoundedVector71 + crRightHandSideBoundedVector72;
const double crRightHandSideBoundedVector74 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector73;
const double crRightHandSideBoundedVector75 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector74;
const double crRightHandSideBoundedVector76 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector77 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector78 =             crRightHandSideBoundedVector53*crRightHandSideBoundedVector77;
const double crRightHandSideBoundedVector79 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector76 - crRightHandSideBoundedVector25*crRightHandSideBoundedVector78 + crRightHandSideBoundedVector29*crRightHandSideBoundedVector68 + crRightHandSideBoundedVector67 + crRightHandSideBoundedVector75;
const double crRightHandSideBoundedVector80 =             N(0)*data.mu_sc_nodes(0);
const double crRightHandSideBoundedVector81 =             N(1)*data.mu_sc_nodes(1);
const double crRightHandSideBoundedVector82 =             N(2)*data.mu_sc_nodes(2);
const double crRightHandSideBoundedVector83 =             N(3)*data.mu_sc_nodes(3);
const double crRightHandSideBoundedVector84 =             crRightHandSideBoundedVector80 + crRightHandSideBoundedVector81 + crRightHandSideBoundedVector82 + crRightHandSideBoundedVector83 + data.mu;
const double crRightHandSideBoundedVector85 =             crRightHandSideBoundedVector23*stab_c1/pow(data.h, 2);
const double crRightHandSideBoundedVector86 =             1.0/(crRightHandSideBoundedVector48 + 1.3333333333333333*crRightHandSideBoundedVector84*crRightHandSideBoundedVector85);
const double crRightHandSideBoundedVector87 =             crRightHandSideBoundedVector86*(N(0)*data.ResProj(0,1) + N(0)*data.dUdt(0,1) + N(1)*data.ResProj(1,1) + N(1)*data.dUdt(1,1) + N(2)*data.ResProj(2,1) + N(2)*data.dUdt(2,1) + N(3)*data.ResProj(3,1) + N(3)*data.dUdt(3,1) - crRightHandSideBoundedVector51 + crRightHandSideBoundedVector54*(-crRightHandSideBoundedVector26 + crRightHandSideBoundedVector52) + crRightHandSideBoundedVector56*crRightHandSideBoundedVector58 + crRightHandSideBoundedVector79);
const double crRightHandSideBoundedVector88 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector89 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector90 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector91 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector90;
const double crRightHandSideBoundedVector92 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector93 =             crRightHandSideBoundedVector65*crRightHandSideBoundedVector73;
const double crRightHandSideBoundedVector94 =             -crRightHandSideBoundedVector92*crRightHandSideBoundedVector93;
const double crRightHandSideBoundedVector95 =             DN_DX(0,1)*data.U(0,3) + DN_DX(1,1)*data.U(1,3) + DN_DX(2,1)*data.U(2,3) + DN_DX(3,1)*data.U(3,3);
const double crRightHandSideBoundedVector96 =             crRightHandSideBoundedVector15*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector97 =             crRightHandSideBoundedVector25*crRightHandSideBoundedVector64;
const double crRightHandSideBoundedVector98 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector97;
const double crRightHandSideBoundedVector99 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector100 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector101 =             -crRightHandSideBoundedVector100*crRightHandSideBoundedVector99 + crRightHandSideBoundedVector23*crRightHandSideBoundedVector96 + crRightHandSideBoundedVector29*crRightHandSideBoundedVector95 + crRightHandSideBoundedVector94 + crRightHandSideBoundedVector98;
const double crRightHandSideBoundedVector102 =             crRightHandSideBoundedVector86*(N(0)*data.ResProj(0,2) + N(0)*data.dUdt(0,2) + N(1)*data.ResProj(1,2) + N(1)*data.dUdt(1,2) + N(2)*data.ResProj(2,2) + N(2)*data.dUdt(2,2) + N(3)*data.ResProj(3,2) + N(3)*data.dUdt(3,2) + crRightHandSideBoundedVector101 + crRightHandSideBoundedVector56*crRightHandSideBoundedVector91 - crRightHandSideBoundedVector88 + crRightHandSideBoundedVector89*(-crRightHandSideBoundedVector28 + crRightHandSideBoundedVector52));
const double crRightHandSideBoundedVector103 =             DN_DX(0,1)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector104 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector105 =             -crRightHandSideBoundedVector104 + crRightHandSideBoundedVector22*crRightHandSideBoundedVector64;
const double crRightHandSideBoundedVector106 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector107 =             -crRightHandSideBoundedVector106 + crRightHandSideBoundedVector22*crRightHandSideBoundedVector73;
const double crRightHandSideBoundedVector108 =             crRightHandSideBoundedVector84*(crRightHandSideBoundedVector105 + crRightHandSideBoundedVector107);
const double crRightHandSideBoundedVector109 =             crRightHandSideBoundedVector15*crRightHandSideBoundedVector22 - crRightHandSideBoundedVector99;
const double crRightHandSideBoundedVector110 =             2*crRightHandSideBoundedVector84;
const double crRightHandSideBoundedVector111 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector22 - crRightHandSideBoundedVector77;
const double crRightHandSideBoundedVector112 =             (crRightHandSideBoundedVector109 + crRightHandSideBoundedVector111)*(-N(0)*data.beta_sc_nodes(0) - N(1)*data.beta_sc_nodes(1) - N(2)*data.beta_sc_nodes(2) - N(3)*data.beta_sc_nodes(3) + 0.66666666666666663*crRightHandSideBoundedVector80 + 0.66666666666666663*crRightHandSideBoundedVector81 + 0.66666666666666663*crRightHandSideBoundedVector82 + 0.66666666666666663*crRightHandSideBoundedVector83 + 0.66666666666666663*data.mu);
const double crRightHandSideBoundedVector113 =             crRightHandSideBoundedVector109*crRightHandSideBoundedVector110 + crRightHandSideBoundedVector112;
const double crRightHandSideBoundedVector114 =             DN_DX(0,0)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector115 =             -crRightHandSideBoundedVector52;
const double crRightHandSideBoundedVector116 =             crRightHandSideBoundedVector115 + crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector117 =             crRightHandSideBoundedVector55 - 3.0;
const double crRightHandSideBoundedVector118 =             crRightHandSideBoundedVector117*crRightHandSideBoundedVector57;
const double crRightHandSideBoundedVector119 =             -crRightHandSideBoundedVector116*crRightHandSideBoundedVector54 - crRightHandSideBoundedVector118*crRightHandSideBoundedVector23 + crRightHandSideBoundedVector79;
const double crRightHandSideBoundedVector120 =             N(0)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector121 =             DN_DX(0,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector122 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector121;
const double crRightHandSideBoundedVector123 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector77;
const double crRightHandSideBoundedVector124 =             crRightHandSideBoundedVector123*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector125 =             -2*crRightHandSideBoundedVector124 + crRightHandSideBoundedVector74 + crRightHandSideBoundedVector76;
const double crRightHandSideBoundedVector126 =             N(0)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector127 =             1.0*crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector128 =             1.0*crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector129 =             crRightHandSideBoundedVector29*(-crRightHandSideBoundedVector127 - crRightHandSideBoundedVector128);
const double crRightHandSideBoundedVector130 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector131 =             crRightHandSideBoundedVector118 + crRightHandSideBoundedVector130*(crRightHandSideBoundedVector129 + 2*crRightHandSideBoundedVector26) + crRightHandSideBoundedVector27*crRightHandSideBoundedVector66;
const double crRightHandSideBoundedVector132 =             DN_DX(0,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector133 =             crRightHandSideBoundedVector106*crRightHandSideBoundedVector23 - crRightHandSideBoundedVector69 - crRightHandSideBoundedVector70 - crRightHandSideBoundedVector71 - crRightHandSideBoundedVector72;
const double crRightHandSideBoundedVector134 =             N(0)*crRightHandSideBoundedVector133;
const double crRightHandSideBoundedVector135 =             crRightHandSideBoundedVector55 - 1.0;
const double crRightHandSideBoundedVector136 =             crRightHandSideBoundedVector104*crRightHandSideBoundedVector23 - crRightHandSideBoundedVector60 - crRightHandSideBoundedVector61 - crRightHandSideBoundedVector62 - crRightHandSideBoundedVector63;
const double crRightHandSideBoundedVector137 =             N(0)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector138 =             crRightHandSideBoundedVector102*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector139 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector99;
const double crRightHandSideBoundedVector140 =             -crRightHandSideBoundedVector11 - crRightHandSideBoundedVector12 - crRightHandSideBoundedVector13 + crRightHandSideBoundedVector139 - crRightHandSideBoundedVector14;
const double crRightHandSideBoundedVector141 =             N(0)*crRightHandSideBoundedVector140;
const double crRightHandSideBoundedVector142 =             DN_DX(0,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector143 =             DN_DX(0,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector144 =             crRightHandSideBoundedVector123 - crRightHandSideBoundedVector6 - crRightHandSideBoundedVector7 - crRightHandSideBoundedVector8 - crRightHandSideBoundedVector9;
const double crRightHandSideBoundedVector145 =             N(0)*crRightHandSideBoundedVector144;
const double crRightHandSideBoundedVector146 =             crRightHandSideBoundedVector143 - crRightHandSideBoundedVector145;
const double crRightHandSideBoundedVector147 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector87;
const double crRightHandSideBoundedVector148 =             (N(0)*data.lamb_sc_nodes(0) + N(1)*data.lamb_sc_nodes(1) + N(2)*data.lamb_sc_nodes(2) + N(3)*data.lamb_sc_nodes(3) + data.lambda)/data.c_v;
const double crRightHandSideBoundedVector149 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector43;
const double crRightHandSideBoundedVector150 =             crRightHandSideBoundedVector25*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector151 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector152 =             crRightHandSideBoundedVector68*data.gamma;
const double crRightHandSideBoundedVector153 =             crRightHandSideBoundedVector95*data.gamma;
const double crRightHandSideBoundedVector154 =             1.0*crRightHandSideBoundedVector97;
const double crRightHandSideBoundedVector155 =             1.0*crRightHandSideBoundedVector74;
const double crRightHandSideBoundedVector156 =             crRightHandSideBoundedVector25*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector157 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector158 =             crRightHandSideBoundedVector127*crRightHandSideBoundedVector157;
const double crRightHandSideBoundedVector159 =             crRightHandSideBoundedVector38 + crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector160 =             crRightHandSideBoundedVector128*crRightHandSideBoundedVector157;
const double crRightHandSideBoundedVector161 =             crRightHandSideBoundedVector29*crRightHandSideBoundedVector33;
const double crRightHandSideBoundedVector162 =             -crRightHandSideBoundedVector34 - crRightHandSideBoundedVector35 - crRightHandSideBoundedVector36 - crRightHandSideBoundedVector37 - crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector163 =             crRightHandSideBoundedVector161 + crRightHandSideBoundedVector162;
const double crRightHandSideBoundedVector164 =             (N(0)*data.ResProj(0,3) + N(0)*data.dUdt(0,3) + N(1)*data.ResProj(1,3) + N(1)*data.dUdt(1,3) + N(2)*data.ResProj(2,3) + N(2)*data.dUdt(2,3) + N(3)*data.ResProj(3,3) + N(3)*data.dUdt(3,3) - crRightHandSideBoundedVector100*crRightHandSideBoundedVector154*crRightHandSideBoundedVector29 - crRightHandSideBoundedVector149 + crRightHandSideBoundedVector15*crRightHandSideBoundedVector23*(-crRightHandSideBoundedVector158 + crRightHandSideBoundedVector159) - crRightHandSideBoundedVector150 - crRightHandSideBoundedVector151 + crRightHandSideBoundedVector152*crRightHandSideBoundedVector92 + crRightHandSideBoundedVector153*crRightHandSideBoundedVector59 - crRightHandSideBoundedVector155*crRightHandSideBoundedVector156*crRightHandSideBoundedVector53 + crRightHandSideBoundedVector163*crRightHandSideBoundedVector53*crRightHandSideBoundedVector99 + crRightHandSideBoundedVector163*crRightHandSideBoundedVector78 + crRightHandSideBoundedVector90*(crRightHandSideBoundedVector159 - crRightHandSideBoundedVector160))/(crRightHandSideBoundedVector148*crRightHandSideBoundedVector42*crRightHandSideBoundedVector85 + crRightHandSideBoundedVector48);
const double crRightHandSideBoundedVector165 =             crRightHandSideBoundedVector164*crRightHandSideBoundedVector65;
const double crRightHandSideBoundedVector166 =             crRightHandSideBoundedVector110*crRightHandSideBoundedVector111 + crRightHandSideBoundedVector112;
const double crRightHandSideBoundedVector167 =             crRightHandSideBoundedVector115 + crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector168 =             crRightHandSideBoundedVector117*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector169 =             crRightHandSideBoundedVector101 - crRightHandSideBoundedVector167*crRightHandSideBoundedVector89 - crRightHandSideBoundedVector168*crRightHandSideBoundedVector90;
const double crRightHandSideBoundedVector170 =             N(0)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector171 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector142;
const double crRightHandSideBoundedVector172 =             crRightHandSideBoundedVector139*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector173 =             -2*crRightHandSideBoundedVector172 + crRightHandSideBoundedVector96 + crRightHandSideBoundedVector97;
const double crRightHandSideBoundedVector174 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector175 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector168 + crRightHandSideBoundedVector174*(crRightHandSideBoundedVector129 + 2*crRightHandSideBoundedVector28) + crRightHandSideBoundedVector25*crRightHandSideBoundedVector93;
const double crRightHandSideBoundedVector176 =             -crRightHandSideBoundedVector141 + crRightHandSideBoundedVector142;
const double crRightHandSideBoundedVector177 =             crRightHandSideBoundedVector149 + crRightHandSideBoundedVector150 + crRightHandSideBoundedVector151;
const double crRightHandSideBoundedVector178 =             crRightHandSideBoundedVector108*crRightHandSideBoundedVector59 + crRightHandSideBoundedVector113*crRightHandSideBoundedVector92 + crRightHandSideBoundedVector148*(-crRightHandSideBoundedVector105*crRightHandSideBoundedVector59 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector92 - crRightHandSideBoundedVector17*crRightHandSideBoundedVector38 + crRightHandSideBoundedVector22*crRightHandSideBoundedVector68);
const double crRightHandSideBoundedVector179 =             crRightHandSideBoundedVector108*crRightHandSideBoundedVector92 + crRightHandSideBoundedVector148*(-crRightHandSideBoundedVector107*crRightHandSideBoundedVector92 - crRightHandSideBoundedVector111*crRightHandSideBoundedVector59 - crRightHandSideBoundedVector20*crRightHandSideBoundedVector38 + crRightHandSideBoundedVector22*crRightHandSideBoundedVector95) + crRightHandSideBoundedVector166*crRightHandSideBoundedVector59;
const double crRightHandSideBoundedVector180 =             crRightHandSideBoundedVector152*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector181 =             crRightHandSideBoundedVector153*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector182 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector98;
const double crRightHandSideBoundedVector183 =             crRightHandSideBoundedVector158 + crRightHandSideBoundedVector162;
const double crRightHandSideBoundedVector184 =             crRightHandSideBoundedVector160 + crRightHandSideBoundedVector162;
const double crRightHandSideBoundedVector185 =             crRightHandSideBoundedVector159 - crRightHandSideBoundedVector161;
const double crRightHandSideBoundedVector186 =             -crRightHandSideBoundedVector10*crRightHandSideBoundedVector184 - crRightHandSideBoundedVector123*crRightHandSideBoundedVector185 - crRightHandSideBoundedVector139*crRightHandSideBoundedVector185 - crRightHandSideBoundedVector15*crRightHandSideBoundedVector183 + crRightHandSideBoundedVector180 + crRightHandSideBoundedVector181 - crRightHandSideBoundedVector182*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector25*crRightHandSideBoundedVector65*crRightHandSideBoundedVector75;
const double crRightHandSideBoundedVector187 =             N(0)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector188 =             -2.0*crRightHandSideBoundedVector124 + crRightHandSideBoundedVector155 + 1.0*crRightHandSideBoundedVector76;
const double crRightHandSideBoundedVector189 =             crRightHandSideBoundedVector126*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector190 =             crRightHandSideBoundedVector183*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector191 =             3.0*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector192 =             2.0*crRightHandSideBoundedVector157;
const double crRightHandSideBoundedVector193 =             crRightHandSideBoundedVector185 - crRightHandSideBoundedVector192*crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector194 =             -crRightHandSideBoundedVector130*crRightHandSideBoundedVector193 + crRightHandSideBoundedVector152 - crRightHandSideBoundedVector191*crRightHandSideBoundedVector58 + crRightHandSideBoundedVector67;
const double crRightHandSideBoundedVector195 =             crRightHandSideBoundedVector154 - 2.0*crRightHandSideBoundedVector172 + 1.0*crRightHandSideBoundedVector96;
const double crRightHandSideBoundedVector196 =             crRightHandSideBoundedVector184*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector197 =             crRightHandSideBoundedVector185 - crRightHandSideBoundedVector192*crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector198 =             crRightHandSideBoundedVector153 - crRightHandSideBoundedVector174*crRightHandSideBoundedVector197 - crRightHandSideBoundedVector191*crRightHandSideBoundedVector91 + crRightHandSideBoundedVector94;
const double crRightHandSideBoundedVector199 =             crRightHandSideBoundedVector164*crRightHandSideBoundedVector23*crRightHandSideBoundedVector55;
const double crRightHandSideBoundedVector200 =             crRightHandSideBoundedVector185*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector201 =             crRightHandSideBoundedVector129*crRightHandSideBoundedVector23 + 2*crRightHandSideBoundedVector157*(-crRightHandSideBoundedVector30 - crRightHandSideBoundedVector31) + 2*crRightHandSideBoundedVector34 + 2*crRightHandSideBoundedVector35 + 2*crRightHandSideBoundedVector36 + 2*crRightHandSideBoundedVector37 + 2*crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector202 =             crRightHandSideBoundedVector139*crRightHandSideBoundedVector201 - crRightHandSideBoundedVector15*crRightHandSideBoundedVector193 - crRightHandSideBoundedVector180 + 2.0*crRightHandSideBoundedVector182*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector203 =             -crRightHandSideBoundedVector10*crRightHandSideBoundedVector197 + crRightHandSideBoundedVector123*crRightHandSideBoundedVector201 + 2.0*crRightHandSideBoundedVector156*crRightHandSideBoundedVector75 - crRightHandSideBoundedVector181;
const double crRightHandSideBoundedVector204 =             N(1)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector205 =             DN_DX(1,1)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector206 =             DN_DX(1,0)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector207 =             N(1)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector208 =             DN_DX(1,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector209 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector208;
const double crRightHandSideBoundedVector210 =             N(1)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector211 =             DN_DX(1,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector212 =             N(1)*crRightHandSideBoundedVector133;
const double crRightHandSideBoundedVector213 =             N(1)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector214 =             N(1)*crRightHandSideBoundedVector140;
const double crRightHandSideBoundedVector215 =             DN_DX(1,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector216 =             DN_DX(1,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector217 =             N(1)*crRightHandSideBoundedVector144;
const double crRightHandSideBoundedVector218 =             crRightHandSideBoundedVector216 - crRightHandSideBoundedVector217;
const double crRightHandSideBoundedVector219 =             N(1)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector220 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector215;
const double crRightHandSideBoundedVector221 =             -crRightHandSideBoundedVector214 + crRightHandSideBoundedVector215;
const double crRightHandSideBoundedVector222 =             N(1)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector223 =             crRightHandSideBoundedVector210*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector224 =             N(2)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector225 =             DN_DX(2,1)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector226 =             DN_DX(2,0)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector227 =             N(2)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector228 =             DN_DX(2,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector229 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector228;
const double crRightHandSideBoundedVector230 =             N(2)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector231 =             DN_DX(2,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector232 =             N(2)*crRightHandSideBoundedVector133;
const double crRightHandSideBoundedVector233 =             N(2)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector234 =             N(2)*crRightHandSideBoundedVector140;
const double crRightHandSideBoundedVector235 =             DN_DX(2,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector236 =             DN_DX(2,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector237 =             N(2)*crRightHandSideBoundedVector144;
const double crRightHandSideBoundedVector238 =             crRightHandSideBoundedVector236 - crRightHandSideBoundedVector237;
const double crRightHandSideBoundedVector239 =             N(2)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector240 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector235;
const double crRightHandSideBoundedVector241 =             -crRightHandSideBoundedVector234 + crRightHandSideBoundedVector235;
const double crRightHandSideBoundedVector242 =             N(2)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector243 =             crRightHandSideBoundedVector230*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector244 =             N(3)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector245 =             DN_DX(3,1)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector246 =             DN_DX(3,0)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector247 =             N(3)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector248 =             DN_DX(3,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector249 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector248;
const double crRightHandSideBoundedVector250 =             N(3)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector251 =             DN_DX(3,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector252 =             N(3)*crRightHandSideBoundedVector133;
const double crRightHandSideBoundedVector253 =             N(3)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector254 =             N(3)*crRightHandSideBoundedVector140;
const double crRightHandSideBoundedVector255 =             DN_DX(3,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector256 =             DN_DX(3,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector257 =             N(3)*crRightHandSideBoundedVector144;
const double crRightHandSideBoundedVector258 =             crRightHandSideBoundedVector256 - crRightHandSideBoundedVector257;
const double crRightHandSideBoundedVector259 =             N(3)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector260 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector255;
const double crRightHandSideBoundedVector261 =             -crRightHandSideBoundedVector254 + crRightHandSideBoundedVector255;
const double crRightHandSideBoundedVector262 =             N(3)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector263 =             crRightHandSideBoundedVector250*crRightHandSideBoundedVector29;
            rRightHandSideBoundedVector[0] += DN_DX(0,0)*crRightHandSideBoundedVector19 - DN_DX(0,0)*crRightHandSideBoundedVector87 - DN_DX(0,1)*crRightHandSideBoundedVector102 + DN_DX(0,1)*crRightHandSideBoundedVector21 - N(0)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector5*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector5;
            rRightHandSideBoundedVector[1] += -DN_DX(0,0)*crRightHandSideBoundedVector165 - N(0)*crRightHandSideBoundedVector119 + N(0)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector103*crRightHandSideBoundedVector108 - crRightHandSideBoundedVector113*crRightHandSideBoundedVector114 - crRightHandSideBoundedVector138*(crRightHandSideBoundedVector121 - crRightHandSideBoundedVector132*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector134 + crRightHandSideBoundedVector135*crRightHandSideBoundedVector137) - crRightHandSideBoundedVector147*(crRightHandSideBoundedVector117*crRightHandSideBoundedVector141 - crRightHandSideBoundedVector117*crRightHandSideBoundedVector142 + crRightHandSideBoundedVector146) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector114*crRightHandSideBoundedVector116 + crRightHandSideBoundedVector120 - crRightHandSideBoundedVector122 - crRightHandSideBoundedVector125*crRightHandSideBoundedVector126 + crRightHandSideBoundedVector126*crRightHandSideBoundedVector131);
            rRightHandSideBoundedVector[2] += -DN_DX(0,1)*crRightHandSideBoundedVector165 - N(0)*crRightHandSideBoundedVector169 + N(0)*crRightHandSideBoundedVector88 - crRightHandSideBoundedVector103*crRightHandSideBoundedVector166 - crRightHandSideBoundedVector108*crRightHandSideBoundedVector114 - crRightHandSideBoundedVector138*(-crRightHandSideBoundedVector117*crRightHandSideBoundedVector143 + crRightHandSideBoundedVector117*crRightHandSideBoundedVector145 + crRightHandSideBoundedVector176) - crRightHandSideBoundedVector147*(-crRightHandSideBoundedVector121*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector132 + crRightHandSideBoundedVector134*crRightHandSideBoundedVector135 - crRightHandSideBoundedVector137) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector103*crRightHandSideBoundedVector167 - crRightHandSideBoundedVector126*crRightHandSideBoundedVector173 + crRightHandSideBoundedVector126*crRightHandSideBoundedVector175 + crRightHandSideBoundedVector170 - crRightHandSideBoundedVector171);
            rRightHandSideBoundedVector[3] += N(0)*crRightHandSideBoundedVector177 - crRightHandSideBoundedVector102*(-DN_DX(0,1)*crRightHandSideBoundedVector196 + crRightHandSideBoundedVector170 - crRightHandSideBoundedVector171*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector187*crRightHandSideBoundedVector198 - crRightHandSideBoundedVector189*crRightHandSideBoundedVector195) - crRightHandSideBoundedVector103*crRightHandSideBoundedVector179 - crRightHandSideBoundedVector114*crRightHandSideBoundedVector178 - crRightHandSideBoundedVector186*crRightHandSideBoundedVector187 - crRightHandSideBoundedVector199*(crRightHandSideBoundedVector146 + crRightHandSideBoundedVector176) - crRightHandSideBoundedVector49*(N(0)*crRightHandSideBoundedVector43 + crRightHandSideBoundedVector126*crRightHandSideBoundedVector202 + crRightHandSideBoundedVector126*crRightHandSideBoundedVector203 - crRightHandSideBoundedVector142*crRightHandSideBoundedVector200 - crRightHandSideBoundedVector143*crRightHandSideBoundedVector200) - crRightHandSideBoundedVector87*(-DN_DX(0,0)*crRightHandSideBoundedVector190 + crRightHandSideBoundedVector120 - crRightHandSideBoundedVector122*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector187*crRightHandSideBoundedVector194 - crRightHandSideBoundedVector188*crRightHandSideBoundedVector189);
            rRightHandSideBoundedVector[4] += DN_DX(1,0)*crRightHandSideBoundedVector19 - DN_DX(1,0)*crRightHandSideBoundedVector87 - DN_DX(1,1)*crRightHandSideBoundedVector102 + DN_DX(1,1)*crRightHandSideBoundedVector21 - N(1)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector204*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector204;
            rRightHandSideBoundedVector[5] += -DN_DX(1,0)*crRightHandSideBoundedVector165 - N(1)*crRightHandSideBoundedVector119 + N(1)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector108*crRightHandSideBoundedVector205 - crRightHandSideBoundedVector113*crRightHandSideBoundedVector206 - crRightHandSideBoundedVector138*(crRightHandSideBoundedVector135*crRightHandSideBoundedVector213 + crRightHandSideBoundedVector208 - crRightHandSideBoundedVector211*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector212) - crRightHandSideBoundedVector147*(crRightHandSideBoundedVector117*crRightHandSideBoundedVector214 - crRightHandSideBoundedVector117*crRightHandSideBoundedVector215 + crRightHandSideBoundedVector218) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector116*crRightHandSideBoundedVector206 - crRightHandSideBoundedVector125*crRightHandSideBoundedVector210 + crRightHandSideBoundedVector131*crRightHandSideBoundedVector210 + crRightHandSideBoundedVector207 - crRightHandSideBoundedVector209);
            rRightHandSideBoundedVector[6] += -DN_DX(1,1)*crRightHandSideBoundedVector165 - N(1)*crRightHandSideBoundedVector169 + N(1)*crRightHandSideBoundedVector88 - crRightHandSideBoundedVector108*crRightHandSideBoundedVector206 - crRightHandSideBoundedVector138*(-crRightHandSideBoundedVector117*crRightHandSideBoundedVector216 + crRightHandSideBoundedVector117*crRightHandSideBoundedVector217 + crRightHandSideBoundedVector221) - crRightHandSideBoundedVector147*(crRightHandSideBoundedVector135*crRightHandSideBoundedVector212 - crRightHandSideBoundedVector208*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector211 - crRightHandSideBoundedVector213) - crRightHandSideBoundedVector166*crRightHandSideBoundedVector205 - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector167*crRightHandSideBoundedVector205 - crRightHandSideBoundedVector173*crRightHandSideBoundedVector210 + crRightHandSideBoundedVector175*crRightHandSideBoundedVector210 + crRightHandSideBoundedVector219 - crRightHandSideBoundedVector220);
            rRightHandSideBoundedVector[7] += N(1)*crRightHandSideBoundedVector177 - crRightHandSideBoundedVector102*(-DN_DX(1,1)*crRightHandSideBoundedVector196 - crRightHandSideBoundedVector195*crRightHandSideBoundedVector223 + crRightHandSideBoundedVector198*crRightHandSideBoundedVector222 + crRightHandSideBoundedVector219 - crRightHandSideBoundedVector220*crRightHandSideBoundedVector65) - crRightHandSideBoundedVector178*crRightHandSideBoundedVector206 - crRightHandSideBoundedVector179*crRightHandSideBoundedVector205 - crRightHandSideBoundedVector186*crRightHandSideBoundedVector222 - crRightHandSideBoundedVector199*(crRightHandSideBoundedVector218 + crRightHandSideBoundedVector221) - crRightHandSideBoundedVector49*(N(1)*crRightHandSideBoundedVector43 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector215 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector216 + crRightHandSideBoundedVector202*crRightHandSideBoundedVector210 + crRightHandSideBoundedVector203*crRightHandSideBoundedVector210) - crRightHandSideBoundedVector87*(-DN_DX(1,0)*crRightHandSideBoundedVector190 - crRightHandSideBoundedVector188*crRightHandSideBoundedVector223 + crRightHandSideBoundedVector194*crRightHandSideBoundedVector222 + crRightHandSideBoundedVector207 - crRightHandSideBoundedVector209*crRightHandSideBoundedVector65);
            rRightHandSideBoundedVector[8] += DN_DX(2,0)*crRightHandSideBoundedVector19 - DN_DX(2,0)*crRightHandSideBoundedVector87 - DN_DX(2,1)*crRightHandSideBoundedVector102 + DN_DX(2,1)*crRightHandSideBoundedVector21 - N(2)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector224*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector224;
            rRightHandSideBoundedVector[9] += -DN_DX(2,0)*crRightHandSideBoundedVector165 - N(2)*crRightHandSideBoundedVector119 + N(2)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector108*crRightHandSideBoundedVector225 - crRightHandSideBoundedVector113*crRightHandSideBoundedVector226 - crRightHandSideBoundedVector138*(crRightHandSideBoundedVector135*crRightHandSideBoundedVector233 + crRightHandSideBoundedVector228 - crRightHandSideBoundedVector231*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector232) - crRightHandSideBoundedVector147*(crRightHandSideBoundedVector117*crRightHandSideBoundedVector234 - crRightHandSideBoundedVector117*crRightHandSideBoundedVector235 + crRightHandSideBoundedVector238) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector116*crRightHandSideBoundedVector226 - crRightHandSideBoundedVector125*crRightHandSideBoundedVector230 + crRightHandSideBoundedVector131*crRightHandSideBoundedVector230 + crRightHandSideBoundedVector227 - crRightHandSideBoundedVector229);
            rRightHandSideBoundedVector[10] += -DN_DX(2,1)*crRightHandSideBoundedVector165 - N(2)*crRightHandSideBoundedVector169 + N(2)*crRightHandSideBoundedVector88 - crRightHandSideBoundedVector108*crRightHandSideBoundedVector226 - crRightHandSideBoundedVector138*(-crRightHandSideBoundedVector117*crRightHandSideBoundedVector236 + crRightHandSideBoundedVector117*crRightHandSideBoundedVector237 + crRightHandSideBoundedVector241) - crRightHandSideBoundedVector147*(crRightHandSideBoundedVector135*crRightHandSideBoundedVector232 - crRightHandSideBoundedVector228*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector231 - crRightHandSideBoundedVector233) - crRightHandSideBoundedVector166*crRightHandSideBoundedVector225 - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector167*crRightHandSideBoundedVector225 - crRightHandSideBoundedVector173*crRightHandSideBoundedVector230 + crRightHandSideBoundedVector175*crRightHandSideBoundedVector230 + crRightHandSideBoundedVector239 - crRightHandSideBoundedVector240);
            rRightHandSideBoundedVector[11] += N(2)*crRightHandSideBoundedVector177 - crRightHandSideBoundedVector102*(-DN_DX(2,1)*crRightHandSideBoundedVector196 - crRightHandSideBoundedVector195*crRightHandSideBoundedVector243 + crRightHandSideBoundedVector198*crRightHandSideBoundedVector242 + crRightHandSideBoundedVector239 - crRightHandSideBoundedVector240*crRightHandSideBoundedVector65) - crRightHandSideBoundedVector178*crRightHandSideBoundedVector226 - crRightHandSideBoundedVector179*crRightHandSideBoundedVector225 - crRightHandSideBoundedVector186*crRightHandSideBoundedVector242 - crRightHandSideBoundedVector199*(crRightHandSideBoundedVector238 + crRightHandSideBoundedVector241) - crRightHandSideBoundedVector49*(N(2)*crRightHandSideBoundedVector43 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector235 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector236 + crRightHandSideBoundedVector202*crRightHandSideBoundedVector230 + crRightHandSideBoundedVector203*crRightHandSideBoundedVector230) - crRightHandSideBoundedVector87*(-DN_DX(2,0)*crRightHandSideBoundedVector190 - crRightHandSideBoundedVector188*crRightHandSideBoundedVector243 + crRightHandSideBoundedVector194*crRightHandSideBoundedVector242 + crRightHandSideBoundedVector227 - crRightHandSideBoundedVector229*crRightHandSideBoundedVector65);
            rRightHandSideBoundedVector[12] += DN_DX(3,0)*crRightHandSideBoundedVector19 - DN_DX(3,0)*crRightHandSideBoundedVector87 - DN_DX(3,1)*crRightHandSideBoundedVector102 + DN_DX(3,1)*crRightHandSideBoundedVector21 - N(3)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector244*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector244;
            rRightHandSideBoundedVector[13] += -DN_DX(3,0)*crRightHandSideBoundedVector165 - N(3)*crRightHandSideBoundedVector119 + N(3)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector108*crRightHandSideBoundedVector245 - crRightHandSideBoundedVector113*crRightHandSideBoundedVector246 - crRightHandSideBoundedVector138*(crRightHandSideBoundedVector135*crRightHandSideBoundedVector253 + crRightHandSideBoundedVector248 - crRightHandSideBoundedVector251*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector252) - crRightHandSideBoundedVector147*(crRightHandSideBoundedVector117*crRightHandSideBoundedVector254 - crRightHandSideBoundedVector117*crRightHandSideBoundedVector255 + crRightHandSideBoundedVector258) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector116*crRightHandSideBoundedVector246 - crRightHandSideBoundedVector125*crRightHandSideBoundedVector250 + crRightHandSideBoundedVector131*crRightHandSideBoundedVector250 + crRightHandSideBoundedVector247 - crRightHandSideBoundedVector249);
            rRightHandSideBoundedVector[14] += -DN_DX(3,1)*crRightHandSideBoundedVector165 - N(3)*crRightHandSideBoundedVector169 + N(3)*crRightHandSideBoundedVector88 - crRightHandSideBoundedVector108*crRightHandSideBoundedVector246 - crRightHandSideBoundedVector138*(-crRightHandSideBoundedVector117*crRightHandSideBoundedVector256 + crRightHandSideBoundedVector117*crRightHandSideBoundedVector257 + crRightHandSideBoundedVector261) - crRightHandSideBoundedVector147*(crRightHandSideBoundedVector135*crRightHandSideBoundedVector252 - crRightHandSideBoundedVector248*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector251 - crRightHandSideBoundedVector253) - crRightHandSideBoundedVector166*crRightHandSideBoundedVector245 - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector167*crRightHandSideBoundedVector245 - crRightHandSideBoundedVector173*crRightHandSideBoundedVector250 + crRightHandSideBoundedVector175*crRightHandSideBoundedVector250 + crRightHandSideBoundedVector259 - crRightHandSideBoundedVector260);
            rRightHandSideBoundedVector[15] += N(3)*crRightHandSideBoundedVector177 - crRightHandSideBoundedVector102*(-DN_DX(3,1)*crRightHandSideBoundedVector196 - crRightHandSideBoundedVector195*crRightHandSideBoundedVector263 + crRightHandSideBoundedVector198*crRightHandSideBoundedVector262 + crRightHandSideBoundedVector259 - crRightHandSideBoundedVector260*crRightHandSideBoundedVector65) - crRightHandSideBoundedVector178*crRightHandSideBoundedVector246 - crRightHandSideBoundedVector179*crRightHandSideBoundedVector245 - crRightHandSideBoundedVector186*crRightHandSideBoundedVector262 - crRightHandSideBoundedVector199*(crRightHandSideBoundedVector258 + crRightHandSideBoundedVector261) - crRightHandSideBoundedVector49*(N(3)*crRightHandSideBoundedVector43 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector255 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector256 + crRightHandSideBoundedVector202*crRightHandSideBoundedVector250 + crRightHandSideBoundedVector203*crRightHandSideBoundedVector250) - crRightHandSideBoundedVector87*(-DN_DX(3,0)*crRightHandSideBoundedVector190 - crRightHandSideBoundedVector188*crRightHandSideBoundedVector263 + crRightHandSideBoundedVector194*crRightHandSideBoundedVector262 + crRightHandSideBoundedVector247 - crRightHandSideBoundedVector249*crRightHandSideBoundedVector65);

        }
    }
    else
    {
        for(const auto& gauss_point: gauss_points)
        {
            r_geometry.ShapeFunctionsValues(N, gauss_point.Coordinates());
            r_geometry.InverseOfJacobian(Jinv, gauss_point.Coordinates());
            r_geometry.ShapeFunctionsLocalGradients(DN_DX_iso, gauss_point.Coordinates());
            GeometryUtils::ShapeFunctionsGradients(DN_DX_iso, Jinv, DN_DX);

const double crRightHandSideBoundedVector0 =             N(0)*data.m_ext(0);
const double crRightHandSideBoundedVector1 =             N(1)*data.m_ext(1);
const double crRightHandSideBoundedVector2 =             N(2)*data.m_ext(2);
const double crRightHandSideBoundedVector3 =             N(3)*data.m_ext(3);
const double crRightHandSideBoundedVector4 =             crRightHandSideBoundedVector0 + crRightHandSideBoundedVector1 + crRightHandSideBoundedVector2 + crRightHandSideBoundedVector3;
const double crRightHandSideBoundedVector5 =             N(0)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector6 =             DN_DX(0,1)*data.U(0,2);
const double crRightHandSideBoundedVector7 =             DN_DX(1,1)*data.U(1,2);
const double crRightHandSideBoundedVector8 =             DN_DX(2,1)*data.U(2,2);
const double crRightHandSideBoundedVector9 =             DN_DX(3,1)*data.U(3,2);
const double crRightHandSideBoundedVector10 =             crRightHandSideBoundedVector6 + crRightHandSideBoundedVector7 + crRightHandSideBoundedVector8 + crRightHandSideBoundedVector9;
const double crRightHandSideBoundedVector11 =             DN_DX(0,0)*data.U(0,1);
const double crRightHandSideBoundedVector12 =             DN_DX(1,0)*data.U(1,1);
const double crRightHandSideBoundedVector13 =             DN_DX(2,0)*data.U(2,1);
const double crRightHandSideBoundedVector14 =             DN_DX(3,0)*data.U(3,1);
const double crRightHandSideBoundedVector15 =             crRightHandSideBoundedVector11 + crRightHandSideBoundedVector12 + crRightHandSideBoundedVector13 + crRightHandSideBoundedVector14;
const double crRightHandSideBoundedVector16 =             crRightHandSideBoundedVector10 + crRightHandSideBoundedVector15;
const double crRightHandSideBoundedVector17 =             DN_DX(0,0)*data.U(0,0) + DN_DX(1,0)*data.U(1,0) + DN_DX(2,0)*data.U(2,0) + DN_DX(3,0)*data.U(3,0);
const double crRightHandSideBoundedVector18 =             N(0)*data.alpha_sc_nodes(0) + N(1)*data.alpha_sc_nodes(1) + N(2)*data.alpha_sc_nodes(2) + N(3)*data.alpha_sc_nodes(3);
const double crRightHandSideBoundedVector19 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector18;
const double crRightHandSideBoundedVector20 =             DN_DX(0,1)*data.U(0,0) + DN_DX(1,1)*data.U(1,0) + DN_DX(2,1)*data.U(2,0) + DN_DX(3,1)*data.U(3,0);
const double crRightHandSideBoundedVector21 =             crRightHandSideBoundedVector18*crRightHandSideBoundedVector20;
const double crRightHandSideBoundedVector22 =             N(0)*data.U(0,0) + N(1)*data.U(1,0) + N(2)*data.U(2,0) + N(3)*data.U(3,0);
const double crRightHandSideBoundedVector23 =             1.0/crRightHandSideBoundedVector22;
const double crRightHandSideBoundedVector24 =             fabs(crRightHandSideBoundedVector22);
const double crRightHandSideBoundedVector25 =             N(0)*data.U(0,1) + N(1)*data.U(1,1) + N(2)*data.U(2,1) + N(3)*data.U(3,1);
const double crRightHandSideBoundedVector26 =             pow(crRightHandSideBoundedVector25, 2);
const double crRightHandSideBoundedVector27 =             N(0)*data.U(0,2) + N(1)*data.U(1,2) + N(2)*data.U(2,2) + N(3)*data.U(3,2);
const double crRightHandSideBoundedVector28 =             pow(crRightHandSideBoundedVector27, 2);
const double crRightHandSideBoundedVector29 =             data.gamma - 1;
const double crRightHandSideBoundedVector30 =             0.5*crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector31 =             0.5*crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector32 =             crRightHandSideBoundedVector30 + crRightHandSideBoundedVector31;
const double crRightHandSideBoundedVector33 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector32;
const double crRightHandSideBoundedVector34 =             N(0)*data.U(0,3);
const double crRightHandSideBoundedVector35 =             N(1)*data.U(1,3);
const double crRightHandSideBoundedVector36 =             N(2)*data.U(2,3);
const double crRightHandSideBoundedVector37 =             N(3)*data.U(3,3);
const double crRightHandSideBoundedVector38 =             crRightHandSideBoundedVector34 + crRightHandSideBoundedVector35 + crRightHandSideBoundedVector36 + crRightHandSideBoundedVector37;
const double crRightHandSideBoundedVector39 =             -crRightHandSideBoundedVector33 + crRightHandSideBoundedVector38;
const double crRightHandSideBoundedVector40 =             crRightHandSideBoundedVector29*crRightHandSideBoundedVector39;
const double crRightHandSideBoundedVector41 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector42 =             1.0/data.gamma;
const double crRightHandSideBoundedVector43 =             N(0)*data.r_ext(0) + N(1)*data.r_ext(1) + N(2)*data.r_ext(2) + N(3)*data.r_ext(3);
const double crRightHandSideBoundedVector44 =             pow(crRightHandSideBoundedVector43, 2);
const double crRightHandSideBoundedVector45 =             N(0)*data.f_ext(0,0) + N(1)*data.f_ext(1,0) + N(2)*data.f_ext(2,0) + N(3)*data.f_ext(3,0);
const double crRightHandSideBoundedVector46 =             N(0)*data.f_ext(0,1) + N(1)*data.f_ext(1,1) + N(2)*data.f_ext(2,1) + N(3)*data.f_ext(3,1);
const double crRightHandSideBoundedVector47 =             crRightHandSideBoundedVector41*data.gamma*(pow(crRightHandSideBoundedVector45, 2) + pow(crRightHandSideBoundedVector46, 2));
const double crRightHandSideBoundedVector48 =             0.70710678118654757*crRightHandSideBoundedVector24*crRightHandSideBoundedVector42*stab_c3*sqrt((crRightHandSideBoundedVector44 + 2.0*crRightHandSideBoundedVector47 + 2.0*sqrt(0.25*crRightHandSideBoundedVector44 + crRightHandSideBoundedVector47)*fabs(crRightHandSideBoundedVector43))/(pow(crRightHandSideBoundedVector29, 2)*pow(crRightHandSideBoundedVector39, 2))) + stab_c2*(sqrt(crRightHandSideBoundedVector41)*sqrt(data.gamma) + sqrt(crRightHandSideBoundedVector26 + crRightHandSideBoundedVector28)/crRightHandSideBoundedVector24)/data.h;
const double crRightHandSideBoundedVector49 =             1.0*(N(0)*data.dUdt(0,0) + N(1)*data.dUdt(1,0) + N(2)*data.dUdt(2,0) + N(3)*data.dUdt(3,0) - crRightHandSideBoundedVector0 - crRightHandSideBoundedVector1 + crRightHandSideBoundedVector16 - crRightHandSideBoundedVector2 - crRightHandSideBoundedVector3)/crRightHandSideBoundedVector48;
const double crRightHandSideBoundedVector50 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector49;
const double crRightHandSideBoundedVector51 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector52 =             crRightHandSideBoundedVector29*crRightHandSideBoundedVector32;
const double crRightHandSideBoundedVector53 =             pow(crRightHandSideBoundedVector22, -2);
const double crRightHandSideBoundedVector54 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector55 =             1.0*data.gamma;
const double crRightHandSideBoundedVector56 =             3.0 - crRightHandSideBoundedVector55;
const double crRightHandSideBoundedVector57 =             crRightHandSideBoundedVector15*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector58 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector57;
const double crRightHandSideBoundedVector59 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector60 =             DN_DX(0,0)*data.U(0,2);
const double crRightHandSideBoundedVector61 =             DN_DX(1,0)*data.U(1,2);
const double crRightHandSideBoundedVector62 =             DN_DX(2,0)*data.U(2,2);
const double crRightHandSideBoundedVector63 =             DN_DX(3,0)*data.U(3,2);
const double crRightHandSideBoundedVector64 =             crRightHandSideBoundedVector60 + crRightHandSideBoundedVector61 + crRightHandSideBoundedVector62 + crRightHandSideBoundedVector63;
const double crRightHandSideBoundedVector65 =             1.0*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector66 =             crRightHandSideBoundedVector64*crRightHandSideBoundedVector65;
const double crRightHandSideBoundedVector67 =             -crRightHandSideBoundedVector59*crRightHandSideBoundedVector66;
const double crRightHandSideBoundedVector68 =             DN_DX(0,0)*data.U(0,3) + DN_DX(1,0)*data.U(1,3) + DN_DX(2,0)*data.U(2,3) + DN_DX(3,0)*data.U(3,3);
const double crRightHandSideBoundedVector69 =             DN_DX(0,1)*data.U(0,1);
const double crRightHandSideBoundedVector70 =             DN_DX(1,1)*data.U(1,1);
const double crRightHandSideBoundedVector71 =             DN_DX(2,1)*data.U(2,1);
const double crRightHandSideBoundedVector72 =             DN_DX(3,1)*data.U(3,1);
const double crRightHandSideBoundedVector73 =             crRightHandSideBoundedVector69 + crRightHandSideBoundedVector70 + crRightHandSideBoundedVector71 + crRightHandSideBoundedVector72;
const double crRightHandSideBoundedVector74 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector73;
const double crRightHandSideBoundedVector75 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector74;
const double crRightHandSideBoundedVector76 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector77 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector78 =             crRightHandSideBoundedVector53*crRightHandSideBoundedVector77;
const double crRightHandSideBoundedVector79 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector76 - crRightHandSideBoundedVector25*crRightHandSideBoundedVector78 + crRightHandSideBoundedVector29*crRightHandSideBoundedVector68 + crRightHandSideBoundedVector67 + crRightHandSideBoundedVector75;
const double crRightHandSideBoundedVector80 =             N(0)*data.mu_sc_nodes(0);
const double crRightHandSideBoundedVector81 =             N(1)*data.mu_sc_nodes(1);
const double crRightHandSideBoundedVector82 =             N(2)*data.mu_sc_nodes(2);
const double crRightHandSideBoundedVector83 =             N(3)*data.mu_sc_nodes(3);
const double crRightHandSideBoundedVector84 =             crRightHandSideBoundedVector80 + crRightHandSideBoundedVector81 + crRightHandSideBoundedVector82 + crRightHandSideBoundedVector83 + data.mu;
const double crRightHandSideBoundedVector85 =             crRightHandSideBoundedVector23*stab_c1/pow(data.h, 2);
const double crRightHandSideBoundedVector86 =             1.0/(crRightHandSideBoundedVector48 + 1.3333333333333333*crRightHandSideBoundedVector84*crRightHandSideBoundedVector85);
const double crRightHandSideBoundedVector87 =             crRightHandSideBoundedVector86*(N(0)*data.dUdt(0,1) + N(1)*data.dUdt(1,1) + N(2)*data.dUdt(2,1) + N(3)*data.dUdt(3,1) - crRightHandSideBoundedVector51 + crRightHandSideBoundedVector54*(-crRightHandSideBoundedVector26 + crRightHandSideBoundedVector52) + crRightHandSideBoundedVector56*crRightHandSideBoundedVector58 + crRightHandSideBoundedVector79);
const double crRightHandSideBoundedVector88 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector89 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector90 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector91 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector90;
const double crRightHandSideBoundedVector92 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector93 =             crRightHandSideBoundedVector65*crRightHandSideBoundedVector73;
const double crRightHandSideBoundedVector94 =             -crRightHandSideBoundedVector92*crRightHandSideBoundedVector93;
const double crRightHandSideBoundedVector95 =             DN_DX(0,1)*data.U(0,3) + DN_DX(1,1)*data.U(1,3) + DN_DX(2,1)*data.U(2,3) + DN_DX(3,1)*data.U(3,3);
const double crRightHandSideBoundedVector96 =             crRightHandSideBoundedVector15*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector97 =             crRightHandSideBoundedVector25*crRightHandSideBoundedVector64;
const double crRightHandSideBoundedVector98 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector97;
const double crRightHandSideBoundedVector99 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector100 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector101 =             -crRightHandSideBoundedVector100*crRightHandSideBoundedVector99 + crRightHandSideBoundedVector23*crRightHandSideBoundedVector96 + crRightHandSideBoundedVector29*crRightHandSideBoundedVector95 + crRightHandSideBoundedVector94 + crRightHandSideBoundedVector98;
const double crRightHandSideBoundedVector102 =             crRightHandSideBoundedVector86*(N(0)*data.dUdt(0,2) + N(1)*data.dUdt(1,2) + N(2)*data.dUdt(2,2) + N(3)*data.dUdt(3,2) + crRightHandSideBoundedVector101 + crRightHandSideBoundedVector56*crRightHandSideBoundedVector91 - crRightHandSideBoundedVector88 + crRightHandSideBoundedVector89*(-crRightHandSideBoundedVector28 + crRightHandSideBoundedVector52));
const double crRightHandSideBoundedVector103 =             DN_DX(0,1)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector104 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector105 =             -crRightHandSideBoundedVector104 + crRightHandSideBoundedVector22*crRightHandSideBoundedVector64;
const double crRightHandSideBoundedVector106 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector107 =             -crRightHandSideBoundedVector106 + crRightHandSideBoundedVector22*crRightHandSideBoundedVector73;
const double crRightHandSideBoundedVector108 =             crRightHandSideBoundedVector84*(crRightHandSideBoundedVector105 + crRightHandSideBoundedVector107);
const double crRightHandSideBoundedVector109 =             crRightHandSideBoundedVector15*crRightHandSideBoundedVector22 - crRightHandSideBoundedVector99;
const double crRightHandSideBoundedVector110 =             2*crRightHandSideBoundedVector84;
const double crRightHandSideBoundedVector111 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector22 - crRightHandSideBoundedVector77;
const double crRightHandSideBoundedVector112 =             (crRightHandSideBoundedVector109 + crRightHandSideBoundedVector111)*(-N(0)*data.beta_sc_nodes(0) - N(1)*data.beta_sc_nodes(1) - N(2)*data.beta_sc_nodes(2) - N(3)*data.beta_sc_nodes(3) + 0.66666666666666663*crRightHandSideBoundedVector80 + 0.66666666666666663*crRightHandSideBoundedVector81 + 0.66666666666666663*crRightHandSideBoundedVector82 + 0.66666666666666663*crRightHandSideBoundedVector83 + 0.66666666666666663*data.mu);
const double crRightHandSideBoundedVector113 =             crRightHandSideBoundedVector109*crRightHandSideBoundedVector110 + crRightHandSideBoundedVector112;
const double crRightHandSideBoundedVector114 =             DN_DX(0,0)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector115 =             -crRightHandSideBoundedVector52;
const double crRightHandSideBoundedVector116 =             crRightHandSideBoundedVector115 + crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector117 =             crRightHandSideBoundedVector55 - 3.0;
const double crRightHandSideBoundedVector118 =             crRightHandSideBoundedVector117*crRightHandSideBoundedVector57;
const double crRightHandSideBoundedVector119 =             -crRightHandSideBoundedVector116*crRightHandSideBoundedVector54 - crRightHandSideBoundedVector118*crRightHandSideBoundedVector23 + crRightHandSideBoundedVector79;
const double crRightHandSideBoundedVector120 =             N(0)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector121 =             DN_DX(0,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector122 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector121;
const double crRightHandSideBoundedVector123 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector77;
const double crRightHandSideBoundedVector124 =             crRightHandSideBoundedVector123*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector125 =             -2*crRightHandSideBoundedVector124 + crRightHandSideBoundedVector74 + crRightHandSideBoundedVector76;
const double crRightHandSideBoundedVector126 =             N(0)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector127 =             1.0*crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector128 =             1.0*crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector129 =             crRightHandSideBoundedVector29*(-crRightHandSideBoundedVector127 - crRightHandSideBoundedVector128);
const double crRightHandSideBoundedVector130 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector131 =             crRightHandSideBoundedVector118 + crRightHandSideBoundedVector130*(crRightHandSideBoundedVector129 + 2*crRightHandSideBoundedVector26) + crRightHandSideBoundedVector27*crRightHandSideBoundedVector66;
const double crRightHandSideBoundedVector132 =             DN_DX(0,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector133 =             crRightHandSideBoundedVector106*crRightHandSideBoundedVector23 - crRightHandSideBoundedVector69 - crRightHandSideBoundedVector70 - crRightHandSideBoundedVector71 - crRightHandSideBoundedVector72;
const double crRightHandSideBoundedVector134 =             N(0)*crRightHandSideBoundedVector133;
const double crRightHandSideBoundedVector135 =             crRightHandSideBoundedVector55 - 1.0;
const double crRightHandSideBoundedVector136 =             crRightHandSideBoundedVector104*crRightHandSideBoundedVector23 - crRightHandSideBoundedVector60 - crRightHandSideBoundedVector61 - crRightHandSideBoundedVector62 - crRightHandSideBoundedVector63;
const double crRightHandSideBoundedVector137 =             N(0)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector138 =             crRightHandSideBoundedVector102*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector139 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector99;
const double crRightHandSideBoundedVector140 =             -crRightHandSideBoundedVector11 - crRightHandSideBoundedVector12 - crRightHandSideBoundedVector13 + crRightHandSideBoundedVector139 - crRightHandSideBoundedVector14;
const double crRightHandSideBoundedVector141 =             N(0)*crRightHandSideBoundedVector140;
const double crRightHandSideBoundedVector142 =             DN_DX(0,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector143 =             DN_DX(0,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector144 =             crRightHandSideBoundedVector123 - crRightHandSideBoundedVector6 - crRightHandSideBoundedVector7 - crRightHandSideBoundedVector8 - crRightHandSideBoundedVector9;
const double crRightHandSideBoundedVector145 =             N(0)*crRightHandSideBoundedVector144;
const double crRightHandSideBoundedVector146 =             crRightHandSideBoundedVector143 - crRightHandSideBoundedVector145;
const double crRightHandSideBoundedVector147 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector87;
const double crRightHandSideBoundedVector148 =             (N(0)*data.lamb_sc_nodes(0) + N(1)*data.lamb_sc_nodes(1) + N(2)*data.lamb_sc_nodes(2) + N(3)*data.lamb_sc_nodes(3) + data.lambda)/data.c_v;
const double crRightHandSideBoundedVector149 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector43;
const double crRightHandSideBoundedVector150 =             crRightHandSideBoundedVector25*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector151 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector152 =             crRightHandSideBoundedVector68*data.gamma;
const double crRightHandSideBoundedVector153 =             crRightHandSideBoundedVector95*data.gamma;
const double crRightHandSideBoundedVector154 =             1.0*crRightHandSideBoundedVector97;
const double crRightHandSideBoundedVector155 =             1.0*crRightHandSideBoundedVector74;
const double crRightHandSideBoundedVector156 =             crRightHandSideBoundedVector25*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector157 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector158 =             crRightHandSideBoundedVector127*crRightHandSideBoundedVector157;
const double crRightHandSideBoundedVector159 =             crRightHandSideBoundedVector38 + crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector160 =             crRightHandSideBoundedVector128*crRightHandSideBoundedVector157;
const double crRightHandSideBoundedVector161 =             crRightHandSideBoundedVector29*crRightHandSideBoundedVector33;
const double crRightHandSideBoundedVector162 =             -crRightHandSideBoundedVector34 - crRightHandSideBoundedVector35 - crRightHandSideBoundedVector36 - crRightHandSideBoundedVector37 - crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector163 =             crRightHandSideBoundedVector161 + crRightHandSideBoundedVector162;
const double crRightHandSideBoundedVector164 =             (N(0)*data.dUdt(0,3) + N(1)*data.dUdt(1,3) + N(2)*data.dUdt(2,3) + N(3)*data.dUdt(3,3) - crRightHandSideBoundedVector100*crRightHandSideBoundedVector154*crRightHandSideBoundedVector29 - crRightHandSideBoundedVector149 + crRightHandSideBoundedVector15*crRightHandSideBoundedVector23*(-crRightHandSideBoundedVector158 + crRightHandSideBoundedVector159) - crRightHandSideBoundedVector150 - crRightHandSideBoundedVector151 + crRightHandSideBoundedVector152*crRightHandSideBoundedVector92 + crRightHandSideBoundedVector153*crRightHandSideBoundedVector59 - crRightHandSideBoundedVector155*crRightHandSideBoundedVector156*crRightHandSideBoundedVector53 + crRightHandSideBoundedVector163*crRightHandSideBoundedVector53*crRightHandSideBoundedVector99 + crRightHandSideBoundedVector163*crRightHandSideBoundedVector78 + crRightHandSideBoundedVector90*(crRightHandSideBoundedVector159 - crRightHandSideBoundedVector160))/(crRightHandSideBoundedVector148*crRightHandSideBoundedVector42*crRightHandSideBoundedVector85 + crRightHandSideBoundedVector48);
const double crRightHandSideBoundedVector165 =             crRightHandSideBoundedVector164*crRightHandSideBoundedVector65;
const double crRightHandSideBoundedVector166 =             crRightHandSideBoundedVector110*crRightHandSideBoundedVector111 + crRightHandSideBoundedVector112;
const double crRightHandSideBoundedVector167 =             crRightHandSideBoundedVector115 + crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector168 =             crRightHandSideBoundedVector117*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector169 =             crRightHandSideBoundedVector101 - crRightHandSideBoundedVector167*crRightHandSideBoundedVector89 - crRightHandSideBoundedVector168*crRightHandSideBoundedVector90;
const double crRightHandSideBoundedVector170 =             N(0)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector171 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector142;
const double crRightHandSideBoundedVector172 =             crRightHandSideBoundedVector139*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector173 =             -2*crRightHandSideBoundedVector172 + crRightHandSideBoundedVector96 + crRightHandSideBoundedVector97;
const double crRightHandSideBoundedVector174 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector175 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector168 + crRightHandSideBoundedVector174*(crRightHandSideBoundedVector129 + 2*crRightHandSideBoundedVector28) + crRightHandSideBoundedVector25*crRightHandSideBoundedVector93;
const double crRightHandSideBoundedVector176 =             -crRightHandSideBoundedVector141 + crRightHandSideBoundedVector142;
const double crRightHandSideBoundedVector177 =             crRightHandSideBoundedVector149 + crRightHandSideBoundedVector150 + crRightHandSideBoundedVector151;
const double crRightHandSideBoundedVector178 =             crRightHandSideBoundedVector108*crRightHandSideBoundedVector59 + crRightHandSideBoundedVector113*crRightHandSideBoundedVector92 + crRightHandSideBoundedVector148*(-crRightHandSideBoundedVector105*crRightHandSideBoundedVector59 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector92 - crRightHandSideBoundedVector17*crRightHandSideBoundedVector38 + crRightHandSideBoundedVector22*crRightHandSideBoundedVector68);
const double crRightHandSideBoundedVector179 =             crRightHandSideBoundedVector108*crRightHandSideBoundedVector92 + crRightHandSideBoundedVector148*(-crRightHandSideBoundedVector107*crRightHandSideBoundedVector92 - crRightHandSideBoundedVector111*crRightHandSideBoundedVector59 - crRightHandSideBoundedVector20*crRightHandSideBoundedVector38 + crRightHandSideBoundedVector22*crRightHandSideBoundedVector95) + crRightHandSideBoundedVector166*crRightHandSideBoundedVector59;
const double crRightHandSideBoundedVector180 =             crRightHandSideBoundedVector152*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector181 =             crRightHandSideBoundedVector153*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector182 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector98;
const double crRightHandSideBoundedVector183 =             crRightHandSideBoundedVector158 + crRightHandSideBoundedVector162;
const double crRightHandSideBoundedVector184 =             crRightHandSideBoundedVector160 + crRightHandSideBoundedVector162;
const double crRightHandSideBoundedVector185 =             crRightHandSideBoundedVector159 - crRightHandSideBoundedVector161;
const double crRightHandSideBoundedVector186 =             -crRightHandSideBoundedVector10*crRightHandSideBoundedVector184 - crRightHandSideBoundedVector123*crRightHandSideBoundedVector185 - crRightHandSideBoundedVector139*crRightHandSideBoundedVector185 - crRightHandSideBoundedVector15*crRightHandSideBoundedVector183 + crRightHandSideBoundedVector180 + crRightHandSideBoundedVector181 - crRightHandSideBoundedVector182*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector25*crRightHandSideBoundedVector65*crRightHandSideBoundedVector75;
const double crRightHandSideBoundedVector187 =             N(0)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector188 =             -2.0*crRightHandSideBoundedVector124 + crRightHandSideBoundedVector155 + 1.0*crRightHandSideBoundedVector76;
const double crRightHandSideBoundedVector189 =             crRightHandSideBoundedVector126*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector190 =             crRightHandSideBoundedVector183*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector191 =             3.0*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector192 =             2.0*crRightHandSideBoundedVector157;
const double crRightHandSideBoundedVector193 =             crRightHandSideBoundedVector185 - crRightHandSideBoundedVector192*crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector194 =             -crRightHandSideBoundedVector130*crRightHandSideBoundedVector193 + crRightHandSideBoundedVector152 - crRightHandSideBoundedVector191*crRightHandSideBoundedVector58 + crRightHandSideBoundedVector67;
const double crRightHandSideBoundedVector195 =             crRightHandSideBoundedVector154 - 2.0*crRightHandSideBoundedVector172 + 1.0*crRightHandSideBoundedVector96;
const double crRightHandSideBoundedVector196 =             crRightHandSideBoundedVector184*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector197 =             crRightHandSideBoundedVector185 - crRightHandSideBoundedVector192*crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector198 =             crRightHandSideBoundedVector153 - crRightHandSideBoundedVector174*crRightHandSideBoundedVector197 - crRightHandSideBoundedVector191*crRightHandSideBoundedVector91 + crRightHandSideBoundedVector94;
const double crRightHandSideBoundedVector199 =             crRightHandSideBoundedVector164*crRightHandSideBoundedVector23*crRightHandSideBoundedVector55;
const double crRightHandSideBoundedVector200 =             crRightHandSideBoundedVector185*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector201 =             crRightHandSideBoundedVector129*crRightHandSideBoundedVector23 + 2*crRightHandSideBoundedVector157*(-crRightHandSideBoundedVector30 - crRightHandSideBoundedVector31) + 2*crRightHandSideBoundedVector34 + 2*crRightHandSideBoundedVector35 + 2*crRightHandSideBoundedVector36 + 2*crRightHandSideBoundedVector37 + 2*crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector202 =             crRightHandSideBoundedVector139*crRightHandSideBoundedVector201 - crRightHandSideBoundedVector15*crRightHandSideBoundedVector193 - crRightHandSideBoundedVector180 + 2.0*crRightHandSideBoundedVector182*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector203 =             -crRightHandSideBoundedVector10*crRightHandSideBoundedVector197 + crRightHandSideBoundedVector123*crRightHandSideBoundedVector201 + 2.0*crRightHandSideBoundedVector156*crRightHandSideBoundedVector75 - crRightHandSideBoundedVector181;
const double crRightHandSideBoundedVector204 =             N(1)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector205 =             DN_DX(1,1)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector206 =             DN_DX(1,0)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector207 =             N(1)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector208 =             DN_DX(1,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector209 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector208;
const double crRightHandSideBoundedVector210 =             N(1)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector211 =             DN_DX(1,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector212 =             N(1)*crRightHandSideBoundedVector133;
const double crRightHandSideBoundedVector213 =             N(1)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector214 =             N(1)*crRightHandSideBoundedVector140;
const double crRightHandSideBoundedVector215 =             DN_DX(1,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector216 =             DN_DX(1,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector217 =             N(1)*crRightHandSideBoundedVector144;
const double crRightHandSideBoundedVector218 =             crRightHandSideBoundedVector216 - crRightHandSideBoundedVector217;
const double crRightHandSideBoundedVector219 =             N(1)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector220 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector215;
const double crRightHandSideBoundedVector221 =             -crRightHandSideBoundedVector214 + crRightHandSideBoundedVector215;
const double crRightHandSideBoundedVector222 =             N(1)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector223 =             crRightHandSideBoundedVector210*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector224 =             N(2)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector225 =             DN_DX(2,1)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector226 =             DN_DX(2,0)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector227 =             N(2)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector228 =             DN_DX(2,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector229 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector228;
const double crRightHandSideBoundedVector230 =             N(2)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector231 =             DN_DX(2,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector232 =             N(2)*crRightHandSideBoundedVector133;
const double crRightHandSideBoundedVector233 =             N(2)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector234 =             N(2)*crRightHandSideBoundedVector140;
const double crRightHandSideBoundedVector235 =             DN_DX(2,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector236 =             DN_DX(2,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector237 =             N(2)*crRightHandSideBoundedVector144;
const double crRightHandSideBoundedVector238 =             crRightHandSideBoundedVector236 - crRightHandSideBoundedVector237;
const double crRightHandSideBoundedVector239 =             N(2)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector240 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector235;
const double crRightHandSideBoundedVector241 =             -crRightHandSideBoundedVector234 + crRightHandSideBoundedVector235;
const double crRightHandSideBoundedVector242 =             N(2)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector243 =             crRightHandSideBoundedVector230*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector244 =             N(3)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector245 =             DN_DX(3,1)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector246 =             DN_DX(3,0)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector247 =             N(3)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector248 =             DN_DX(3,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector249 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector248;
const double crRightHandSideBoundedVector250 =             N(3)*crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector251 =             DN_DX(3,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector252 =             N(3)*crRightHandSideBoundedVector133;
const double crRightHandSideBoundedVector253 =             N(3)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector254 =             N(3)*crRightHandSideBoundedVector140;
const double crRightHandSideBoundedVector255 =             DN_DX(3,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector256 =             DN_DX(3,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector257 =             N(3)*crRightHandSideBoundedVector144;
const double crRightHandSideBoundedVector258 =             crRightHandSideBoundedVector256 - crRightHandSideBoundedVector257;
const double crRightHandSideBoundedVector259 =             N(3)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector260 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector255;
const double crRightHandSideBoundedVector261 =             -crRightHandSideBoundedVector254 + crRightHandSideBoundedVector255;
const double crRightHandSideBoundedVector262 =             N(3)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector263 =             crRightHandSideBoundedVector250*crRightHandSideBoundedVector29;
            rRightHandSideBoundedVector[0] += DN_DX(0,0)*crRightHandSideBoundedVector19 - DN_DX(0,0)*crRightHandSideBoundedVector87 - DN_DX(0,1)*crRightHandSideBoundedVector102 + DN_DX(0,1)*crRightHandSideBoundedVector21 - N(0)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector5*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector5;
            rRightHandSideBoundedVector[1] += -DN_DX(0,0)*crRightHandSideBoundedVector165 - N(0)*crRightHandSideBoundedVector119 + N(0)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector103*crRightHandSideBoundedVector108 - crRightHandSideBoundedVector113*crRightHandSideBoundedVector114 - crRightHandSideBoundedVector138*(crRightHandSideBoundedVector121 - crRightHandSideBoundedVector132*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector134 + crRightHandSideBoundedVector135*crRightHandSideBoundedVector137) - crRightHandSideBoundedVector147*(crRightHandSideBoundedVector117*crRightHandSideBoundedVector141 - crRightHandSideBoundedVector117*crRightHandSideBoundedVector142 + crRightHandSideBoundedVector146) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector114*crRightHandSideBoundedVector116 + crRightHandSideBoundedVector120 - crRightHandSideBoundedVector122 - crRightHandSideBoundedVector125*crRightHandSideBoundedVector126 + crRightHandSideBoundedVector126*crRightHandSideBoundedVector131);
            rRightHandSideBoundedVector[2] += -DN_DX(0,1)*crRightHandSideBoundedVector165 - N(0)*crRightHandSideBoundedVector169 + N(0)*crRightHandSideBoundedVector88 - crRightHandSideBoundedVector103*crRightHandSideBoundedVector166 - crRightHandSideBoundedVector108*crRightHandSideBoundedVector114 - crRightHandSideBoundedVector138*(-crRightHandSideBoundedVector117*crRightHandSideBoundedVector143 + crRightHandSideBoundedVector117*crRightHandSideBoundedVector145 + crRightHandSideBoundedVector176) - crRightHandSideBoundedVector147*(-crRightHandSideBoundedVector121*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector132 + crRightHandSideBoundedVector134*crRightHandSideBoundedVector135 - crRightHandSideBoundedVector137) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector103*crRightHandSideBoundedVector167 - crRightHandSideBoundedVector126*crRightHandSideBoundedVector173 + crRightHandSideBoundedVector126*crRightHandSideBoundedVector175 + crRightHandSideBoundedVector170 - crRightHandSideBoundedVector171);
            rRightHandSideBoundedVector[3] += N(0)*crRightHandSideBoundedVector177 - crRightHandSideBoundedVector102*(-DN_DX(0,1)*crRightHandSideBoundedVector196 + crRightHandSideBoundedVector170 - crRightHandSideBoundedVector171*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector187*crRightHandSideBoundedVector198 - crRightHandSideBoundedVector189*crRightHandSideBoundedVector195) - crRightHandSideBoundedVector103*crRightHandSideBoundedVector179 - crRightHandSideBoundedVector114*crRightHandSideBoundedVector178 - crRightHandSideBoundedVector186*crRightHandSideBoundedVector187 - crRightHandSideBoundedVector199*(crRightHandSideBoundedVector146 + crRightHandSideBoundedVector176) - crRightHandSideBoundedVector49*(N(0)*crRightHandSideBoundedVector43 + crRightHandSideBoundedVector126*crRightHandSideBoundedVector202 + crRightHandSideBoundedVector126*crRightHandSideBoundedVector203 - crRightHandSideBoundedVector142*crRightHandSideBoundedVector200 - crRightHandSideBoundedVector143*crRightHandSideBoundedVector200) - crRightHandSideBoundedVector87*(-DN_DX(0,0)*crRightHandSideBoundedVector190 + crRightHandSideBoundedVector120 - crRightHandSideBoundedVector122*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector187*crRightHandSideBoundedVector194 - crRightHandSideBoundedVector188*crRightHandSideBoundedVector189);
            rRightHandSideBoundedVector[4] += DN_DX(1,0)*crRightHandSideBoundedVector19 - DN_DX(1,0)*crRightHandSideBoundedVector87 - DN_DX(1,1)*crRightHandSideBoundedVector102 + DN_DX(1,1)*crRightHandSideBoundedVector21 - N(1)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector204*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector204;
            rRightHandSideBoundedVector[5] += -DN_DX(1,0)*crRightHandSideBoundedVector165 - N(1)*crRightHandSideBoundedVector119 + N(1)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector108*crRightHandSideBoundedVector205 - crRightHandSideBoundedVector113*crRightHandSideBoundedVector206 - crRightHandSideBoundedVector138*(crRightHandSideBoundedVector135*crRightHandSideBoundedVector213 + crRightHandSideBoundedVector208 - crRightHandSideBoundedVector211*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector212) - crRightHandSideBoundedVector147*(crRightHandSideBoundedVector117*crRightHandSideBoundedVector214 - crRightHandSideBoundedVector117*crRightHandSideBoundedVector215 + crRightHandSideBoundedVector218) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector116*crRightHandSideBoundedVector206 - crRightHandSideBoundedVector125*crRightHandSideBoundedVector210 + crRightHandSideBoundedVector131*crRightHandSideBoundedVector210 + crRightHandSideBoundedVector207 - crRightHandSideBoundedVector209);
            rRightHandSideBoundedVector[6] += -DN_DX(1,1)*crRightHandSideBoundedVector165 - N(1)*crRightHandSideBoundedVector169 + N(1)*crRightHandSideBoundedVector88 - crRightHandSideBoundedVector108*crRightHandSideBoundedVector206 - crRightHandSideBoundedVector138*(-crRightHandSideBoundedVector117*crRightHandSideBoundedVector216 + crRightHandSideBoundedVector117*crRightHandSideBoundedVector217 + crRightHandSideBoundedVector221) - crRightHandSideBoundedVector147*(crRightHandSideBoundedVector135*crRightHandSideBoundedVector212 - crRightHandSideBoundedVector208*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector211 - crRightHandSideBoundedVector213) - crRightHandSideBoundedVector166*crRightHandSideBoundedVector205 - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector167*crRightHandSideBoundedVector205 - crRightHandSideBoundedVector173*crRightHandSideBoundedVector210 + crRightHandSideBoundedVector175*crRightHandSideBoundedVector210 + crRightHandSideBoundedVector219 - crRightHandSideBoundedVector220);
            rRightHandSideBoundedVector[7] += N(1)*crRightHandSideBoundedVector177 - crRightHandSideBoundedVector102*(-DN_DX(1,1)*crRightHandSideBoundedVector196 - crRightHandSideBoundedVector195*crRightHandSideBoundedVector223 + crRightHandSideBoundedVector198*crRightHandSideBoundedVector222 + crRightHandSideBoundedVector219 - crRightHandSideBoundedVector220*crRightHandSideBoundedVector65) - crRightHandSideBoundedVector178*crRightHandSideBoundedVector206 - crRightHandSideBoundedVector179*crRightHandSideBoundedVector205 - crRightHandSideBoundedVector186*crRightHandSideBoundedVector222 - crRightHandSideBoundedVector199*(crRightHandSideBoundedVector218 + crRightHandSideBoundedVector221) - crRightHandSideBoundedVector49*(N(1)*crRightHandSideBoundedVector43 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector215 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector216 + crRightHandSideBoundedVector202*crRightHandSideBoundedVector210 + crRightHandSideBoundedVector203*crRightHandSideBoundedVector210) - crRightHandSideBoundedVector87*(-DN_DX(1,0)*crRightHandSideBoundedVector190 - crRightHandSideBoundedVector188*crRightHandSideBoundedVector223 + crRightHandSideBoundedVector194*crRightHandSideBoundedVector222 + crRightHandSideBoundedVector207 - crRightHandSideBoundedVector209*crRightHandSideBoundedVector65);
            rRightHandSideBoundedVector[8] += DN_DX(2,0)*crRightHandSideBoundedVector19 - DN_DX(2,0)*crRightHandSideBoundedVector87 - DN_DX(2,1)*crRightHandSideBoundedVector102 + DN_DX(2,1)*crRightHandSideBoundedVector21 - N(2)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector224*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector224;
            rRightHandSideBoundedVector[9] += -DN_DX(2,0)*crRightHandSideBoundedVector165 - N(2)*crRightHandSideBoundedVector119 + N(2)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector108*crRightHandSideBoundedVector225 - crRightHandSideBoundedVector113*crRightHandSideBoundedVector226 - crRightHandSideBoundedVector138*(crRightHandSideBoundedVector135*crRightHandSideBoundedVector233 + crRightHandSideBoundedVector228 - crRightHandSideBoundedVector231*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector232) - crRightHandSideBoundedVector147*(crRightHandSideBoundedVector117*crRightHandSideBoundedVector234 - crRightHandSideBoundedVector117*crRightHandSideBoundedVector235 + crRightHandSideBoundedVector238) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector116*crRightHandSideBoundedVector226 - crRightHandSideBoundedVector125*crRightHandSideBoundedVector230 + crRightHandSideBoundedVector131*crRightHandSideBoundedVector230 + crRightHandSideBoundedVector227 - crRightHandSideBoundedVector229);
            rRightHandSideBoundedVector[10] += -DN_DX(2,1)*crRightHandSideBoundedVector165 - N(2)*crRightHandSideBoundedVector169 + N(2)*crRightHandSideBoundedVector88 - crRightHandSideBoundedVector108*crRightHandSideBoundedVector226 - crRightHandSideBoundedVector138*(-crRightHandSideBoundedVector117*crRightHandSideBoundedVector236 + crRightHandSideBoundedVector117*crRightHandSideBoundedVector237 + crRightHandSideBoundedVector241) - crRightHandSideBoundedVector147*(crRightHandSideBoundedVector135*crRightHandSideBoundedVector232 - crRightHandSideBoundedVector228*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector231 - crRightHandSideBoundedVector233) - crRightHandSideBoundedVector166*crRightHandSideBoundedVector225 - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector167*crRightHandSideBoundedVector225 - crRightHandSideBoundedVector173*crRightHandSideBoundedVector230 + crRightHandSideBoundedVector175*crRightHandSideBoundedVector230 + crRightHandSideBoundedVector239 - crRightHandSideBoundedVector240);
            rRightHandSideBoundedVector[11] += N(2)*crRightHandSideBoundedVector177 - crRightHandSideBoundedVector102*(-DN_DX(2,1)*crRightHandSideBoundedVector196 - crRightHandSideBoundedVector195*crRightHandSideBoundedVector243 + crRightHandSideBoundedVector198*crRightHandSideBoundedVector242 + crRightHandSideBoundedVector239 - crRightHandSideBoundedVector240*crRightHandSideBoundedVector65) - crRightHandSideBoundedVector178*crRightHandSideBoundedVector226 - crRightHandSideBoundedVector179*crRightHandSideBoundedVector225 - crRightHandSideBoundedVector186*crRightHandSideBoundedVector242 - crRightHandSideBoundedVector199*(crRightHandSideBoundedVector238 + crRightHandSideBoundedVector241) - crRightHandSideBoundedVector49*(N(2)*crRightHandSideBoundedVector43 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector235 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector236 + crRightHandSideBoundedVector202*crRightHandSideBoundedVector230 + crRightHandSideBoundedVector203*crRightHandSideBoundedVector230) - crRightHandSideBoundedVector87*(-DN_DX(2,0)*crRightHandSideBoundedVector190 - crRightHandSideBoundedVector188*crRightHandSideBoundedVector243 + crRightHandSideBoundedVector194*crRightHandSideBoundedVector242 + crRightHandSideBoundedVector227 - crRightHandSideBoundedVector229*crRightHandSideBoundedVector65);
            rRightHandSideBoundedVector[12] += DN_DX(3,0)*crRightHandSideBoundedVector19 - DN_DX(3,0)*crRightHandSideBoundedVector87 - DN_DX(3,1)*crRightHandSideBoundedVector102 + DN_DX(3,1)*crRightHandSideBoundedVector21 - N(3)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector244*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector244;
            rRightHandSideBoundedVector[13] += -DN_DX(3,0)*crRightHandSideBoundedVector165 - N(3)*crRightHandSideBoundedVector119 + N(3)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector108*crRightHandSideBoundedVector245 - crRightHandSideBoundedVector113*crRightHandSideBoundedVector246 - crRightHandSideBoundedVector138*(crRightHandSideBoundedVector135*crRightHandSideBoundedVector253 + crRightHandSideBoundedVector248 - crRightHandSideBoundedVector251*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector252) - crRightHandSideBoundedVector147*(crRightHandSideBoundedVector117*crRightHandSideBoundedVector254 - crRightHandSideBoundedVector117*crRightHandSideBoundedVector255 + crRightHandSideBoundedVector258) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector116*crRightHandSideBoundedVector246 - crRightHandSideBoundedVector125*crRightHandSideBoundedVector250 + crRightHandSideBoundedVector131*crRightHandSideBoundedVector250 + crRightHandSideBoundedVector247 - crRightHandSideBoundedVector249);
            rRightHandSideBoundedVector[14] += -DN_DX(3,1)*crRightHandSideBoundedVector165 - N(3)*crRightHandSideBoundedVector169 + N(3)*crRightHandSideBoundedVector88 - crRightHandSideBoundedVector108*crRightHandSideBoundedVector246 - crRightHandSideBoundedVector138*(-crRightHandSideBoundedVector117*crRightHandSideBoundedVector256 + crRightHandSideBoundedVector117*crRightHandSideBoundedVector257 + crRightHandSideBoundedVector261) - crRightHandSideBoundedVector147*(crRightHandSideBoundedVector135*crRightHandSideBoundedVector252 - crRightHandSideBoundedVector248*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector251 - crRightHandSideBoundedVector253) - crRightHandSideBoundedVector166*crRightHandSideBoundedVector245 - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector167*crRightHandSideBoundedVector245 - crRightHandSideBoundedVector173*crRightHandSideBoundedVector250 + crRightHandSideBoundedVector175*crRightHandSideBoundedVector250 + crRightHandSideBoundedVector259 - crRightHandSideBoundedVector260);
            rRightHandSideBoundedVector[15] += N(3)*crRightHandSideBoundedVector177 - crRightHandSideBoundedVector102*(-DN_DX(3,1)*crRightHandSideBoundedVector196 - crRightHandSideBoundedVector195*crRightHandSideBoundedVector263 + crRightHandSideBoundedVector198*crRightHandSideBoundedVector262 + crRightHandSideBoundedVector259 - crRightHandSideBoundedVector260*crRightHandSideBoundedVector65) - crRightHandSideBoundedVector178*crRightHandSideBoundedVector246 - crRightHandSideBoundedVector179*crRightHandSideBoundedVector245 - crRightHandSideBoundedVector186*crRightHandSideBoundedVector262 - crRightHandSideBoundedVector199*(crRightHandSideBoundedVector258 + crRightHandSideBoundedVector261) - crRightHandSideBoundedVector49*(N(3)*crRightHandSideBoundedVector43 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector255 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector256 + crRightHandSideBoundedVector202*crRightHandSideBoundedVector250 + crRightHandSideBoundedVector203*crRightHandSideBoundedVector250) - crRightHandSideBoundedVector87*(-DN_DX(3,0)*crRightHandSideBoundedVector190 - crRightHandSideBoundedVector188*crRightHandSideBoundedVector263 + crRightHandSideBoundedVector194*crRightHandSideBoundedVector262 + crRightHandSideBoundedVector247 - crRightHandSideBoundedVector249*crRightHandSideBoundedVector65);

        }
    }

    KRATOS_CATCH("")
}


template <>
void CompressibleNavierStokesExplicit<2,4>::CalculateMassMatrix(
    MatrixType &rMassMatrix,
    const ProcessInfo &rCurrentProcessInfo)
{
    constexpr double dof_weight = 1.0 / DofSize;

    rMassMatrix = ZeroMatrix(DofSize, DofSize);

    for(IndexType i=0; i<NumNodes; ++i)
    {
        for(IndexType j=i; j<NumNodes; ++j)
        {
            const IndexType dof = i + j * BlockSize;

            rMassMatrix(i, dof) += dof_weight;
            rMassMatrix(dof, i) += dof_weight;
        }
    }

    // Here we assume that all the Gauss pt. have the same weight so we multiply by the volume
    rMassMatrix *= GetGeometry().Area();
}

///////////////////////////////////////////////////////////////////////////////////////////////////
// Class template instantiation

template class CompressibleNavierStokesExplicit<2,4>;

}
