//    |  /           |
//    ' /   __| _` | __|  _ \   __|
//    . \  |   (   | |   (   |\__ `
//   _|\_\_|  \__,_|\__|\___/ ____/
//                   Multi-Physics
//
//  License:         BSD License
//                   Kratos default license: kratos/license.txt
//
//  Main authors:    Eduard GÃ³mez, Ruben Zorrilla
//

/**
 *
 *                          WARNING! THIS FILE IS READ-ONLY
 *
 * This file has been auto-generated by compressible_navier_stokes_symbolic_generator.py
 * located in the symbolic_generation directories of the FluidDynamicsApplication
 *
 * Any modifications to this file will be overwritten if and when that script is run again.
 *
 * In order to do any lasting changes, modify the template used by the script:
 * templates/compressible_navier_stokes_explicit_template_2D4N.cpp
 * located in the symbolic_generation directories of the FluidDynamicsApplication.
 *
 * In order to change the formulation you will have to modify the script itself.
 */

// System includes


// External includes


// Project includes
#include "includes/checks.h"
#include "utilities/element_size_calculator.h"

// Application includes
#include "custom_elements/compressible_navier_stokes_explicit.h"


namespace Kratos {

template<>
GeometryData::IntegrationMethod CompressibleNavierStokesExplicit<2,4>::GetIntegrationMethod() const
{
    return GeometryData::IntegrationMethod::GI_GAUSS_2;
}

template <>
void CompressibleNavierStokesExplicit<2,4>::EquationIdVector(
    EquationIdVectorType &rResult,
    const ProcessInfo &rCurrentProcessInfo) const
{
    KRATOS_TRY

    if (rResult.size() != DofSize) {
        rResult.resize(DofSize);
    }

    unsigned int local_index = 0;
    const auto& r_geometry = GetGeometry();
    const unsigned int den_pos = r_geometry[0].GetDofPosition(DENSITY);
    const unsigned int mom_pos = r_geometry[0].GetDofPosition(MOMENTUM);
    const unsigned int enr_pos = r_geometry[0].GetDofPosition(TOTAL_ENERGY);
    for (unsigned int i_node = 0; i_node < NumNodes; ++i_node) {
        rResult[local_index++] = r_geometry[i_node].GetDof(DENSITY, den_pos).EquationId();
        rResult[local_index++] = r_geometry[i_node].GetDof(MOMENTUM_X, mom_pos).EquationId();
        rResult[local_index++] = r_geometry[i_node].GetDof(MOMENTUM_Y, mom_pos + 1).EquationId();
        rResult[local_index++] = r_geometry[i_node].GetDof(TOTAL_ENERGY, enr_pos).EquationId();
    }

    KRATOS_CATCH("");
}

template <>
void CompressibleNavierStokesExplicit<2,4>::GetDofList(
    DofsVectorType &ElementalDofList,
    const ProcessInfo &rCurrentProcessInfo) const
{
    KRATOS_TRY

    if (ElementalDofList.size() != DofSize) {
        ElementalDofList.resize(DofSize);
    }

    unsigned int local_index = 0;
    const auto& r_geometry = GetGeometry();
    const unsigned int den_pos = r_geometry[0].GetDofPosition(DENSITY);
    const unsigned int mom_pos = r_geometry[0].GetDofPosition(MOMENTUM);
    const unsigned int enr_pos = r_geometry[0].GetDofPosition(TOTAL_ENERGY);
    for (unsigned int i_node = 0; i_node < NumNodes; ++i_node) {
        ElementalDofList[local_index++] = r_geometry[i_node].pGetDof(DENSITY, den_pos);
        ElementalDofList[local_index++] = r_geometry[i_node].pGetDof(MOMENTUM_X, mom_pos);
        ElementalDofList[local_index++] = r_geometry[i_node].pGetDof(MOMENTUM_Y, mom_pos + 1);
        ElementalDofList[local_index++] = r_geometry[i_node].pGetDof(TOTAL_ENERGY, enr_pos);
    }

    KRATOS_CATCH("");
}


void ComputeMidpointShapeFunctions(
    const Geometry<Node<3>>& rGeometry,
    Vector& rN,
    Matrix& rDN_DX)
{
    Matrix DN_De;
    Matrix Jinv;

    const auto center = rGeometry.Center();
    rGeometry.ShapeFunctionsValues(rN, center);
    rGeometry.InverseOfJacobian(Jinv, center);

    rGeometry.ShapeFunctionsLocalGradients(DN_De, center);
    GeometryUtils::ShapeFunctionsGradients(DN_De, Jinv, rDN_DX);
}


template <>
array_1d<double,3> CompressibleNavierStokesExplicit<2,4>::CalculateMidPointVelocityRotational() const
{
    // Get geometry data
    const auto& r_geometry = GetGeometry();

    Vector N;
    Matrix DN_DX;

    ComputeMidpointShapeFunctions(r_geometry, N, DN_DX);

    // Calculate midpoint magnitudes
    double midpoint_rho = 0.0;
    double midpoint_dmy_dx = 0.0;
    double midpoint_dmx_dy = 0.0;
    double midpoint_rho_dx = 0.0;
    double midpoint_rho_dy = 0.0;
    array_1d<double, 3> midpoint_mom = ZeroVector(3);

    for (unsigned int i_node = 0; i_node < NumNodes; ++i_node) {
        auto& r_node = r_geometry[i_node];

        const auto node_dNdX = row(DN_DX, i_node);
        const auto node_N = N(i_node);

        const auto& r_mom = r_node.FastGetSolutionStepValue(MOMENTUM);
        const double& r_rho = r_node.FastGetSolutionStepValue(DENSITY);
        midpoint_rho += node_N * r_rho;
        midpoint_mom += node_N * r_mom;
        midpoint_dmy_dx += r_mom[1] * node_dNdX[0];
        midpoint_dmx_dy += r_mom[0] * node_dNdX[1];
        midpoint_rho_dx += r_rho * node_dNdX[0];
        midpoint_rho_dy += r_rho * node_dNdX[1];
    }

    // Calculate velocity rotational
    // Note that the formulation is written in conservative variables. Hence we do rot(mom/rho).
    const double dvy_dx = (midpoint_dmy_dx * midpoint_rho - midpoint_mom[1] * midpoint_rho_dx) / std::pow(midpoint_rho, 2);
    const double dvx_dy = (midpoint_dmx_dy * midpoint_rho - midpoint_mom[0] * midpoint_rho_dy) / std::pow(midpoint_rho, 2);
    array_1d<double,3> midpoint_rot_v;
    midpoint_rot_v[0] = 0.0;
    midpoint_rot_v[1] = 0.0;
    midpoint_rot_v[2] = dvy_dx - dvx_dy;
    return midpoint_rot_v;
}


template <>
BoundedMatrix<double, 3, 3> CompressibleNavierStokesExplicit<2, 4>::CalculateMidPointVelocityGradient() const
{
    KRATOS_TRY

    // Get geometry data
    const auto& r_geometry = GetGeometry();

    Vector N;
    Matrix DN_DX;

    ComputeMidpointShapeFunctions(r_geometry, N, DN_DX);

    // Calculate midpoint magnitudes
    double midpoint_rho = 0.0;
    double midpoint_dmx_dx = 0.0;
    double midpoint_dmx_dy = 0.0;
    double midpoint_dmy_dx = 0.0;
    double midpoint_dmy_dy = 0.0;
    double midpoint_rho_dx = 0.0;
    double midpoint_rho_dy = 0.0;
    array_1d<double,3> midpoint_mom = ZeroVector(3);

    for (unsigned int i_node = 0; i_node < NumNodes; ++i_node) {
        auto& r_node = r_geometry[i_node];

        const auto node_dNdX = row(DN_DX, i_node);
        const auto node_N = N(i_node);

        const auto& r_mom = r_node.FastGetSolutionStepValue(MOMENTUM);
        const double& r_rho = r_node.FastGetSolutionStepValue(DENSITY);
        midpoint_rho += node_N * r_rho;
        midpoint_mom += node_N * r_mom;
        midpoint_dmx_dx += r_mom[0] * node_dNdX[0];
        midpoint_dmx_dy += r_mom[0] * node_dNdX[1];
        midpoint_dmy_dx += r_mom[1] * node_dNdX[0];
        midpoint_dmy_dy += r_mom[1] * node_dNdX[1];
        midpoint_rho_dx += r_rho * node_dNdX[0];
        midpoint_rho_dy += r_rho * node_dNdX[1];
    }

    // Calculate velocity gradient
    // Note that the formulation is written in conservative variables. Hence we do grad(mom/rho).
    BoundedMatrix<double, 3, 3> midpoint_grad_v = ZeroMatrix(3, 3);
    midpoint_grad_v(0,0) = (midpoint_dmx_dx * midpoint_rho - midpoint_mom[0] * midpoint_rho_dx);
    midpoint_grad_v(0,1) = (midpoint_dmx_dy * midpoint_rho - midpoint_mom[0] * midpoint_rho_dy);
    midpoint_grad_v(1,0) = (midpoint_dmy_dx * midpoint_rho - midpoint_mom[1] * midpoint_rho_dx);
    midpoint_grad_v(1,1) = (midpoint_dmy_dy * midpoint_rho - midpoint_mom[1] * midpoint_rho_dy);
    midpoint_grad_v /= std::pow(midpoint_rho, 2);

    return midpoint_grad_v;

    KRATOS_CATCH("")
}


template <>
void CompressibleNavierStokesExplicit<2,4>::CalculateMomentumProjection(const ProcessInfo& rCurrentProcessInfo)
{
    KRATOS_TRY

    // Struct to pass around the data
    ElementDataStruct data;
    this->FillElementData(data, rCurrentProcessInfo);

    // Calculate shock capturing values
    constexpr std::size_t vector_size = Dim*NumNodes;
    BoundedVector<double, vector_size> mom_proj = ZeroVector(vector_size);

    Vector N;
    Matrix DN_De;
    Matrix DN_DX;

    Matrix J;
    Matrix Jinv;

    auto& r_geometry = GetGeometry();
    const auto& gauss_points = r_geometry.IntegrationPoints(GetIntegrationMethod());
    for(const auto& gauss_point: gauss_points)
    {
        const double w = gauss_point.Weight();
        r_geometry.ShapeFunctionsValues(N, gauss_point.Coordinates());
        r_geometry.InverseOfJacobian(Jinv, gauss_point.Coordinates());
        r_geometry.ShapeFunctionsLocalGradients(DN_DX_iso, gauss_point.Coordinates());
        GeometryUtils::ShapeFunctionsGradients(DN_DX_iso, Jinv, DN_DX);

const double cmom_proj0 =             data.gamma - 1;
const double cmom_proj1 =             N(0)*data.U(0,0) + N(1)*data.U(1,0) + N(2)*data.U(2,0) + N(3)*data.U(3,0);
const double cmom_proj2 =             DN_DX(0,1)*data.U(0,1) + DN_DX(1,1)*data.U(1,1) + DN_DX(2,1)*data.U(2,1) + DN_DX(3,1)*data.U(3,1);
const double cmom_proj3 =             1.0/cmom_proj1;
const double cmom_proj4 =             N(0)*data.U(0,2) + N(1)*data.U(1,2) + N(2)*data.U(2,2) + N(3)*data.U(3,2);
const double cmom_proj5 =             cmom_proj3*cmom_proj4;
const double cmom_proj6 =             DN_DX(0,1)*data.U(0,2) + DN_DX(1,1)*data.U(1,2) + DN_DX(2,1)*data.U(2,2) + DN_DX(3,1)*data.U(3,2);
const double cmom_proj7 =             N(0)*data.U(0,1) + N(1)*data.U(1,1) + N(2)*data.U(2,1) + N(3)*data.U(3,1);
const double cmom_proj8 =             cmom_proj3*cmom_proj7;
const double cmom_proj9 =             DN_DX(0,0)*data.U(0,2) + DN_DX(1,0)*data.U(1,2) + DN_DX(2,0)*data.U(2,2) + DN_DX(3,0)*data.U(3,2);
const double cmom_proj10 =             1.0*cmom_proj0;
const double cmom_proj11 =             DN_DX(0,0)*data.U(0,1) + DN_DX(1,0)*data.U(1,1) + DN_DX(2,0)*data.U(2,1) + DN_DX(3,0)*data.U(3,1);
const double cmom_proj12 =             1.0*data.gamma - 3.0;
const double cmom_proj13 =             pow(cmom_proj1, -2);
const double cmom_proj14 =             cmom_proj13*(DN_DX(0,1)*data.U(0,0) + DN_DX(1,1)*data.U(1,0) + DN_DX(2,1)*data.U(2,0) + DN_DX(3,1)*data.U(3,0));
const double cmom_proj15 =             cmom_proj4*cmom_proj7;
const double cmom_proj16 =             pow(cmom_proj7, 2);
const double cmom_proj17 =             pow(cmom_proj4, 2);
const double cmom_proj18 =             -cmom_proj0*(0.5*cmom_proj16 + 0.5*cmom_proj17);
const double cmom_proj19 =             cmom_proj13*(DN_DX(0,0)*data.U(0,0) + DN_DX(1,0)*data.U(1,0) + DN_DX(2,0)*data.U(2,0) + DN_DX(3,0)*data.U(3,0));
const double cmom_proj20 =             N(0)*data.dUdt(0,1) + N(1)*data.dUdt(1,1) + N(2)*data.dUdt(2,1) + N(3)*data.dUdt(3,1) + cmom_proj0*(DN_DX(0,0)*data.U(0,3) + DN_DX(1,0)*data.U(1,3) + DN_DX(2,0)*data.U(2,3) + DN_DX(3,0)*data.U(3,3)) - cmom_proj1*(N(0)*data.f_ext(0,0) + N(1)*data.f_ext(1,0) + N(2)*data.f_ext(2,0) + N(3)*data.f_ext(3,0)) - cmom_proj10*cmom_proj5*cmom_proj9 - cmom_proj11*cmom_proj12*cmom_proj8 - cmom_proj14*cmom_proj15 - cmom_proj19*(cmom_proj16 + cmom_proj18) + cmom_proj2*cmom_proj5 + cmom_proj6*cmom_proj8;
const double cmom_proj21 =             N(0)*data.dUdt(0,2) + N(1)*data.dUdt(1,2) + N(2)*data.dUdt(2,2) + N(3)*data.dUdt(3,2) + cmom_proj0*(DN_DX(0,1)*data.U(0,3) + DN_DX(1,1)*data.U(1,3) + DN_DX(2,1)*data.U(2,3) + DN_DX(3,1)*data.U(3,3)) - cmom_proj1*(N(0)*data.f_ext(0,1) + N(1)*data.f_ext(1,1) + N(2)*data.f_ext(2,1) + N(3)*data.f_ext(3,1)) - cmom_proj10*cmom_proj2*cmom_proj8 + cmom_proj11*cmom_proj5 - cmom_proj12*cmom_proj5*cmom_proj6 - cmom_proj14*(cmom_proj17 + cmom_proj18) - cmom_proj15*cmom_proj19 + cmom_proj8*cmom_proj9;
            mom_proj[0] += -N(0)*cmom_proj20;
            mom_proj[1] += -N(0)*cmom_proj21;
            mom_proj[2] += -N(1)*cmom_proj20;
            mom_proj[3] += -N(1)*cmom_proj21;
            mom_proj[4] += -N(2)*cmom_proj20;
            mom_proj[5] += -N(2)*cmom_proj21;
            mom_proj[6] += -N(3)*cmom_proj20;
            mom_proj[7] += -N(3)*cmom_proj21;

        double detJ;
        r_geometry.Jacobian(J, gauss_point.Coordinates());
        MathUtils<double>::InvertMatrix(J, Jinv, detJ);

        r_geometry.ShapeFunctionsLocalGradients(DN_De, gauss_point.Coordinates());
        GeometryUtils::ShapeFunctionsGradients(DN_De, Jinv, DN_DX);

        BoundedVector<double, vector_size> mom_proj_gauss(DofSize);

const double cmom_proj_gauss0 =             data.gamma - 1;
const double cmom_proj_gauss1 =             N(0)*data.U(0,0) + N(1)*data.U(1,0) + N(2)*data.U(2,0) + N(3)*data.U(3,0);
const double cmom_proj_gauss2 =             DN_DX(0,1)*data.U(0,1) + DN_DX(1,1)*data.U(1,1) + DN_DX(2,1)*data.U(2,1) + DN_DX(3,1)*data.U(3,1);
const double cmom_proj_gauss3 =             1.0/cmom_proj_gauss1;
const double cmom_proj_gauss4 =             N(0)*data.U(0,2) + N(1)*data.U(1,2) + N(2)*data.U(2,2) + N(3)*data.U(3,2);
const double cmom_proj_gauss5 =             cmom_proj_gauss3*cmom_proj_gauss4;
const double cmom_proj_gauss6 =             DN_DX(0,1)*data.U(0,2) + DN_DX(1,1)*data.U(1,2) + DN_DX(2,1)*data.U(2,2) + DN_DX(3,1)*data.U(3,2);
const double cmom_proj_gauss7 =             N(0)*data.U(0,1) + N(1)*data.U(1,1) + N(2)*data.U(2,1) + N(3)*data.U(3,1);
const double cmom_proj_gauss8 =             cmom_proj_gauss3*cmom_proj_gauss7;
const double cmom_proj_gauss9 =             DN_DX(0,0)*data.U(0,2) + DN_DX(1,0)*data.U(1,2) + DN_DX(2,0)*data.U(2,2) + DN_DX(3,0)*data.U(3,2);
const double cmom_proj_gauss10 =             1.0*cmom_proj_gauss0;
const double cmom_proj_gauss11 =             DN_DX(0,0)*data.U(0,1) + DN_DX(1,0)*data.U(1,1) + DN_DX(2,0)*data.U(2,1) + DN_DX(3,0)*data.U(3,1);
const double cmom_proj_gauss12 =             1.0*data.gamma - 3.0;
const double cmom_proj_gauss13 =             pow(cmom_proj_gauss1, -2);
const double cmom_proj_gauss14 =             cmom_proj_gauss13*(DN_DX(0,1)*data.U(0,0) + DN_DX(1,1)*data.U(1,0) + DN_DX(2,1)*data.U(2,0) + DN_DX(3,1)*data.U(3,0));
const double cmom_proj_gauss15 =             cmom_proj_gauss4*cmom_proj_gauss7;
const double cmom_proj_gauss16 =             pow(cmom_proj_gauss7, 2);
const double cmom_proj_gauss17 =             pow(cmom_proj_gauss4, 2);
const double cmom_proj_gauss18 =             0.5*cmom_proj_gauss0*(cmom_proj_gauss16 + cmom_proj_gauss17);
const double cmom_proj_gauss19 =             cmom_proj_gauss13*(DN_DX(0,0)*data.U(0,0) + DN_DX(1,0)*data.U(1,0) + DN_DX(2,0)*data.U(2,0) + DN_DX(3,0)*data.U(3,0));
const double cmom_proj_gauss20 =             N(0)*data.dUdt(0,1) + N(1)*data.dUdt(1,1) + N(2)*data.dUdt(2,1) + N(3)*data.dUdt(3,1) + cmom_proj_gauss0*(DN_DX(0,0)*data.U(0,3) + DN_DX(1,0)*data.U(1,3) + DN_DX(2,0)*data.U(2,3) + DN_DX(3,0)*data.U(3,3)) - cmom_proj_gauss1*(N(0)*data.f_ext(0,0) + N(1)*data.f_ext(1,0) + N(2)*data.f_ext(2,0) + N(3)*data.f_ext(3,0)) - cmom_proj_gauss10*cmom_proj_gauss5*cmom_proj_gauss9 - cmom_proj_gauss11*cmom_proj_gauss12*cmom_proj_gauss8 - cmom_proj_gauss14*cmom_proj_gauss15 + cmom_proj_gauss19*(-cmom_proj_gauss16 + cmom_proj_gauss18) + cmom_proj_gauss2*cmom_proj_gauss5 + cmom_proj_gauss6*cmom_proj_gauss8;
const double cmom_proj_gauss21 =             N(0)*data.dUdt(0,2) + N(1)*data.dUdt(1,2) + N(2)*data.dUdt(2,2) + N(3)*data.dUdt(3,2) + cmom_proj_gauss0*(DN_DX(0,1)*data.U(0,3) + DN_DX(1,1)*data.U(1,3) + DN_DX(2,1)*data.U(2,3) + DN_DX(3,1)*data.U(3,3)) - cmom_proj_gauss1*(N(0)*data.f_ext(0,1) + N(1)*data.f_ext(1,1) + N(2)*data.f_ext(2,1) + N(3)*data.f_ext(3,1)) - cmom_proj_gauss10*cmom_proj_gauss2*cmom_proj_gauss8 + cmom_proj_gauss11*cmom_proj_gauss5 - cmom_proj_gauss12*cmom_proj_gauss5*cmom_proj_gauss6 + cmom_proj_gauss14*(-cmom_proj_gauss17 + cmom_proj_gauss18) - cmom_proj_gauss15*cmom_proj_gauss19 + cmom_proj_gauss8*cmom_proj_gauss9;
            mom_proj_gauss[0] = -N(0)*cmom_proj_gauss20;
            mom_proj_gauss[1] = -N(0)*cmom_proj_gauss21;
            mom_proj_gauss[2] = -N(1)*cmom_proj_gauss20;
            mom_proj_gauss[3] = -N(1)*cmom_proj_gauss21;
            mom_proj_gauss[4] = -N(2)*cmom_proj_gauss20;
            mom_proj_gauss[5] = -N(2)*cmom_proj_gauss21;
            mom_proj_gauss[6] = -N(3)*cmom_proj_gauss20;
            mom_proj_gauss[7] = -N(3)*cmom_proj_gauss21;


        mom_proj += w * detJ * mom_proj_gauss;
    }

    // Assembly the projection contributions
    for (IndexType i_node = 0; i_node < NumNodes; ++i_node) {
        const IndexType aux = i_node * Dim;
        auto& r_mom_proj = r_geometry[i_node].GetValue(MOMENTUM_PROJECTION);
        for (IndexType d = 0; d < Dim; ++d) {
            AtomicAdd(r_mom_proj[d], mom_proj[aux + d]);
        }
    }

    KRATOS_CATCH("")
}


template <>
void CompressibleNavierStokesExplicit<2,4>::CalculateDensityProjection(const ProcessInfo& rCurrentProcessInfo)
{
    KRATOS_TRY

    // Struct to pass around the data
    ElementDataStruct data;
    this->FillElementData(data, rCurrentProcessInfo);

    // Calculate shock capturing values
    BoundedVector<double, NumNodes> rho_proj = ZeroVector(NumNodes);

    Vector N;
    Matrix DN_De;
    Matrix DN_DX;

    Matrix J;
    Matrix Jinv;

    auto& r_geometry = GetGeometry();
    const auto& gauss_points = r_geometry.IntegrationPoints(GetIntegrationMethod());
    for(const auto& gauss_point: gauss_points)
    {
        const double w = gauss_point.Weight();
        r_geometry.ShapeFunctionsValues(N, gauss_point.Coordinates());

        double detJ;
        r_geometry.Jacobian(J, gauss_point.Coordinates());
        MathUtils<double>::InvertMatrix(J, Jinv, detJ);

        r_geometry.ShapeFunctionsLocalGradients(DN_De, gauss_point.Coordinates());
        GeometryUtils::ShapeFunctionsGradients(DN_De, Jinv, DN_DX);

        BoundedVector<double, DofSize> rho_proj_gauss(DofSize);

const double crho_proj_gauss0 =             DN_DX(0,0)*data.U(0,1) + DN_DX(0,1)*data.U(0,2) + DN_DX(1,0)*data.U(1,1) + DN_DX(1,1)*data.U(1,2) + DN_DX(2,0)*data.U(2,1) + DN_DX(2,1)*data.U(2,2) + DN_DX(3,0)*data.U(3,1) + DN_DX(3,1)*data.U(3,2) + N(0)*data.dUdt(0,0) - N(0)*data.m_ext(0) + N(1)*data.dUdt(1,0) - N(1)*data.m_ext(1) + N(2)*data.dUdt(2,0) - N(2)*data.m_ext(2) + N(3)*data.dUdt(3,0) - N(3)*data.m_ext(3);
            rho_proj_gauss[0] = -N(0)*crho_proj_gauss0;
            rho_proj_gauss[1] = -N(1)*crho_proj_gauss0;
            rho_proj_gauss[2] = -N(2)*crho_proj_gauss0;
            rho_proj_gauss[3] = -N(3)*crho_proj_gauss0;


        rho_proj += w * detJ * rho_proj_gauss;
    }

    // Assembly the projection contributions
    for (IndexType i_node = 0; i_node < NumNodes; ++i_node) {
        AtomicAdd(r_geometry[i_node].GetValue(DENSITY_PROJECTION), rho_proj[i_node]);
    }

    KRATOS_CATCH("")
}


template <>
void CompressibleNavierStokesExplicit<2,4>::CalculateTotalEnergyProjection(const ProcessInfo& rCurrentProcessInfo)
{
    KRATOS_TRY

    // Struct to pass around the data
    ElementDataStruct data;
    this->FillElementData(data, rCurrentProcessInfo);

    // Calculate shock capturing values
    BoundedVector<double, NumNodes> tot_ener_proj = ZeroVector(NumNodes);

    Vector N;
    Matrix DN_De;
    Matrix DN_DX;

    Matrix J;
    Matrix Jinv;

    auto& r_geometry = GetGeometry();
    const auto& gauss_points = r_geometry.IntegrationPoints(GetIntegrationMethod());
    for(const auto& gauss_point: gauss_points)
    {
        const double w = gauss_point.Weight();
        r_geometry.ShapeFunctionsValues(N, gauss_point.Coordinates());
        r_geometry.InverseOfJacobian(Jinv, gauss_point.Coordinates());
        r_geometry.ShapeFunctionsLocalGradients(DN_DX_iso, gauss_point.Coordinates());
        GeometryUtils::ShapeFunctionsGradients(DN_DX_iso, Jinv, DN_DX);

const double ctot_ener_proj0 =             N(0)*data.U(0,0) + N(1)*data.U(1,0) + N(2)*data.U(2,0) + N(3)*data.U(3,0);
const double ctot_ener_proj1 =             N(0)*data.U(0,1) + N(1)*data.U(1,1) + N(2)*data.U(2,1) + N(3)*data.U(3,1);
const double ctot_ener_proj2 =             N(0)*data.U(0,2) + N(1)*data.U(1,2) + N(2)*data.U(2,2) + N(3)*data.U(3,2);
const double ctot_ener_proj3 =             1.0/ctot_ener_proj0;
const double ctot_ener_proj4 =             ctot_ener_proj3*data.gamma;
const double ctot_ener_proj5 =             pow(ctot_ener_proj0, -2);
const double ctot_ener_proj6 =             data.gamma - 1;
const double ctot_ener_proj7 =             1.0*ctot_ener_proj6;
const double ctot_ener_proj8 =             ctot_ener_proj1*ctot_ener_proj2*ctot_ener_proj5*ctot_ener_proj7;
const double ctot_ener_proj9 =             pow(ctot_ener_proj1, 2);
const double ctot_ener_proj10 =             ctot_ener_proj3*ctot_ener_proj7;
const double ctot_ener_proj11 =             N(0)*data.U(0,3);
const double ctot_ener_proj12 =             N(1)*data.U(1,3);
const double ctot_ener_proj13 =             N(2)*data.U(2,3);
const double ctot_ener_proj14 =             N(3)*data.U(3,3);
const double ctot_ener_proj15 =             pow(ctot_ener_proj2, 2);
const double ctot_ener_proj16 =             ctot_ener_proj3*(0.5*ctot_ener_proj15 + 0.5*ctot_ener_proj9);
const double ctot_ener_proj17 =             ctot_ener_proj11 + ctot_ener_proj12 + ctot_ener_proj13 + ctot_ener_proj14;
const double ctot_ener_proj18 =             ctot_ener_proj6*(-ctot_ener_proj16 + ctot_ener_proj17);
const double ctot_ener_proj19 =             -ctot_ener_proj11 - ctot_ener_proj12 - ctot_ener_proj13 - ctot_ener_proj14 - ctot_ener_proj18;
const double ctot_ener_proj20 =             ctot_ener_proj5*(-ctot_ener_proj16*ctot_ener_proj6 + ctot_ener_proj17 + ctot_ener_proj18);
const double ctot_ener_proj21 =             N(0)*data.dUdt(0,3) + N(1)*data.dUdt(1,3) + N(2)*data.dUdt(2,3) + N(3)*data.dUdt(3,3) - ctot_ener_proj0*(N(0)*data.r_ext(0) + N(1)*data.r_ext(1) + N(2)*data.r_ext(2) + N(3)*data.r_ext(3)) - ctot_ener_proj1*ctot_ener_proj20*(DN_DX(0,0)*data.U(0,0) + DN_DX(1,0)*data.U(1,0) + DN_DX(2,0)*data.U(2,0) + DN_DX(3,0)*data.U(3,0)) + ctot_ener_proj1*ctot_ener_proj4*(DN_DX(0,0)*data.U(0,3) + DN_DX(1,0)*data.U(1,3) + DN_DX(2,0)*data.U(2,3) + DN_DX(3,0)*data.U(3,3)) - ctot_ener_proj1*(N(0)*data.f_ext(0,0) + N(1)*data.f_ext(1,0) + N(2)*data.f_ext(2,0) + N(3)*data.f_ext(3,0)) - ctot_ener_proj2*ctot_ener_proj20*(DN_DX(0,1)*data.U(0,0) + DN_DX(1,1)*data.U(1,0) + DN_DX(2,1)*data.U(2,0) + DN_DX(3,1)*data.U(3,0)) + ctot_ener_proj2*ctot_ener_proj4*(DN_DX(0,1)*data.U(0,3) + DN_DX(1,1)*data.U(1,3) + DN_DX(2,1)*data.U(2,3) + DN_DX(3,1)*data.U(3,3)) - ctot_ener_proj2*(N(0)*data.f_ext(0,1) + N(1)*data.f_ext(1,1) + N(2)*data.f_ext(2,1) + N(3)*data.f_ext(3,1)) - ctot_ener_proj3*(ctot_ener_proj10*ctot_ener_proj15 + ctot_ener_proj19)*(DN_DX(0,1)*data.U(0,2) + DN_DX(1,1)*data.U(1,2) + DN_DX(2,1)*data.U(2,2) + DN_DX(3,1)*data.U(3,2)) - ctot_ener_proj3*(ctot_ener_proj10*ctot_ener_proj9 + ctot_ener_proj19)*(DN_DX(0,0)*data.U(0,1) + DN_DX(1,0)*data.U(1,1) + DN_DX(2,0)*data.U(2,1) + DN_DX(3,0)*data.U(3,1)) - ctot_ener_proj8*(DN_DX(0,0)*data.U(0,2) + DN_DX(1,0)*data.U(1,2) + DN_DX(2,0)*data.U(2,2) + DN_DX(3,0)*data.U(3,2)) - ctot_ener_proj8*(DN_DX(0,1)*data.U(0,1) + DN_DX(1,1)*data.U(1,1) + DN_DX(2,1)*data.U(2,1) + DN_DX(3,1)*data.U(3,1));
            tot_ener_proj[0] += -N(0)*ctot_ener_proj21;
            tot_ener_proj[1] += -N(1)*ctot_ener_proj21;
            tot_ener_proj[2] += -N(2)*ctot_ener_proj21;
            tot_ener_proj[3] += -N(3)*ctot_ener_proj21;

        double detJ;
        r_geometry.Jacobian(J, gauss_point.Coordinates());
        MathUtils<double>::InvertMatrix(J, Jinv, detJ);

        r_geometry.ShapeFunctionsLocalGradients(DN_De, gauss_point.Coordinates());
        GeometryUtils::ShapeFunctionsGradients(DN_De, Jinv, DN_DX);

        BoundedVector<double, DofSize> tot_ener_proj_gauss(DofSize);

const double ctot_ener_proj_gauss0 =             N(0)*data.U(0,0) + N(1)*data.U(1,0) + N(2)*data.U(2,0) + N(3)*data.U(3,0);
const double ctot_ener_proj_gauss1 =             N(0)*data.U(0,1) + N(1)*data.U(1,1) + N(2)*data.U(2,1) + N(3)*data.U(3,1);
const double ctot_ener_proj_gauss2 =             N(0)*data.U(0,2) + N(1)*data.U(1,2) + N(2)*data.U(2,2) + N(3)*data.U(3,2);
const double ctot_ener_proj_gauss3 =             1.0/ctot_ener_proj_gauss0;
const double ctot_ener_proj_gauss4 =             ctot_ener_proj_gauss3*data.gamma;
const double ctot_ener_proj_gauss5 =             data.gamma - 1;
const double ctot_ener_proj_gauss6 =             pow(ctot_ener_proj_gauss0, -2);
const double ctot_ener_proj_gauss7 =             1.0*ctot_ener_proj_gauss1*ctot_ener_proj_gauss2*ctot_ener_proj_gauss5*ctot_ener_proj_gauss6;
const double ctot_ener_proj_gauss8 =             pow(ctot_ener_proj_gauss1, 2);
const double ctot_ener_proj_gauss9 =             ctot_ener_proj_gauss3*ctot_ener_proj_gauss5;
const double ctot_ener_proj_gauss10 =             1.0*ctot_ener_proj_gauss9;
const double ctot_ener_proj_gauss11 =             N(0)*data.U(0,3);
const double ctot_ener_proj_gauss12 =             N(1)*data.U(1,3);
const double ctot_ener_proj_gauss13 =             N(2)*data.U(2,3);
const double ctot_ener_proj_gauss14 =             N(3)*data.U(3,3);
const double ctot_ener_proj_gauss15 =             pow(ctot_ener_proj_gauss2, 2);
const double ctot_ener_proj_gauss16 =             -ctot_ener_proj_gauss11 - ctot_ener_proj_gauss12 - ctot_ener_proj_gauss13 - ctot_ener_proj_gauss14 - ctot_ener_proj_gauss5*(ctot_ener_proj_gauss11 + ctot_ener_proj_gauss12 + ctot_ener_proj_gauss13 + ctot_ener_proj_gauss14 - ctot_ener_proj_gauss3*(0.5*ctot_ener_proj_gauss15 + 0.5*ctot_ener_proj_gauss8));
const double ctot_ener_proj_gauss17 =             ctot_ener_proj_gauss6*(ctot_ener_proj_gauss16 + 0.5*ctot_ener_proj_gauss9*(ctot_ener_proj_gauss15 + ctot_ener_proj_gauss8));
const double ctot_ener_proj_gauss18 =             N(0)*data.dUdt(0,3) + N(1)*data.dUdt(1,3) + N(2)*data.dUdt(2,3) + N(3)*data.dUdt(3,3) - ctot_ener_proj_gauss0*(N(0)*data.r_ext(0) + N(1)*data.r_ext(1) + N(2)*data.r_ext(2) + N(3)*data.r_ext(3)) + ctot_ener_proj_gauss1*ctot_ener_proj_gauss17*(DN_DX(0,0)*data.U(0,0) + DN_DX(1,0)*data.U(1,0) + DN_DX(2,0)*data.U(2,0) + DN_DX(3,0)*data.U(3,0)) + ctot_ener_proj_gauss1*ctot_ener_proj_gauss4*(DN_DX(0,0)*data.U(0,3) + DN_DX(1,0)*data.U(1,3) + DN_DX(2,0)*data.U(2,3) + DN_DX(3,0)*data.U(3,3)) - ctot_ener_proj_gauss1*(N(0)*data.f_ext(0,0) + N(1)*data.f_ext(1,0) + N(2)*data.f_ext(2,0) + N(3)*data.f_ext(3,0)) + ctot_ener_proj_gauss17*ctot_ener_proj_gauss2*(DN_DX(0,1)*data.U(0,0) + DN_DX(1,1)*data.U(1,0) + DN_DX(2,1)*data.U(2,0) + DN_DX(3,1)*data.U(3,0)) + ctot_ener_proj_gauss2*ctot_ener_proj_gauss4*(DN_DX(0,1)*data.U(0,3) + DN_DX(1,1)*data.U(1,3) + DN_DX(2,1)*data.U(2,3) + DN_DX(3,1)*data.U(3,3)) - ctot_ener_proj_gauss2*(N(0)*data.f_ext(0,1) + N(1)*data.f_ext(1,1) + N(2)*data.f_ext(2,1) + N(3)*data.f_ext(3,1)) - ctot_ener_proj_gauss3*(ctot_ener_proj_gauss10*ctot_ener_proj_gauss15 + ctot_ener_proj_gauss16)*(DN_DX(0,1)*data.U(0,2) + DN_DX(1,1)*data.U(1,2) + DN_DX(2,1)*data.U(2,2) + DN_DX(3,1)*data.U(3,2)) - ctot_ener_proj_gauss3*(ctot_ener_proj_gauss10*ctot_ener_proj_gauss8 + ctot_ener_proj_gauss16)*(DN_DX(0,0)*data.U(0,1) + DN_DX(1,0)*data.U(1,1) + DN_DX(2,0)*data.U(2,1) + DN_DX(3,0)*data.U(3,1)) - ctot_ener_proj_gauss7*(DN_DX(0,0)*data.U(0,2) + DN_DX(1,0)*data.U(1,2) + DN_DX(2,0)*data.U(2,2) + DN_DX(3,0)*data.U(3,2)) - ctot_ener_proj_gauss7*(DN_DX(0,1)*data.U(0,1) + DN_DX(1,1)*data.U(1,1) + DN_DX(2,1)*data.U(2,1) + DN_DX(3,1)*data.U(3,1));
            tot_ener_proj_gauss[0] = -N(0)*ctot_ener_proj_gauss18;
            tot_ener_proj_gauss[1] = -N(1)*ctot_ener_proj_gauss18;
            tot_ener_proj_gauss[2] = -N(2)*ctot_ener_proj_gauss18;
            tot_ener_proj_gauss[3] = -N(3)*ctot_ener_proj_gauss18;


        tot_ener_proj += w * detJ * tot_ener_proj_gauss;
    }

    // Assembly the projection contributions
    for (IndexType i_node = 0; i_node < NumNodes; ++i_node) {
        AtomicAdd(r_geometry[i_node].GetValue(TOTAL_ENERGY_PROJECTION), tot_ener_proj[i_node]);
    }

    KRATOS_CATCH("")
}


template <>
void CompressibleNavierStokesExplicit<2,4>::CalculateRightHandSideInternal(
    BoundedVector<double, DofSize> &rRightHandSideBoundedVector,
    const ProcessInfo &rCurrentProcessInfo)
{
    KRATOS_TRY

    std::fill(rRightHandSideBoundedVector.begin(), rRightHandSideBoundedVector.end(), 0.0);

    // Struct to pass around the data
    ElementDataStruct data;
    this->FillElementData(data, rCurrentProcessInfo);

    // Stabilization parameters
    constexpr double stab_c1 = 12.0;
    constexpr double stab_c2 = 2.0;
    constexpr double stab_c3 = 1.0;

    const auto& r_geometry = GetGeometry();
    const auto& gauss_points = r_geometry.IntegrationPoints(GetIntegrationMethod());

    Vector N;
    Matrix DN_De;
    Matrix DN_DX;

    Matrix J;
    Matrix Jinv;

    if (data.UseOSS)
    {
        for(const auto& gauss_point: gauss_points)
        {
            const double w = gauss_point.Weight();
            r_geometry.ShapeFunctionsValues(N, gauss_point.Coordinates());
            r_geometry.InverseOfJacobian(Jinv, gauss_point.Coordinates());
            r_geometry.ShapeFunctionsLocalGradients(DN_DX_iso, gauss_point.Coordinates());
            GeometryUtils::ShapeFunctionsGradients(DN_DX_iso, Jinv, DN_DX);

const double crRightHandSideBoundedVector0 =             N(0)*data.m_ext(0);
const double crRightHandSideBoundedVector1 =             N(1)*data.m_ext(1);
const double crRightHandSideBoundedVector2 =             N(2)*data.m_ext(2);
const double crRightHandSideBoundedVector3 =             N(3)*data.m_ext(3);
const double crRightHandSideBoundedVector4 =             crRightHandSideBoundedVector0 + crRightHandSideBoundedVector1 + crRightHandSideBoundedVector2 + crRightHandSideBoundedVector3;
const double crRightHandSideBoundedVector5 =             N(0)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector6 =             DN_DX(0,1)*data.U(0,2);
const double crRightHandSideBoundedVector7 =             DN_DX(1,1)*data.U(1,2);
const double crRightHandSideBoundedVector8 =             DN_DX(2,1)*data.U(2,2);
const double crRightHandSideBoundedVector9 =             DN_DX(3,1)*data.U(3,2);
const double crRightHandSideBoundedVector10 =             crRightHandSideBoundedVector6 + crRightHandSideBoundedVector7 + crRightHandSideBoundedVector8 + crRightHandSideBoundedVector9;
const double crRightHandSideBoundedVector11 =             DN_DX(0,0)*data.U(0,1);
const double crRightHandSideBoundedVector12 =             DN_DX(1,0)*data.U(1,1);
const double crRightHandSideBoundedVector13 =             DN_DX(2,0)*data.U(2,1);
const double crRightHandSideBoundedVector14 =             DN_DX(3,0)*data.U(3,1);
const double crRightHandSideBoundedVector15 =             crRightHandSideBoundedVector11 + crRightHandSideBoundedVector12 + crRightHandSideBoundedVector13 + crRightHandSideBoundedVector14;
const double crRightHandSideBoundedVector16 =             crRightHandSideBoundedVector10 + crRightHandSideBoundedVector15;
const double crRightHandSideBoundedVector17 =             DN_DX(0,0)*data.U(0,0) + DN_DX(1,0)*data.U(1,0) + DN_DX(2,0)*data.U(2,0) + DN_DX(3,0)*data.U(3,0);
const double crRightHandSideBoundedVector18 =             N(0)*data.alpha_sc_nodes(0) + N(1)*data.alpha_sc_nodes(1) + N(2)*data.alpha_sc_nodes(2) + N(3)*data.alpha_sc_nodes(3);
const double crRightHandSideBoundedVector19 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector18;
const double crRightHandSideBoundedVector20 =             DN_DX(0,1)*data.U(0,0) + DN_DX(1,1)*data.U(1,0) + DN_DX(2,1)*data.U(2,0) + DN_DX(3,1)*data.U(3,0);
const double crRightHandSideBoundedVector21 =             crRightHandSideBoundedVector18*crRightHandSideBoundedVector20;
const double crRightHandSideBoundedVector22 =             N(0)*data.U(0,0) + N(1)*data.U(1,0) + N(2)*data.U(2,0) + N(3)*data.U(3,0);
const double crRightHandSideBoundedVector23 =             1.0/crRightHandSideBoundedVector22;
const double crRightHandSideBoundedVector24 =             fabs(crRightHandSideBoundedVector22);
const double crRightHandSideBoundedVector25 =             N(0)*data.U(0,1) + N(1)*data.U(1,1) + N(2)*data.U(2,1) + N(3)*data.U(3,1);
const double crRightHandSideBoundedVector26 =             pow(crRightHandSideBoundedVector25, 2);
const double crRightHandSideBoundedVector27 =             N(0)*data.U(0,2) + N(1)*data.U(1,2) + N(2)*data.U(2,2) + N(3)*data.U(3,2);
const double crRightHandSideBoundedVector28 =             pow(crRightHandSideBoundedVector27, 2);
const double crRightHandSideBoundedVector29 =             data.gamma - 1;
const double crRightHandSideBoundedVector30 =             0.5*crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector31 =             0.5*crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector32 =             crRightHandSideBoundedVector30 + crRightHandSideBoundedVector31;
const double crRightHandSideBoundedVector33 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector32;
const double crRightHandSideBoundedVector34 =             N(0)*data.U(0,3);
const double crRightHandSideBoundedVector35 =             N(1)*data.U(1,3);
const double crRightHandSideBoundedVector36 =             N(2)*data.U(2,3);
const double crRightHandSideBoundedVector37 =             N(3)*data.U(3,3);
const double crRightHandSideBoundedVector38 =             crRightHandSideBoundedVector34 + crRightHandSideBoundedVector35 + crRightHandSideBoundedVector36 + crRightHandSideBoundedVector37;
const double crRightHandSideBoundedVector39 =             -crRightHandSideBoundedVector33 + crRightHandSideBoundedVector38;
const double crRightHandSideBoundedVector40 =             crRightHandSideBoundedVector29*crRightHandSideBoundedVector39;
const double crRightHandSideBoundedVector41 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector42 =             1.0/data.gamma;
const double crRightHandSideBoundedVector43 =             N(0)*data.r_ext(0) + N(1)*data.r_ext(1) + N(2)*data.r_ext(2) + N(3)*data.r_ext(3);
const double crRightHandSideBoundedVector44 =             pow(crRightHandSideBoundedVector43, 2);
const double crRightHandSideBoundedVector45 =             N(0)*data.f_ext(0,0) + N(1)*data.f_ext(1,0) + N(2)*data.f_ext(2,0) + N(3)*data.f_ext(3,0);
const double crRightHandSideBoundedVector46 =             N(0)*data.f_ext(0,1) + N(1)*data.f_ext(1,1) + N(2)*data.f_ext(2,1) + N(3)*data.f_ext(3,1);
const double crRightHandSideBoundedVector47 =             crRightHandSideBoundedVector41*data.gamma*(pow(crRightHandSideBoundedVector45, 2) + pow(crRightHandSideBoundedVector46, 2));
const double crRightHandSideBoundedVector48 =             0.70710678118654757*crRightHandSideBoundedVector24*crRightHandSideBoundedVector42*stab_c3*sqrt((crRightHandSideBoundedVector44 + 2.0*crRightHandSideBoundedVector47 + 2.0*sqrt(0.25*crRightHandSideBoundedVector44 + crRightHandSideBoundedVector47)*fabs(crRightHandSideBoundedVector43))/(pow(crRightHandSideBoundedVector29, 2)*pow(crRightHandSideBoundedVector39, 2))) + stab_c2*(sqrt(crRightHandSideBoundedVector41)*sqrt(data.gamma) + sqrt(crRightHandSideBoundedVector26 + crRightHandSideBoundedVector28)/crRightHandSideBoundedVector24)/data.h;
const double crRightHandSideBoundedVector49 =             1.0*(N(0)*data.ResProj(0,0) + N(0)*data.dUdt(0,0) + N(1)*data.ResProj(1,0) + N(1)*data.dUdt(1,0) + N(2)*data.ResProj(2,0) + N(2)*data.dUdt(2,0) + N(3)*data.ResProj(3,0) + N(3)*data.dUdt(3,0) - crRightHandSideBoundedVector0 - crRightHandSideBoundedVector1 + crRightHandSideBoundedVector16 - crRightHandSideBoundedVector2 - crRightHandSideBoundedVector3)/crRightHandSideBoundedVector48;
const double crRightHandSideBoundedVector50 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector49;
const double crRightHandSideBoundedVector51 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector52 =             crRightHandSideBoundedVector29*crRightHandSideBoundedVector32;
const double crRightHandSideBoundedVector53 =             pow(crRightHandSideBoundedVector22, 2);
const double crRightHandSideBoundedVector54 =             1.0/crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector55 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector56 =             1.0*data.gamma;
const double crRightHandSideBoundedVector57 =             3.0 - crRightHandSideBoundedVector56;
const double crRightHandSideBoundedVector58 =             crRightHandSideBoundedVector15*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector59 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector58;
const double crRightHandSideBoundedVector60 =             DN_DX(0,0)*data.U(0,2);
const double crRightHandSideBoundedVector61 =             DN_DX(1,0)*data.U(1,2);
const double crRightHandSideBoundedVector62 =             DN_DX(2,0)*data.U(2,2);
const double crRightHandSideBoundedVector63 =             DN_DX(3,0)*data.U(3,2);
const double crRightHandSideBoundedVector64 =             crRightHandSideBoundedVector60 + crRightHandSideBoundedVector61 + crRightHandSideBoundedVector62 + crRightHandSideBoundedVector63;
const double crRightHandSideBoundedVector65 =             1.0*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector66 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector65;
const double crRightHandSideBoundedVector67 =             crRightHandSideBoundedVector64*crRightHandSideBoundedVector66;
const double crRightHandSideBoundedVector68 =             -crRightHandSideBoundedVector23*crRightHandSideBoundedVector67;
const double crRightHandSideBoundedVector69 =             DN_DX(0,0)*data.U(0,3) + DN_DX(1,0)*data.U(1,3) + DN_DX(2,0)*data.U(2,3) + DN_DX(3,0)*data.U(3,3);
const double crRightHandSideBoundedVector70 =             DN_DX(0,1)*data.U(0,1);
const double crRightHandSideBoundedVector71 =             DN_DX(1,1)*data.U(1,1);
const double crRightHandSideBoundedVector72 =             DN_DX(2,1)*data.U(2,1);
const double crRightHandSideBoundedVector73 =             DN_DX(3,1)*data.U(3,1);
const double crRightHandSideBoundedVector74 =             crRightHandSideBoundedVector70 + crRightHandSideBoundedVector71 + crRightHandSideBoundedVector72 + crRightHandSideBoundedVector73;
const double crRightHandSideBoundedVector75 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector74;
const double crRightHandSideBoundedVector76 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector75;
const double crRightHandSideBoundedVector77 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector78 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector79 =             crRightHandSideBoundedVector54*crRightHandSideBoundedVector78;
const double crRightHandSideBoundedVector80 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector77 - crRightHandSideBoundedVector25*crRightHandSideBoundedVector79 + crRightHandSideBoundedVector29*crRightHandSideBoundedVector69 + crRightHandSideBoundedVector68 + crRightHandSideBoundedVector76;
const double crRightHandSideBoundedVector81 =             N(0)*data.mu_sc_nodes(0);
const double crRightHandSideBoundedVector82 =             N(1)*data.mu_sc_nodes(1);
const double crRightHandSideBoundedVector83 =             N(2)*data.mu_sc_nodes(2);
const double crRightHandSideBoundedVector84 =             N(3)*data.mu_sc_nodes(3);
const double crRightHandSideBoundedVector85 =             crRightHandSideBoundedVector81 + crRightHandSideBoundedVector82 + crRightHandSideBoundedVector83 + crRightHandSideBoundedVector84 + data.mu;
const double crRightHandSideBoundedVector86 =             crRightHandSideBoundedVector23*stab_c1/pow(data.h, 2);
const double crRightHandSideBoundedVector87 =             1.0/(crRightHandSideBoundedVector48 + 1.3333333333333333*crRightHandSideBoundedVector85*crRightHandSideBoundedVector86);
const double crRightHandSideBoundedVector88 =             crRightHandSideBoundedVector87*(N(0)*data.ResProj(0,1) + N(0)*data.dUdt(0,1) + N(1)*data.ResProj(1,1) + N(1)*data.dUdt(1,1) + N(2)*data.ResProj(2,1) + N(2)*data.dUdt(2,1) + N(3)*data.ResProj(3,1) + N(3)*data.dUdt(3,1) - crRightHandSideBoundedVector51 + crRightHandSideBoundedVector55*(-crRightHandSideBoundedVector26 + crRightHandSideBoundedVector52) + crRightHandSideBoundedVector57*crRightHandSideBoundedVector59 + crRightHandSideBoundedVector80);
const double crRightHandSideBoundedVector89 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector90 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector91 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector92 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector91;
const double crRightHandSideBoundedVector93 =             crRightHandSideBoundedVector25*crRightHandSideBoundedVector65;
const double crRightHandSideBoundedVector94 =             crRightHandSideBoundedVector74*crRightHandSideBoundedVector93;
const double crRightHandSideBoundedVector95 =             -crRightHandSideBoundedVector23*crRightHandSideBoundedVector94;
const double crRightHandSideBoundedVector96 =             DN_DX(0,1)*data.U(0,3) + DN_DX(1,1)*data.U(1,3) + DN_DX(2,1)*data.U(2,3) + DN_DX(3,1)*data.U(3,3);
const double crRightHandSideBoundedVector97 =             crRightHandSideBoundedVector15*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector98 =             crRightHandSideBoundedVector25*crRightHandSideBoundedVector64;
const double crRightHandSideBoundedVector99 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector98;
const double crRightHandSideBoundedVector100 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector101 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector102 =             -crRightHandSideBoundedVector100*crRightHandSideBoundedVector101 + crRightHandSideBoundedVector23*crRightHandSideBoundedVector97 + crRightHandSideBoundedVector29*crRightHandSideBoundedVector96 + crRightHandSideBoundedVector95 + crRightHandSideBoundedVector99;
const double crRightHandSideBoundedVector103 =             crRightHandSideBoundedVector87*(N(0)*data.ResProj(0,2) + N(0)*data.dUdt(0,2) + N(1)*data.ResProj(1,2) + N(1)*data.dUdt(1,2) + N(2)*data.ResProj(2,2) + N(2)*data.dUdt(2,2) + N(3)*data.ResProj(3,2) + N(3)*data.dUdt(3,2) + crRightHandSideBoundedVector102 + crRightHandSideBoundedVector57*crRightHandSideBoundedVector92 - crRightHandSideBoundedVector89 + crRightHandSideBoundedVector90*(-crRightHandSideBoundedVector28 + crRightHandSideBoundedVector52));
const double crRightHandSideBoundedVector104 =             DN_DX(0,1)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector105 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector64;
const double crRightHandSideBoundedVector106 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector74;
const double crRightHandSideBoundedVector107 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector108 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector109 =             crRightHandSideBoundedVector85*(crRightHandSideBoundedVector105 + crRightHandSideBoundedVector106 - crRightHandSideBoundedVector107 - crRightHandSideBoundedVector108);
const double crRightHandSideBoundedVector110 =             crRightHandSideBoundedVector15*crRightHandSideBoundedVector22;
const double crRightHandSideBoundedVector111 =             -crRightHandSideBoundedVector100 + crRightHandSideBoundedVector110;
const double crRightHandSideBoundedVector112 =             2*crRightHandSideBoundedVector85;
const double crRightHandSideBoundedVector113 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector22;
const double crRightHandSideBoundedVector114 =             crRightHandSideBoundedVector113 - crRightHandSideBoundedVector78;
const double crRightHandSideBoundedVector115 =             (crRightHandSideBoundedVector111 + crRightHandSideBoundedVector114)*(-N(0)*data.beta_sc_nodes(0) - N(1)*data.beta_sc_nodes(1) - N(2)*data.beta_sc_nodes(2) - N(3)*data.beta_sc_nodes(3) + 0.66666666666666663*crRightHandSideBoundedVector81 + 0.66666666666666663*crRightHandSideBoundedVector82 + 0.66666666666666663*crRightHandSideBoundedVector83 + 0.66666666666666663*crRightHandSideBoundedVector84 + 0.66666666666666663*data.mu);
const double crRightHandSideBoundedVector116 =             crRightHandSideBoundedVector111*crRightHandSideBoundedVector112 + crRightHandSideBoundedVector115;
const double crRightHandSideBoundedVector117 =             DN_DX(0,0)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector118 =             -crRightHandSideBoundedVector52;
const double crRightHandSideBoundedVector119 =             crRightHandSideBoundedVector118 + crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector120 =             crRightHandSideBoundedVector56 - 3.0;
const double crRightHandSideBoundedVector121 =             crRightHandSideBoundedVector120*crRightHandSideBoundedVector58;
const double crRightHandSideBoundedVector122 =             -crRightHandSideBoundedVector119*crRightHandSideBoundedVector55 - crRightHandSideBoundedVector121*crRightHandSideBoundedVector23 + crRightHandSideBoundedVector80;
const double crRightHandSideBoundedVector123 =             N(0)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector124 =             DN_DX(0,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector125 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector124;
const double crRightHandSideBoundedVector126 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector78;
const double crRightHandSideBoundedVector127 =             crRightHandSideBoundedVector126*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector128 =             -2*crRightHandSideBoundedVector127 + crRightHandSideBoundedVector75 + crRightHandSideBoundedVector77;
const double crRightHandSideBoundedVector129 =             N(0)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector130 =             1.0*crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector131 =             1.0*crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector132 =             crRightHandSideBoundedVector29*(-crRightHandSideBoundedVector130 - crRightHandSideBoundedVector131);
const double crRightHandSideBoundedVector133 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector134 =             crRightHandSideBoundedVector121 + crRightHandSideBoundedVector133*(crRightHandSideBoundedVector132 + 2*crRightHandSideBoundedVector26) + crRightHandSideBoundedVector67;
const double crRightHandSideBoundedVector135 =             DN_DX(0,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector136 =             crRightHandSideBoundedVector108*crRightHandSideBoundedVector23 - crRightHandSideBoundedVector70 - crRightHandSideBoundedVector71 - crRightHandSideBoundedVector72 - crRightHandSideBoundedVector73;
const double crRightHandSideBoundedVector137 =             N(0)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector138 =             crRightHandSideBoundedVector56 - 1.0;
const double crRightHandSideBoundedVector139 =             crRightHandSideBoundedVector107*crRightHandSideBoundedVector23 - crRightHandSideBoundedVector60 - crRightHandSideBoundedVector61 - crRightHandSideBoundedVector62 - crRightHandSideBoundedVector63;
const double crRightHandSideBoundedVector140 =             N(0)*crRightHandSideBoundedVector139;
const double crRightHandSideBoundedVector141 =             crRightHandSideBoundedVector103*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector142 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector143 =             -crRightHandSideBoundedVector11 - crRightHandSideBoundedVector12 - crRightHandSideBoundedVector13 - crRightHandSideBoundedVector14 + crRightHandSideBoundedVector142;
const double crRightHandSideBoundedVector144 =             N(0)*crRightHandSideBoundedVector143;
const double crRightHandSideBoundedVector145 =             DN_DX(0,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector146 =             DN_DX(0,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector147 =             crRightHandSideBoundedVector126 - crRightHandSideBoundedVector6 - crRightHandSideBoundedVector7 - crRightHandSideBoundedVector8 - crRightHandSideBoundedVector9;
const double crRightHandSideBoundedVector148 =             N(0)*crRightHandSideBoundedVector147;
const double crRightHandSideBoundedVector149 =             crRightHandSideBoundedVector146 - crRightHandSideBoundedVector148;
const double crRightHandSideBoundedVector150 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector88;
const double crRightHandSideBoundedVector151 =             (N(0)*data.lamb_sc_nodes(0) + N(1)*data.lamb_sc_nodes(1) + N(2)*data.lamb_sc_nodes(2) + N(3)*data.lamb_sc_nodes(3) + data.lambda)/data.c_v;
const double crRightHandSideBoundedVector152 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector43;
const double crRightHandSideBoundedVector153 =             crRightHandSideBoundedVector25*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector154 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector155 =             crRightHandSideBoundedVector69*data.gamma;
const double crRightHandSideBoundedVector156 =             crRightHandSideBoundedVector155*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector157 =             crRightHandSideBoundedVector96*data.gamma;
const double crRightHandSideBoundedVector158 =             crRightHandSideBoundedVector157*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector159 =             1.0*crRightHandSideBoundedVector98;
const double crRightHandSideBoundedVector160 =             1.0*crRightHandSideBoundedVector75;
const double crRightHandSideBoundedVector161 =             crRightHandSideBoundedVector25*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector162 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector163 =             crRightHandSideBoundedVector130*crRightHandSideBoundedVector162;
const double crRightHandSideBoundedVector164 =             crRightHandSideBoundedVector38 + crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector165 =             crRightHandSideBoundedVector131*crRightHandSideBoundedVector162;
const double crRightHandSideBoundedVector166 =             crRightHandSideBoundedVector29*crRightHandSideBoundedVector33;
const double crRightHandSideBoundedVector167 =             -crRightHandSideBoundedVector34 - crRightHandSideBoundedVector35 - crRightHandSideBoundedVector36 - crRightHandSideBoundedVector37 - crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector168 =             crRightHandSideBoundedVector166 + crRightHandSideBoundedVector167;
const double crRightHandSideBoundedVector169 =             (N(0)*data.ResProj(0,3) + N(0)*data.dUdt(0,3) + N(1)*data.ResProj(1,3) + N(1)*data.dUdt(1,3) + N(2)*data.ResProj(2,3) + N(2)*data.dUdt(2,3) + N(3)*data.ResProj(3,3) + N(3)*data.dUdt(3,3) + crRightHandSideBoundedVector100*crRightHandSideBoundedVector168*crRightHandSideBoundedVector54 - crRightHandSideBoundedVector101*crRightHandSideBoundedVector159*crRightHandSideBoundedVector29 + crRightHandSideBoundedVector15*crRightHandSideBoundedVector23*(-crRightHandSideBoundedVector163 + crRightHandSideBoundedVector164) - crRightHandSideBoundedVector152 - crRightHandSideBoundedVector153 - crRightHandSideBoundedVector154 + crRightHandSideBoundedVector156*crRightHandSideBoundedVector23 + crRightHandSideBoundedVector158*crRightHandSideBoundedVector23 - crRightHandSideBoundedVector160*crRightHandSideBoundedVector161*crRightHandSideBoundedVector54 + crRightHandSideBoundedVector168*crRightHandSideBoundedVector79 + crRightHandSideBoundedVector91*(crRightHandSideBoundedVector164 - crRightHandSideBoundedVector165))/(crRightHandSideBoundedVector151*crRightHandSideBoundedVector42*crRightHandSideBoundedVector86 + crRightHandSideBoundedVector48);
const double crRightHandSideBoundedVector170 =             crRightHandSideBoundedVector169*crRightHandSideBoundedVector65;
const double crRightHandSideBoundedVector171 =             crRightHandSideBoundedVector112*crRightHandSideBoundedVector114 + crRightHandSideBoundedVector115;
const double crRightHandSideBoundedVector172 =             crRightHandSideBoundedVector118 + crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector173 =             crRightHandSideBoundedVector120*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector174 =             crRightHandSideBoundedVector102 - crRightHandSideBoundedVector172*crRightHandSideBoundedVector90 - crRightHandSideBoundedVector173*crRightHandSideBoundedVector91;
const double crRightHandSideBoundedVector175 =             N(0)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector176 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector145;
const double crRightHandSideBoundedVector177 =             crRightHandSideBoundedVector142*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector178 =             -2*crRightHandSideBoundedVector177 + crRightHandSideBoundedVector97 + crRightHandSideBoundedVector98;
const double crRightHandSideBoundedVector179 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector180 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector173 + crRightHandSideBoundedVector179*(crRightHandSideBoundedVector132 + 2*crRightHandSideBoundedVector28) + crRightHandSideBoundedVector94;
const double crRightHandSideBoundedVector181 =             -crRightHandSideBoundedVector144 + crRightHandSideBoundedVector145;
const double crRightHandSideBoundedVector182 =             crRightHandSideBoundedVector152 + crRightHandSideBoundedVector153 + crRightHandSideBoundedVector154;
const double crRightHandSideBoundedVector183 =             pow(crRightHandSideBoundedVector22, -3);
const double crRightHandSideBoundedVector184 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector38;
const double crRightHandSideBoundedVector185 =             1.0*crRightHandSideBoundedVector151;
const double crRightHandSideBoundedVector186 =             crRightHandSideBoundedVector183*(crRightHandSideBoundedVector109*crRightHandSideBoundedVector27 + crRightHandSideBoundedVector116*crRightHandSideBoundedVector25 + crRightHandSideBoundedVector185*(-crRightHandSideBoundedVector105*crRightHandSideBoundedVector27 - crRightHandSideBoundedVector110*crRightHandSideBoundedVector25 - crRightHandSideBoundedVector17*crRightHandSideBoundedVector184 + crRightHandSideBoundedVector17*crRightHandSideBoundedVector26 + crRightHandSideBoundedVector17*crRightHandSideBoundedVector28 + crRightHandSideBoundedVector53*crRightHandSideBoundedVector69));
const double crRightHandSideBoundedVector187 =             crRightHandSideBoundedVector183*(crRightHandSideBoundedVector109*crRightHandSideBoundedVector25 + crRightHandSideBoundedVector171*crRightHandSideBoundedVector27 + crRightHandSideBoundedVector185*(-crRightHandSideBoundedVector106*crRightHandSideBoundedVector25 - crRightHandSideBoundedVector113*crRightHandSideBoundedVector27 - crRightHandSideBoundedVector184*crRightHandSideBoundedVector20 + crRightHandSideBoundedVector20*crRightHandSideBoundedVector26 + crRightHandSideBoundedVector20*crRightHandSideBoundedVector28 + crRightHandSideBoundedVector53*crRightHandSideBoundedVector96));
const double crRightHandSideBoundedVector188 =             crRightHandSideBoundedVector163 + crRightHandSideBoundedVector167;
const double crRightHandSideBoundedVector189 =             crRightHandSideBoundedVector165 + crRightHandSideBoundedVector167;
const double crRightHandSideBoundedVector190 =             crRightHandSideBoundedVector164 - crRightHandSideBoundedVector166;
const double crRightHandSideBoundedVector191 =             -crRightHandSideBoundedVector10*crRightHandSideBoundedVector189 - crRightHandSideBoundedVector126*crRightHandSideBoundedVector190 - crRightHandSideBoundedVector142*crRightHandSideBoundedVector190 - crRightHandSideBoundedVector15*crRightHandSideBoundedVector188 + crRightHandSideBoundedVector156 + crRightHandSideBoundedVector158 - crRightHandSideBoundedVector66*crRightHandSideBoundedVector99 - crRightHandSideBoundedVector76*crRightHandSideBoundedVector93;
const double crRightHandSideBoundedVector192 =             N(0)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector193 =             -2.0*crRightHandSideBoundedVector127 + crRightHandSideBoundedVector160 + 1.0*crRightHandSideBoundedVector77;
const double crRightHandSideBoundedVector194 =             crRightHandSideBoundedVector129*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector195 =             crRightHandSideBoundedVector188*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector196 =             3.0*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector197 =             2.0*crRightHandSideBoundedVector162;
const double crRightHandSideBoundedVector198 =             crRightHandSideBoundedVector190 - crRightHandSideBoundedVector197*crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector199 =             -crRightHandSideBoundedVector133*crRightHandSideBoundedVector198 + crRightHandSideBoundedVector155 - crRightHandSideBoundedVector196*crRightHandSideBoundedVector59 + crRightHandSideBoundedVector68;
const double crRightHandSideBoundedVector200 =             crRightHandSideBoundedVector159 - 2.0*crRightHandSideBoundedVector177 + 1.0*crRightHandSideBoundedVector97;
const double crRightHandSideBoundedVector201 =             crRightHandSideBoundedVector189*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector202 =             crRightHandSideBoundedVector190 - crRightHandSideBoundedVector197*crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector203 =             crRightHandSideBoundedVector157 - crRightHandSideBoundedVector179*crRightHandSideBoundedVector202 - crRightHandSideBoundedVector196*crRightHandSideBoundedVector92 + crRightHandSideBoundedVector95;
const double crRightHandSideBoundedVector204 =             crRightHandSideBoundedVector169*crRightHandSideBoundedVector23*crRightHandSideBoundedVector56;
const double crRightHandSideBoundedVector205 =             crRightHandSideBoundedVector190*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector206 =             crRightHandSideBoundedVector132*crRightHandSideBoundedVector23 + 2*crRightHandSideBoundedVector162*(-crRightHandSideBoundedVector30 - crRightHandSideBoundedVector31) + 2*crRightHandSideBoundedVector34 + 2*crRightHandSideBoundedVector35 + 2*crRightHandSideBoundedVector36 + 2*crRightHandSideBoundedVector37 + 2*crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector207 =             crRightHandSideBoundedVector142*crRightHandSideBoundedVector206 - crRightHandSideBoundedVector15*crRightHandSideBoundedVector198 - crRightHandSideBoundedVector156 + 2.0*crRightHandSideBoundedVector27*crRightHandSideBoundedVector29*crRightHandSideBoundedVector99;
const double crRightHandSideBoundedVector208 =             -crRightHandSideBoundedVector10*crRightHandSideBoundedVector202 + crRightHandSideBoundedVector126*crRightHandSideBoundedVector206 - crRightHandSideBoundedVector158 + 2.0*crRightHandSideBoundedVector161*crRightHandSideBoundedVector76;
const double crRightHandSideBoundedVector209 =             N(1)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector210 =             DN_DX(1,1)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector211 =             DN_DX(1,0)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector212 =             N(1)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector213 =             DN_DX(1,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector214 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector213;
const double crRightHandSideBoundedVector215 =             N(1)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector216 =             DN_DX(1,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector217 =             N(1)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector218 =             N(1)*crRightHandSideBoundedVector139;
const double crRightHandSideBoundedVector219 =             N(1)*crRightHandSideBoundedVector143;
const double crRightHandSideBoundedVector220 =             DN_DX(1,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector221 =             DN_DX(1,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector222 =             N(1)*crRightHandSideBoundedVector147;
const double crRightHandSideBoundedVector223 =             crRightHandSideBoundedVector221 - crRightHandSideBoundedVector222;
const double crRightHandSideBoundedVector224 =             N(1)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector225 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector220;
const double crRightHandSideBoundedVector226 =             -crRightHandSideBoundedVector219 + crRightHandSideBoundedVector220;
const double crRightHandSideBoundedVector227 =             N(1)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector228 =             crRightHandSideBoundedVector215*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector229 =             N(2)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector230 =             DN_DX(2,1)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector231 =             DN_DX(2,0)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector232 =             N(2)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector233 =             DN_DX(2,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector234 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector233;
const double crRightHandSideBoundedVector235 =             N(2)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector236 =             DN_DX(2,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector237 =             N(2)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector238 =             N(2)*crRightHandSideBoundedVector139;
const double crRightHandSideBoundedVector239 =             N(2)*crRightHandSideBoundedVector143;
const double crRightHandSideBoundedVector240 =             DN_DX(2,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector241 =             DN_DX(2,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector242 =             N(2)*crRightHandSideBoundedVector147;
const double crRightHandSideBoundedVector243 =             crRightHandSideBoundedVector241 - crRightHandSideBoundedVector242;
const double crRightHandSideBoundedVector244 =             N(2)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector245 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector240;
const double crRightHandSideBoundedVector246 =             -crRightHandSideBoundedVector239 + crRightHandSideBoundedVector240;
const double crRightHandSideBoundedVector247 =             N(2)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector248 =             crRightHandSideBoundedVector235*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector249 =             N(3)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector250 =             DN_DX(3,1)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector251 =             DN_DX(3,0)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector252 =             N(3)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector253 =             DN_DX(3,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector254 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector253;
const double crRightHandSideBoundedVector255 =             N(3)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector256 =             DN_DX(3,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector257 =             N(3)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector258 =             N(3)*crRightHandSideBoundedVector139;
const double crRightHandSideBoundedVector259 =             N(3)*crRightHandSideBoundedVector143;
const double crRightHandSideBoundedVector260 =             DN_DX(3,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector261 =             DN_DX(3,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector262 =             N(3)*crRightHandSideBoundedVector147;
const double crRightHandSideBoundedVector263 =             crRightHandSideBoundedVector261 - crRightHandSideBoundedVector262;
const double crRightHandSideBoundedVector264 =             N(3)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector265 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector260;
const double crRightHandSideBoundedVector266 =             -crRightHandSideBoundedVector259 + crRightHandSideBoundedVector260;
const double crRightHandSideBoundedVector267 =             N(3)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector268 =             crRightHandSideBoundedVector255*crRightHandSideBoundedVector29;
            rRightHandSideBoundedVector[0] += DN_DX(0,0)*crRightHandSideBoundedVector19 - DN_DX(0,0)*crRightHandSideBoundedVector88 - DN_DX(0,1)*crRightHandSideBoundedVector103 + DN_DX(0,1)*crRightHandSideBoundedVector21 - N(0)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector5*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector5;
            rRightHandSideBoundedVector[1] += -DN_DX(0,0)*crRightHandSideBoundedVector170 - N(0)*crRightHandSideBoundedVector122 + N(0)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector104*crRightHandSideBoundedVector109 - crRightHandSideBoundedVector116*crRightHandSideBoundedVector117 - crRightHandSideBoundedVector141*(crRightHandSideBoundedVector124 - crRightHandSideBoundedVector135*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector137 + crRightHandSideBoundedVector138*crRightHandSideBoundedVector140) - crRightHandSideBoundedVector150*(crRightHandSideBoundedVector120*crRightHandSideBoundedVector144 - crRightHandSideBoundedVector120*crRightHandSideBoundedVector145 + crRightHandSideBoundedVector149) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector117*crRightHandSideBoundedVector119 + crRightHandSideBoundedVector123 - crRightHandSideBoundedVector125 - crRightHandSideBoundedVector128*crRightHandSideBoundedVector129 + crRightHandSideBoundedVector129*crRightHandSideBoundedVector134);
            rRightHandSideBoundedVector[2] += -DN_DX(0,1)*crRightHandSideBoundedVector170 - N(0)*crRightHandSideBoundedVector174 + N(0)*crRightHandSideBoundedVector89 - crRightHandSideBoundedVector104*crRightHandSideBoundedVector171 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector117 - crRightHandSideBoundedVector141*(-crRightHandSideBoundedVector120*crRightHandSideBoundedVector146 + crRightHandSideBoundedVector120*crRightHandSideBoundedVector148 + crRightHandSideBoundedVector181) - crRightHandSideBoundedVector150*(-crRightHandSideBoundedVector124*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector135 + crRightHandSideBoundedVector137*crRightHandSideBoundedVector138 - crRightHandSideBoundedVector140) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector104*crRightHandSideBoundedVector172 - crRightHandSideBoundedVector129*crRightHandSideBoundedVector178 + crRightHandSideBoundedVector129*crRightHandSideBoundedVector180 + crRightHandSideBoundedVector175 - crRightHandSideBoundedVector176);
            rRightHandSideBoundedVector[3] += -DN_DX(0,0)*crRightHandSideBoundedVector186 - DN_DX(0,1)*crRightHandSideBoundedVector187 + N(0)*crRightHandSideBoundedVector182 - crRightHandSideBoundedVector103*(-DN_DX(0,1)*crRightHandSideBoundedVector201 + crRightHandSideBoundedVector175 - crRightHandSideBoundedVector176*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector192*crRightHandSideBoundedVector203 - crRightHandSideBoundedVector194*crRightHandSideBoundedVector200) - crRightHandSideBoundedVector191*crRightHandSideBoundedVector192 - crRightHandSideBoundedVector204*(crRightHandSideBoundedVector149 + crRightHandSideBoundedVector181) - crRightHandSideBoundedVector49*(N(0)*crRightHandSideBoundedVector43 + crRightHandSideBoundedVector129*crRightHandSideBoundedVector207 + crRightHandSideBoundedVector129*crRightHandSideBoundedVector208 - crRightHandSideBoundedVector145*crRightHandSideBoundedVector205 - crRightHandSideBoundedVector146*crRightHandSideBoundedVector205) - crRightHandSideBoundedVector88*(-DN_DX(0,0)*crRightHandSideBoundedVector195 + crRightHandSideBoundedVector123 - crRightHandSideBoundedVector125*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector192*crRightHandSideBoundedVector199 - crRightHandSideBoundedVector193*crRightHandSideBoundedVector194);
            rRightHandSideBoundedVector[4] += DN_DX(1,0)*crRightHandSideBoundedVector19 - DN_DX(1,0)*crRightHandSideBoundedVector88 - DN_DX(1,1)*crRightHandSideBoundedVector103 + DN_DX(1,1)*crRightHandSideBoundedVector21 - N(1)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector209*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector209;
            rRightHandSideBoundedVector[5] += -DN_DX(1,0)*crRightHandSideBoundedVector170 - N(1)*crRightHandSideBoundedVector122 + N(1)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector210 - crRightHandSideBoundedVector116*crRightHandSideBoundedVector211 - crRightHandSideBoundedVector141*(crRightHandSideBoundedVector138*crRightHandSideBoundedVector218 + crRightHandSideBoundedVector213 - crRightHandSideBoundedVector216*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector217) - crRightHandSideBoundedVector150*(crRightHandSideBoundedVector120*crRightHandSideBoundedVector219 - crRightHandSideBoundedVector120*crRightHandSideBoundedVector220 + crRightHandSideBoundedVector223) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector119*crRightHandSideBoundedVector211 - crRightHandSideBoundedVector128*crRightHandSideBoundedVector215 + crRightHandSideBoundedVector134*crRightHandSideBoundedVector215 + crRightHandSideBoundedVector212 - crRightHandSideBoundedVector214);
            rRightHandSideBoundedVector[6] += -DN_DX(1,1)*crRightHandSideBoundedVector170 - N(1)*crRightHandSideBoundedVector174 + N(1)*crRightHandSideBoundedVector89 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector211 - crRightHandSideBoundedVector141*(-crRightHandSideBoundedVector120*crRightHandSideBoundedVector221 + crRightHandSideBoundedVector120*crRightHandSideBoundedVector222 + crRightHandSideBoundedVector226) - crRightHandSideBoundedVector150*(crRightHandSideBoundedVector138*crRightHandSideBoundedVector217 - crRightHandSideBoundedVector213*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector216 - crRightHandSideBoundedVector218) - crRightHandSideBoundedVector171*crRightHandSideBoundedVector210 - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector172*crRightHandSideBoundedVector210 - crRightHandSideBoundedVector178*crRightHandSideBoundedVector215 + crRightHandSideBoundedVector180*crRightHandSideBoundedVector215 + crRightHandSideBoundedVector224 - crRightHandSideBoundedVector225);
            rRightHandSideBoundedVector[7] += -DN_DX(1,0)*crRightHandSideBoundedVector186 - DN_DX(1,1)*crRightHandSideBoundedVector187 + N(1)*crRightHandSideBoundedVector182 - crRightHandSideBoundedVector103*(-DN_DX(1,1)*crRightHandSideBoundedVector201 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector228 + crRightHandSideBoundedVector203*crRightHandSideBoundedVector227 + crRightHandSideBoundedVector224 - crRightHandSideBoundedVector225*crRightHandSideBoundedVector65) - crRightHandSideBoundedVector191*crRightHandSideBoundedVector227 - crRightHandSideBoundedVector204*(crRightHandSideBoundedVector223 + crRightHandSideBoundedVector226) - crRightHandSideBoundedVector49*(N(1)*crRightHandSideBoundedVector43 - crRightHandSideBoundedVector205*crRightHandSideBoundedVector220 - crRightHandSideBoundedVector205*crRightHandSideBoundedVector221 + crRightHandSideBoundedVector207*crRightHandSideBoundedVector215 + crRightHandSideBoundedVector208*crRightHandSideBoundedVector215) - crRightHandSideBoundedVector88*(-DN_DX(1,0)*crRightHandSideBoundedVector195 - crRightHandSideBoundedVector193*crRightHandSideBoundedVector228 + crRightHandSideBoundedVector199*crRightHandSideBoundedVector227 + crRightHandSideBoundedVector212 - crRightHandSideBoundedVector214*crRightHandSideBoundedVector65);
            rRightHandSideBoundedVector[8] += DN_DX(2,0)*crRightHandSideBoundedVector19 - DN_DX(2,0)*crRightHandSideBoundedVector88 - DN_DX(2,1)*crRightHandSideBoundedVector103 + DN_DX(2,1)*crRightHandSideBoundedVector21 - N(2)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector229*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector229;
            rRightHandSideBoundedVector[9] += -DN_DX(2,0)*crRightHandSideBoundedVector170 - N(2)*crRightHandSideBoundedVector122 + N(2)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector230 - crRightHandSideBoundedVector116*crRightHandSideBoundedVector231 - crRightHandSideBoundedVector141*(crRightHandSideBoundedVector138*crRightHandSideBoundedVector238 + crRightHandSideBoundedVector233 - crRightHandSideBoundedVector236*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector237) - crRightHandSideBoundedVector150*(crRightHandSideBoundedVector120*crRightHandSideBoundedVector239 - crRightHandSideBoundedVector120*crRightHandSideBoundedVector240 + crRightHandSideBoundedVector243) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector119*crRightHandSideBoundedVector231 - crRightHandSideBoundedVector128*crRightHandSideBoundedVector235 + crRightHandSideBoundedVector134*crRightHandSideBoundedVector235 + crRightHandSideBoundedVector232 - crRightHandSideBoundedVector234);
            rRightHandSideBoundedVector[10] += -DN_DX(2,1)*crRightHandSideBoundedVector170 - N(2)*crRightHandSideBoundedVector174 + N(2)*crRightHandSideBoundedVector89 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector231 - crRightHandSideBoundedVector141*(-crRightHandSideBoundedVector120*crRightHandSideBoundedVector241 + crRightHandSideBoundedVector120*crRightHandSideBoundedVector242 + crRightHandSideBoundedVector246) - crRightHandSideBoundedVector150*(crRightHandSideBoundedVector138*crRightHandSideBoundedVector237 - crRightHandSideBoundedVector233*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector236 - crRightHandSideBoundedVector238) - crRightHandSideBoundedVector171*crRightHandSideBoundedVector230 - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector172*crRightHandSideBoundedVector230 - crRightHandSideBoundedVector178*crRightHandSideBoundedVector235 + crRightHandSideBoundedVector180*crRightHandSideBoundedVector235 + crRightHandSideBoundedVector244 - crRightHandSideBoundedVector245);
            rRightHandSideBoundedVector[11] += -DN_DX(2,0)*crRightHandSideBoundedVector186 - DN_DX(2,1)*crRightHandSideBoundedVector187 + N(2)*crRightHandSideBoundedVector182 - crRightHandSideBoundedVector103*(-DN_DX(2,1)*crRightHandSideBoundedVector201 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector248 + crRightHandSideBoundedVector203*crRightHandSideBoundedVector247 + crRightHandSideBoundedVector244 - crRightHandSideBoundedVector245*crRightHandSideBoundedVector65) - crRightHandSideBoundedVector191*crRightHandSideBoundedVector247 - crRightHandSideBoundedVector204*(crRightHandSideBoundedVector243 + crRightHandSideBoundedVector246) - crRightHandSideBoundedVector49*(N(2)*crRightHandSideBoundedVector43 - crRightHandSideBoundedVector205*crRightHandSideBoundedVector240 - crRightHandSideBoundedVector205*crRightHandSideBoundedVector241 + crRightHandSideBoundedVector207*crRightHandSideBoundedVector235 + crRightHandSideBoundedVector208*crRightHandSideBoundedVector235) - crRightHandSideBoundedVector88*(-DN_DX(2,0)*crRightHandSideBoundedVector195 - crRightHandSideBoundedVector193*crRightHandSideBoundedVector248 + crRightHandSideBoundedVector199*crRightHandSideBoundedVector247 + crRightHandSideBoundedVector232 - crRightHandSideBoundedVector234*crRightHandSideBoundedVector65);
            rRightHandSideBoundedVector[12] += DN_DX(3,0)*crRightHandSideBoundedVector19 - DN_DX(3,0)*crRightHandSideBoundedVector88 - DN_DX(3,1)*crRightHandSideBoundedVector103 + DN_DX(3,1)*crRightHandSideBoundedVector21 - N(3)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector249*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector249;
            rRightHandSideBoundedVector[13] += -DN_DX(3,0)*crRightHandSideBoundedVector170 - N(3)*crRightHandSideBoundedVector122 + N(3)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector250 - crRightHandSideBoundedVector116*crRightHandSideBoundedVector251 - crRightHandSideBoundedVector141*(crRightHandSideBoundedVector138*crRightHandSideBoundedVector258 + crRightHandSideBoundedVector253 - crRightHandSideBoundedVector256*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector257) - crRightHandSideBoundedVector150*(crRightHandSideBoundedVector120*crRightHandSideBoundedVector259 - crRightHandSideBoundedVector120*crRightHandSideBoundedVector260 + crRightHandSideBoundedVector263) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector119*crRightHandSideBoundedVector251 - crRightHandSideBoundedVector128*crRightHandSideBoundedVector255 + crRightHandSideBoundedVector134*crRightHandSideBoundedVector255 + crRightHandSideBoundedVector252 - crRightHandSideBoundedVector254);
            rRightHandSideBoundedVector[14] += -DN_DX(3,1)*crRightHandSideBoundedVector170 - N(3)*crRightHandSideBoundedVector174 + N(3)*crRightHandSideBoundedVector89 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector251 - crRightHandSideBoundedVector141*(-crRightHandSideBoundedVector120*crRightHandSideBoundedVector261 + crRightHandSideBoundedVector120*crRightHandSideBoundedVector262 + crRightHandSideBoundedVector266) - crRightHandSideBoundedVector150*(crRightHandSideBoundedVector138*crRightHandSideBoundedVector257 - crRightHandSideBoundedVector253*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector256 - crRightHandSideBoundedVector258) - crRightHandSideBoundedVector171*crRightHandSideBoundedVector250 - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector172*crRightHandSideBoundedVector250 - crRightHandSideBoundedVector178*crRightHandSideBoundedVector255 + crRightHandSideBoundedVector180*crRightHandSideBoundedVector255 + crRightHandSideBoundedVector264 - crRightHandSideBoundedVector265);
            rRightHandSideBoundedVector[15] += -DN_DX(3,0)*crRightHandSideBoundedVector186 - DN_DX(3,1)*crRightHandSideBoundedVector187 + N(3)*crRightHandSideBoundedVector182 - crRightHandSideBoundedVector103*(-DN_DX(3,1)*crRightHandSideBoundedVector201 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector268 + crRightHandSideBoundedVector203*crRightHandSideBoundedVector267 + crRightHandSideBoundedVector264 - crRightHandSideBoundedVector265*crRightHandSideBoundedVector65) - crRightHandSideBoundedVector191*crRightHandSideBoundedVector267 - crRightHandSideBoundedVector204*(crRightHandSideBoundedVector263 + crRightHandSideBoundedVector266) - crRightHandSideBoundedVector49*(N(3)*crRightHandSideBoundedVector43 - crRightHandSideBoundedVector205*crRightHandSideBoundedVector260 - crRightHandSideBoundedVector205*crRightHandSideBoundedVector261 + crRightHandSideBoundedVector207*crRightHandSideBoundedVector255 + crRightHandSideBoundedVector208*crRightHandSideBoundedVector255) - crRightHandSideBoundedVector88*(-DN_DX(3,0)*crRightHandSideBoundedVector195 - crRightHandSideBoundedVector193*crRightHandSideBoundedVector268 + crRightHandSideBoundedVector199*crRightHandSideBoundedVector267 + crRightHandSideBoundedVector252 - crRightHandSideBoundedVector254*crRightHandSideBoundedVector65);

            double detJ;
            r_geometry.Jacobian(J, gauss_point.Coordinates());
            MathUtils<double>::InvertMatrix(J, Jinv, detJ);

            r_geometry.ShapeFunctionsLocalGradients(DN_De, gauss_point.Coordinates());
            GeometryUtils::ShapeFunctionsGradients(DN_De, Jinv, DN_DX);

            BoundedVector<double, DofSize> rhs_gauss(DofSize);

const double crhs_gauss0 =             N(0)*data.m_ext(0);
const double crhs_gauss1 =             N(1)*data.m_ext(1);
const double crhs_gauss2 =             N(2)*data.m_ext(2);
const double crhs_gauss3 =             N(3)*data.m_ext(3);
const double crhs_gauss4 =             crhs_gauss0 + crhs_gauss1 + crhs_gauss2 + crhs_gauss3;
const double crhs_gauss5 =             N(0)*crhs_gauss4;
const double crhs_gauss6 =             DN_DX(0,1)*data.U(0,2);
const double crhs_gauss7 =             DN_DX(1,1)*data.U(1,2);
const double crhs_gauss8 =             DN_DX(2,1)*data.U(2,2);
const double crhs_gauss9 =             DN_DX(3,1)*data.U(3,2);
const double crhs_gauss10 =             crhs_gauss6 + crhs_gauss7 + crhs_gauss8 + crhs_gauss9;
const double crhs_gauss11 =             DN_DX(0,0)*data.U(0,1);
const double crhs_gauss12 =             DN_DX(1,0)*data.U(1,1);
const double crhs_gauss13 =             DN_DX(2,0)*data.U(2,1);
const double crhs_gauss14 =             DN_DX(3,0)*data.U(3,1);
const double crhs_gauss15 =             crhs_gauss11 + crhs_gauss12 + crhs_gauss13 + crhs_gauss14;
const double crhs_gauss16 =             crhs_gauss10 + crhs_gauss15;
const double crhs_gauss17 =             DN_DX(0,0)*data.U(0,0) + DN_DX(1,0)*data.U(1,0) + DN_DX(2,0)*data.U(2,0) + DN_DX(3,0)*data.U(3,0);
const double crhs_gauss18 =             N(0)*data.alpha_sc_nodes(0) + N(1)*data.alpha_sc_nodes(1) + N(2)*data.alpha_sc_nodes(2) + N(3)*data.alpha_sc_nodes(3);
const double crhs_gauss19 =             crhs_gauss17*crhs_gauss18;
const double crhs_gauss20 =             DN_DX(0,1)*data.U(0,0) + DN_DX(1,1)*data.U(1,0) + DN_DX(2,1)*data.U(2,0) + DN_DX(3,1)*data.U(3,0);
const double crhs_gauss21 =             crhs_gauss18*crhs_gauss20;
const double crhs_gauss22 =             N(0)*data.U(0,0) + N(1)*data.U(1,0) + N(2)*data.U(2,0) + N(3)*data.U(3,0);
const double crhs_gauss23 =             1.0/crhs_gauss22;
const double crhs_gauss24 =             fabs(crhs_gauss22);
const double crhs_gauss25 =             N(0)*data.U(0,1) + N(1)*data.U(1,1) + N(2)*data.U(2,1) + N(3)*data.U(3,1);
const double crhs_gauss26 =             pow(crhs_gauss25, 2);
const double crhs_gauss27 =             N(0)*data.U(0,2) + N(1)*data.U(1,2) + N(2)*data.U(2,2) + N(3)*data.U(3,2);
const double crhs_gauss28 =             pow(crhs_gauss27, 2);
const double crhs_gauss29 =             crhs_gauss26 + crhs_gauss28;
const double crhs_gauss30 =             0.5*crhs_gauss26;
const double crhs_gauss31 =             0.5*crhs_gauss28;
const double crhs_gauss32 =             N(0)*data.U(0,3);
const double crhs_gauss33 =             N(1)*data.U(1,3);
const double crhs_gauss34 =             N(2)*data.U(2,3);
const double crhs_gauss35 =             N(3)*data.U(3,3);
const double crhs_gauss36 =             -crhs_gauss32 - crhs_gauss33 - crhs_gauss34 - crhs_gauss35;
const double crhs_gauss37 =             crhs_gauss23*crhs_gauss30 + crhs_gauss23*crhs_gauss31 + crhs_gauss36;
const double crhs_gauss38 =             data.gamma - 1;
const double crhs_gauss39 =             crhs_gauss23*crhs_gauss38;
const double crhs_gauss40 =             crhs_gauss37*crhs_gauss39;
const double crhs_gauss41 =             1.0/data.gamma;
const double crhs_gauss42 =             N(0)*data.r_ext(0) + N(1)*data.r_ext(1) + N(2)*data.r_ext(2) + N(3)*data.r_ext(3);
const double crhs_gauss43 =             pow(crhs_gauss42, 2);
const double crhs_gauss44 =             N(0)*data.f_ext(0,0) + N(1)*data.f_ext(1,0) + N(2)*data.f_ext(2,0) + N(3)*data.f_ext(3,0);
const double crhs_gauss45 =             N(0)*data.f_ext(0,1) + N(1)*data.f_ext(1,1) + N(2)*data.f_ext(2,1) + N(3)*data.f_ext(3,1);
const double crhs_gauss46 =             crhs_gauss40*data.gamma*(pow(crhs_gauss44, 2) + pow(crhs_gauss45, 2));
const double crhs_gauss47 =             0.70710678118654757*crhs_gauss24*crhs_gauss41*stab_c3*sqrt((crhs_gauss43 - 2.0*crhs_gauss46 + 2.0*sqrt(0.25*crhs_gauss43 - crhs_gauss46)*fabs(crhs_gauss42))/(pow(crhs_gauss37, 2)*pow(crhs_gauss38, 2))) + stab_c2*(sqrt(data.gamma)*sqrt(-crhs_gauss40) + sqrt(crhs_gauss29)/crhs_gauss24)/data.h;
const double crhs_gauss48 =             1.0*(N(0)*data.ResProj(0,0) + N(0)*data.dUdt(0,0) + N(1)*data.ResProj(1,0) + N(1)*data.dUdt(1,0) + N(2)*data.ResProj(2,0) + N(2)*data.dUdt(2,0) + N(3)*data.ResProj(3,0) + N(3)*data.dUdt(3,0) - crhs_gauss0 - crhs_gauss1 + crhs_gauss16 - crhs_gauss2 - crhs_gauss3)/crhs_gauss47;
const double crhs_gauss49 =             crhs_gauss23*crhs_gauss48;
const double crhs_gauss50 =             crhs_gauss22*crhs_gauss44;
const double crhs_gauss51 =             crhs_gauss15*crhs_gauss25;
const double crhs_gauss52 =             1.0*data.gamma;
const double crhs_gauss53 =             crhs_gauss23*(3.0 - crhs_gauss52);
const double crhs_gauss54 =             DN_DX(0,0)*data.U(0,2);
const double crhs_gauss55 =             DN_DX(1,0)*data.U(1,2);
const double crhs_gauss56 =             DN_DX(2,0)*data.U(2,2);
const double crhs_gauss57 =             DN_DX(3,0)*data.U(3,2);
const double crhs_gauss58 =             crhs_gauss54 + crhs_gauss55 + crhs_gauss56 + crhs_gauss57;
const double crhs_gauss59 =             crhs_gauss27*crhs_gauss58;
const double crhs_gauss60 =             1.0*crhs_gauss39;
const double crhs_gauss61 =             -crhs_gauss59*crhs_gauss60;
const double crhs_gauss62 =             DN_DX(0,0)*data.U(0,3) + DN_DX(1,0)*data.U(1,3) + DN_DX(2,0)*data.U(2,3) + DN_DX(3,0)*data.U(3,3);
const double crhs_gauss63 =             DN_DX(0,1)*data.U(0,1);
const double crhs_gauss64 =             DN_DX(1,1)*data.U(1,1);
const double crhs_gauss65 =             DN_DX(2,1)*data.U(2,1);
const double crhs_gauss66 =             DN_DX(3,1)*data.U(3,1);
const double crhs_gauss67 =             crhs_gauss63 + crhs_gauss64 + crhs_gauss65 + crhs_gauss66;
const double crhs_gauss68 =             crhs_gauss27*crhs_gauss67;
const double crhs_gauss69 =             crhs_gauss10*crhs_gauss25;
const double crhs_gauss70 =             pow(crhs_gauss22, -2);
const double crhs_gauss71 =             0.5*crhs_gauss29;
const double crhs_gauss72 =             crhs_gauss38*crhs_gauss71;
const double crhs_gauss73 =             -crhs_gauss26 + crhs_gauss72;
const double crhs_gauss74 =             crhs_gauss70*crhs_gauss73;
const double crhs_gauss75 =             crhs_gauss20*crhs_gauss27;
const double crhs_gauss76 =             crhs_gauss70*crhs_gauss75;
const double crhs_gauss77 =             crhs_gauss17*crhs_gauss74 + crhs_gauss23*crhs_gauss68 + crhs_gauss23*crhs_gauss69 - crhs_gauss25*crhs_gauss76 + crhs_gauss38*crhs_gauss62 + crhs_gauss61;
const double crhs_gauss78 =             N(0)*data.mu_sc_nodes(0);
const double crhs_gauss79 =             N(1)*data.mu_sc_nodes(1);
const double crhs_gauss80 =             N(2)*data.mu_sc_nodes(2);
const double crhs_gauss81 =             N(3)*data.mu_sc_nodes(3);
const double crhs_gauss82 =             crhs_gauss78 + crhs_gauss79 + crhs_gauss80 + crhs_gauss81 + data.mu;
const double crhs_gauss83 =             crhs_gauss23*stab_c1/pow(data.h, 2);
const double crhs_gauss84 =             1.0/(crhs_gauss47 + 1.3333333333333333*crhs_gauss82*crhs_gauss83);
const double crhs_gauss85 =             crhs_gauss84*(N(0)*data.ResProj(0,1) + N(0)*data.dUdt(0,1) + N(1)*data.ResProj(1,1) + N(1)*data.dUdt(1,1) + N(2)*data.ResProj(2,1) + N(2)*data.dUdt(2,1) + N(3)*data.ResProj(3,1) + N(3)*data.dUdt(3,1) - crhs_gauss50 + crhs_gauss51*crhs_gauss53 + crhs_gauss77);
const double crhs_gauss86 =             crhs_gauss22*crhs_gauss45;
const double crhs_gauss87 =             crhs_gauss10*crhs_gauss27;
const double crhs_gauss88 =             crhs_gauss25*crhs_gauss67;
const double crhs_gauss89 =             -crhs_gauss60*crhs_gauss88;
const double crhs_gauss90 =             DN_DX(0,1)*data.U(0,3) + DN_DX(1,1)*data.U(1,3) + DN_DX(2,1)*data.U(2,3) + DN_DX(3,1)*data.U(3,3);
const double crhs_gauss91 =             crhs_gauss15*crhs_gauss27;
const double crhs_gauss92 =             crhs_gauss25*crhs_gauss58;
const double crhs_gauss93 =             -crhs_gauss28 + crhs_gauss72;
const double crhs_gauss94 =             crhs_gauss70*crhs_gauss93;
const double crhs_gauss95 =             crhs_gauss17*crhs_gauss25;
const double crhs_gauss96 =             crhs_gauss27*crhs_gauss70;
const double crhs_gauss97 =             crhs_gauss20*crhs_gauss94 + crhs_gauss23*crhs_gauss91 + crhs_gauss23*crhs_gauss92 + crhs_gauss38*crhs_gauss90 + crhs_gauss89 - crhs_gauss95*crhs_gauss96;
const double crhs_gauss98 =             crhs_gauss84*(N(0)*data.ResProj(0,2) + N(0)*data.dUdt(0,2) + N(1)*data.ResProj(1,2) + N(1)*data.dUdt(1,2) + N(2)*data.ResProj(2,2) + N(2)*data.dUdt(2,2) + N(3)*data.ResProj(3,2) + N(3)*data.dUdt(3,2) + crhs_gauss53*crhs_gauss87 - crhs_gauss86 + crhs_gauss97);
const double crhs_gauss99 =             DN_DX(0,1)*crhs_gauss70;
const double crhs_gauss100 =             crhs_gauss17*crhs_gauss27;
const double crhs_gauss101 =             crhs_gauss20*crhs_gauss25;
const double crhs_gauss102 =             crhs_gauss82*(-crhs_gauss100 - crhs_gauss101 + crhs_gauss22*crhs_gauss58 + crhs_gauss22*crhs_gauss67);
const double crhs_gauss103 =             crhs_gauss15*crhs_gauss22 - crhs_gauss95;
const double crhs_gauss104 =             2*crhs_gauss82;
const double crhs_gauss105 =             crhs_gauss10*crhs_gauss22 - crhs_gauss75;
const double crhs_gauss106 =             (crhs_gauss103 + crhs_gauss105)*(N(0)*data.beta_sc_nodes(0) + N(1)*data.beta_sc_nodes(1) + N(2)*data.beta_sc_nodes(2) + N(3)*data.beta_sc_nodes(3) - 0.66666666666666663*crhs_gauss78 - 0.66666666666666663*crhs_gauss79 - 0.66666666666666663*crhs_gauss80 - 0.66666666666666663*crhs_gauss81 - 0.66666666666666663*data.mu);
const double crhs_gauss107 =             crhs_gauss103*crhs_gauss104 + crhs_gauss106;
const double crhs_gauss108 =             DN_DX(0,0)*crhs_gauss70;
const double crhs_gauss109 =             crhs_gauss52 - 3.0;
const double crhs_gauss110 =             crhs_gauss109*crhs_gauss51;
const double crhs_gauss111 =             -crhs_gauss110*crhs_gauss23 + crhs_gauss77;
const double crhs_gauss112 =             N(0)*crhs_gauss44;
const double crhs_gauss113 =             DN_DX(0,1)*crhs_gauss25;
const double crhs_gauss114 =             crhs_gauss113*crhs_gauss96;
const double crhs_gauss115 =             crhs_gauss23*crhs_gauss75;
const double crhs_gauss116 =             2*crhs_gauss115;
const double crhs_gauss117 =             -crhs_gauss116*crhs_gauss25 + crhs_gauss68 + crhs_gauss69;
const double crhs_gauss118 =             N(0)*crhs_gauss70;
const double crhs_gauss119 =             1.0*crhs_gauss38;
const double crhs_gauss120 =             crhs_gauss17*crhs_gauss23;
const double crhs_gauss121 =             crhs_gauss110 + crhs_gauss119*crhs_gauss59 - 2*crhs_gauss120*crhs_gauss73;
const double crhs_gauss122 =             DN_DX(0,0)*crhs_gauss27;
const double crhs_gauss123 =             crhs_gauss101*crhs_gauss23 - crhs_gauss63 - crhs_gauss64 - crhs_gauss65 - crhs_gauss66;
const double crhs_gauss124 =             N(0)*crhs_gauss123;
const double crhs_gauss125 =             crhs_gauss52 - 1.0;
const double crhs_gauss126 =             crhs_gauss100*crhs_gauss23 - crhs_gauss54 - crhs_gauss55 - crhs_gauss56 - crhs_gauss57;
const double crhs_gauss127 =             N(0)*crhs_gauss126;
const double crhs_gauss128 =             crhs_gauss23*crhs_gauss98;
const double crhs_gauss129 =             crhs_gauss23*crhs_gauss95;
const double crhs_gauss130 =             -crhs_gauss11 - crhs_gauss12 + crhs_gauss129 - crhs_gauss13 - crhs_gauss14;
const double crhs_gauss131 =             N(0)*crhs_gauss130;
const double crhs_gauss132 =             DN_DX(0,0)*crhs_gauss25;
const double crhs_gauss133 =             DN_DX(0,1)*crhs_gauss27;
const double crhs_gauss134 =             crhs_gauss115 - crhs_gauss6 - crhs_gauss7 - crhs_gauss8 - crhs_gauss9;
const double crhs_gauss135 =             N(0)*crhs_gauss134;
const double crhs_gauss136 =             crhs_gauss133 - crhs_gauss135;
const double crhs_gauss137 =             crhs_gauss23*crhs_gauss85;
const double crhs_gauss138 =             (N(0)*data.lamb_sc_nodes(0) + N(1)*data.lamb_sc_nodes(1) + N(2)*data.lamb_sc_nodes(2) + N(3)*data.lamb_sc_nodes(3) + data.lambda)/data.c_v;
const double crhs_gauss139 =             crhs_gauss22*crhs_gauss42;
const double crhs_gauss140 =             crhs_gauss25*crhs_gauss44;
const double crhs_gauss141 =             crhs_gauss27*crhs_gauss45;
const double crhs_gauss142 =             crhs_gauss62*data.gamma;
const double crhs_gauss143 =             crhs_gauss23*crhs_gauss25;
const double crhs_gauss144 =             crhs_gauss90*data.gamma;
const double crhs_gauss145 =             crhs_gauss23*crhs_gauss27;
const double crhs_gauss146 =             1.0*crhs_gauss92;
const double crhs_gauss147 =             1.0*crhs_gauss68;
const double crhs_gauss148 =             crhs_gauss147*crhs_gauss25;
const double crhs_gauss149 =             crhs_gauss26*crhs_gauss60;
const double crhs_gauss150 =             crhs_gauss32 + crhs_gauss33 + crhs_gauss34 + crhs_gauss35;
const double crhs_gauss151 =             crhs_gauss38*(crhs_gauss150 - crhs_gauss23*(crhs_gauss30 + crhs_gauss31));
const double crhs_gauss152 =             crhs_gauss150 + crhs_gauss151;
const double crhs_gauss153 =             crhs_gauss28*crhs_gauss60;
const double crhs_gauss154 =             -crhs_gauss151 + crhs_gauss36;
const double crhs_gauss155 =             crhs_gauss154 + crhs_gauss39*crhs_gauss71;
const double crhs_gauss156 =             crhs_gauss155*crhs_gauss70;
const double crhs_gauss157 =             (N(0)*data.ResProj(0,3) + N(0)*data.dUdt(0,3) + N(1)*data.ResProj(1,3) + N(1)*data.dUdt(1,3) + N(2)*data.ResProj(2,3) + N(2)*data.dUdt(2,3) + N(3)*data.ResProj(3,3) + N(3)*data.dUdt(3,3) + crhs_gauss10*crhs_gauss23*(crhs_gauss152 - crhs_gauss153) - crhs_gauss139 - crhs_gauss140 - crhs_gauss141 + crhs_gauss142*crhs_gauss143 + crhs_gauss144*crhs_gauss145 - crhs_gauss146*crhs_gauss38*crhs_gauss96 - crhs_gauss148*crhs_gauss38*crhs_gauss70 + crhs_gauss15*crhs_gauss23*(-crhs_gauss149 + crhs_gauss152) + crhs_gauss155*crhs_gauss76 + crhs_gauss156*crhs_gauss95)/(crhs_gauss138*crhs_gauss41*crhs_gauss83 + crhs_gauss47);
const double crhs_gauss158 =             crhs_gauss119*crhs_gauss157;
const double crhs_gauss159 =             crhs_gauss104*crhs_gauss105 + crhs_gauss106;
const double crhs_gauss160 =             crhs_gauss109*crhs_gauss87;
const double crhs_gauss161 =             -crhs_gauss160*crhs_gauss23 + crhs_gauss97;
const double crhs_gauss162 =             N(0)*crhs_gauss45;
const double crhs_gauss163 =             crhs_gauss132*crhs_gauss96;
const double crhs_gauss164 =             2*crhs_gauss129;
const double crhs_gauss165 =             -crhs_gauss164*crhs_gauss27 + crhs_gauss91 + crhs_gauss92;
const double crhs_gauss166 =             crhs_gauss20*crhs_gauss23;
const double crhs_gauss167 =             crhs_gauss119*crhs_gauss88 + crhs_gauss160 - 2*crhs_gauss166*crhs_gauss93;
const double crhs_gauss168 =             -crhs_gauss131 + crhs_gauss132;
const double crhs_gauss169 =             crhs_gauss139 + crhs_gauss140 + crhs_gauss141;
const double crhs_gauss170 =             crhs_gauss102*crhs_gauss145 + crhs_gauss107*crhs_gauss143 + crhs_gauss138*(crhs_gauss120*crhs_gauss26 + crhs_gauss120*crhs_gauss28 - crhs_gauss150*crhs_gauss17 + crhs_gauss22*crhs_gauss62 - crhs_gauss51 - crhs_gauss59);
const double crhs_gauss171 =             crhs_gauss102*crhs_gauss143 + crhs_gauss138*(-crhs_gauss150*crhs_gauss20 + crhs_gauss166*crhs_gauss26 + crhs_gauss166*crhs_gauss28 + crhs_gauss22*crhs_gauss90 - crhs_gauss87 - crhs_gauss88) + crhs_gauss145*crhs_gauss159;
const double crhs_gauss172 =             crhs_gauss142*crhs_gauss25;
const double crhs_gauss173 =             crhs_gauss144*crhs_gauss27;
const double crhs_gauss174 =             crhs_gauss149 + crhs_gauss154;
const double crhs_gauss175 =             crhs_gauss153 + crhs_gauss154;
const double crhs_gauss176 =             -crhs_gauss10*crhs_gauss175 + crhs_gauss115*crhs_gauss155 + crhs_gauss129*crhs_gauss155 - crhs_gauss146*crhs_gauss27*crhs_gauss39 - crhs_gauss148*crhs_gauss39 - crhs_gauss15*crhs_gauss174 + crhs_gauss172 + crhs_gauss173;
const double crhs_gauss177 =             N(0)*crhs_gauss23;
const double crhs_gauss178 =             -2.0*crhs_gauss115*crhs_gauss25 + crhs_gauss147 + 1.0*crhs_gauss69;
const double crhs_gauss179 =             crhs_gauss118*crhs_gauss38;
const double crhs_gauss180 =             crhs_gauss174*crhs_gauss23;
const double crhs_gauss181 =             3.0*crhs_gauss39;
const double crhs_gauss182 =             2.0*crhs_gauss39;
const double crhs_gauss183 =             crhs_gauss155 + crhs_gauss182*crhs_gauss26;
const double crhs_gauss184 =             crhs_gauss120*crhs_gauss183 + crhs_gauss142 - crhs_gauss181*crhs_gauss51 + crhs_gauss61;
const double crhs_gauss185 =             -2.0*crhs_gauss129*crhs_gauss27 + crhs_gauss146 + 1.0*crhs_gauss91;
const double crhs_gauss186 =             crhs_gauss175*crhs_gauss23;
const double crhs_gauss187 =             crhs_gauss155 + crhs_gauss182*crhs_gauss28;
const double crhs_gauss188 =             crhs_gauss144 + crhs_gauss166*crhs_gauss187 - crhs_gauss181*crhs_gauss87 + crhs_gauss89;
const double crhs_gauss189 =             crhs_gauss157*crhs_gauss23*crhs_gauss52;
const double crhs_gauss190 =             crhs_gauss154 + crhs_gauss29*crhs_gauss39;
const double crhs_gauss191 =             crhs_gauss15*crhs_gauss183 - crhs_gauss164*crhs_gauss190 - crhs_gauss172 + crhs_gauss182*crhs_gauss27*crhs_gauss92;
const double crhs_gauss192 =             crhs_gauss10*crhs_gauss187 - crhs_gauss116*crhs_gauss190 - crhs_gauss173 + crhs_gauss182*crhs_gauss25*crhs_gauss68;
const double crhs_gauss193 =             N(1)*crhs_gauss4;
const double crhs_gauss194 =             DN_DX(1,1)*crhs_gauss70;
const double crhs_gauss195 =             DN_DX(1,0)*crhs_gauss70;
const double crhs_gauss196 =             N(1)*crhs_gauss44;
const double crhs_gauss197 =             DN_DX(1,1)*crhs_gauss25;
const double crhs_gauss198 =             crhs_gauss197*crhs_gauss96;
const double crhs_gauss199 =             N(1)*crhs_gauss70;
const double crhs_gauss200 =             DN_DX(1,0)*crhs_gauss27;
const double crhs_gauss201 =             N(1)*crhs_gauss123;
const double crhs_gauss202 =             N(1)*crhs_gauss126;
const double crhs_gauss203 =             N(1)*crhs_gauss130;
const double crhs_gauss204 =             DN_DX(1,0)*crhs_gauss25;
const double crhs_gauss205 =             DN_DX(1,1)*crhs_gauss27;
const double crhs_gauss206 =             N(1)*crhs_gauss134;
const double crhs_gauss207 =             crhs_gauss205 - crhs_gauss206;
const double crhs_gauss208 =             N(1)*crhs_gauss45;
const double crhs_gauss209 =             crhs_gauss204*crhs_gauss96;
const double crhs_gauss210 =             -crhs_gauss203 + crhs_gauss204;
const double crhs_gauss211 =             N(1)*crhs_gauss23;
const double crhs_gauss212 =             crhs_gauss199*crhs_gauss38;
const double crhs_gauss213 =             N(2)*crhs_gauss4;
const double crhs_gauss214 =             DN_DX(2,1)*crhs_gauss70;
const double crhs_gauss215 =             DN_DX(2,0)*crhs_gauss70;
const double crhs_gauss216 =             N(2)*crhs_gauss44;
const double crhs_gauss217 =             DN_DX(2,1)*crhs_gauss25;
const double crhs_gauss218 =             crhs_gauss217*crhs_gauss96;
const double crhs_gauss219 =             N(2)*crhs_gauss70;
const double crhs_gauss220 =             DN_DX(2,0)*crhs_gauss27;
const double crhs_gauss221 =             N(2)*crhs_gauss123;
const double crhs_gauss222 =             N(2)*crhs_gauss126;
const double crhs_gauss223 =             N(2)*crhs_gauss130;
const double crhs_gauss224 =             DN_DX(2,0)*crhs_gauss25;
const double crhs_gauss225 =             DN_DX(2,1)*crhs_gauss27;
const double crhs_gauss226 =             N(2)*crhs_gauss134;
const double crhs_gauss227 =             crhs_gauss225 - crhs_gauss226;
const double crhs_gauss228 =             N(2)*crhs_gauss45;
const double crhs_gauss229 =             crhs_gauss224*crhs_gauss96;
const double crhs_gauss230 =             -crhs_gauss223 + crhs_gauss224;
const double crhs_gauss231 =             N(2)*crhs_gauss23;
const double crhs_gauss232 =             crhs_gauss219*crhs_gauss38;
const double crhs_gauss233 =             N(3)*crhs_gauss4;
const double crhs_gauss234 =             DN_DX(3,1)*crhs_gauss70;
const double crhs_gauss235 =             DN_DX(3,0)*crhs_gauss70;
const double crhs_gauss236 =             N(3)*crhs_gauss44;
const double crhs_gauss237 =             DN_DX(3,1)*crhs_gauss25;
const double crhs_gauss238 =             crhs_gauss237*crhs_gauss96;
const double crhs_gauss239 =             N(3)*crhs_gauss70;
const double crhs_gauss240 =             DN_DX(3,0)*crhs_gauss27;
const double crhs_gauss241 =             N(3)*crhs_gauss123;
const double crhs_gauss242 =             N(3)*crhs_gauss126;
const double crhs_gauss243 =             N(3)*crhs_gauss130;
const double crhs_gauss244 =             DN_DX(3,0)*crhs_gauss25;
const double crhs_gauss245 =             DN_DX(3,1)*crhs_gauss27;
const double crhs_gauss246 =             N(3)*crhs_gauss134;
const double crhs_gauss247 =             crhs_gauss245 - crhs_gauss246;
const double crhs_gauss248 =             N(3)*crhs_gauss45;
const double crhs_gauss249 =             crhs_gauss244*crhs_gauss96;
const double crhs_gauss250 =             -crhs_gauss243 + crhs_gauss244;
const double crhs_gauss251 =             N(3)*crhs_gauss23;
const double crhs_gauss252 =             crhs_gauss239*crhs_gauss38;
            rhs_gauss[0] = DN_DX(0,0)*crhs_gauss19 - DN_DX(0,0)*crhs_gauss85 + DN_DX(0,1)*crhs_gauss21 - DN_DX(0,1)*crhs_gauss98 - N(0)*crhs_gauss16 - crhs_gauss49*crhs_gauss5 + crhs_gauss5;
            rhs_gauss[1] = -DN_DX(0,0)*crhs_gauss158 - N(0)*crhs_gauss111 + N(0)*crhs_gauss50 - crhs_gauss102*crhs_gauss99 - crhs_gauss107*crhs_gauss108 - crhs_gauss128*(crhs_gauss113 - crhs_gauss119*crhs_gauss122 - crhs_gauss124 + crhs_gauss125*crhs_gauss127) - crhs_gauss137*(crhs_gauss109*crhs_gauss131 - crhs_gauss109*crhs_gauss132 + crhs_gauss136) - crhs_gauss48*(DN_DX(0,0)*crhs_gauss74 + crhs_gauss112 - crhs_gauss114 - crhs_gauss117*crhs_gauss118 + crhs_gauss118*crhs_gauss121);
            rhs_gauss[2] = -DN_DX(0,1)*crhs_gauss158 - N(0)*crhs_gauss161 + N(0)*crhs_gauss86 - crhs_gauss102*crhs_gauss108 - crhs_gauss128*(-crhs_gauss109*crhs_gauss133 + crhs_gauss109*crhs_gauss135 + crhs_gauss168) - crhs_gauss137*(-crhs_gauss113*crhs_gauss119 + crhs_gauss122 + crhs_gauss124*crhs_gauss125 - crhs_gauss127) - crhs_gauss159*crhs_gauss99 - crhs_gauss48*(DN_DX(0,1)*crhs_gauss94 - crhs_gauss118*crhs_gauss165 + crhs_gauss118*crhs_gauss167 + crhs_gauss162 - crhs_gauss163);
            rhs_gauss[3] = N(0)*crhs_gauss169 - crhs_gauss108*crhs_gauss170 - crhs_gauss171*crhs_gauss99 - crhs_gauss176*crhs_gauss177 - crhs_gauss189*(crhs_gauss136 + crhs_gauss168) - crhs_gauss48*(N(0)*crhs_gauss42 + crhs_gauss118*crhs_gauss191 + crhs_gauss118*crhs_gauss192 + crhs_gauss132*crhs_gauss156 + crhs_gauss133*crhs_gauss156) - crhs_gauss85*(-DN_DX(0,0)*crhs_gauss180 + crhs_gauss112 - crhs_gauss114*crhs_gauss119 + crhs_gauss177*crhs_gauss184 - crhs_gauss178*crhs_gauss179) - crhs_gauss98*(-DN_DX(0,1)*crhs_gauss186 - crhs_gauss119*crhs_gauss163 + crhs_gauss162 + crhs_gauss177*crhs_gauss188 - crhs_gauss179*crhs_gauss185);
            rhs_gauss[4] = DN_DX(1,0)*crhs_gauss19 - DN_DX(1,0)*crhs_gauss85 + DN_DX(1,1)*crhs_gauss21 - DN_DX(1,1)*crhs_gauss98 - N(1)*crhs_gauss16 - crhs_gauss193*crhs_gauss49 + crhs_gauss193;
            rhs_gauss[5] = -DN_DX(1,0)*crhs_gauss158 - N(1)*crhs_gauss111 + N(1)*crhs_gauss50 - crhs_gauss102*crhs_gauss194 - crhs_gauss107*crhs_gauss195 - crhs_gauss128*(-crhs_gauss119*crhs_gauss200 + crhs_gauss125*crhs_gauss202 + crhs_gauss197 - crhs_gauss201) - crhs_gauss137*(crhs_gauss109*crhs_gauss203 - crhs_gauss109*crhs_gauss204 + crhs_gauss207) - crhs_gauss48*(DN_DX(1,0)*crhs_gauss74 - crhs_gauss117*crhs_gauss199 + crhs_gauss121*crhs_gauss199 + crhs_gauss196 - crhs_gauss198);
            rhs_gauss[6] = -DN_DX(1,1)*crhs_gauss158 - N(1)*crhs_gauss161 + N(1)*crhs_gauss86 - crhs_gauss102*crhs_gauss195 - crhs_gauss128*(-crhs_gauss109*crhs_gauss205 + crhs_gauss109*crhs_gauss206 + crhs_gauss210) - crhs_gauss137*(-crhs_gauss119*crhs_gauss197 + crhs_gauss125*crhs_gauss201 + crhs_gauss200 - crhs_gauss202) - crhs_gauss159*crhs_gauss194 - crhs_gauss48*(DN_DX(1,1)*crhs_gauss94 - crhs_gauss165*crhs_gauss199 + crhs_gauss167*crhs_gauss199 + crhs_gauss208 - crhs_gauss209);
            rhs_gauss[7] = N(1)*crhs_gauss169 - crhs_gauss170*crhs_gauss195 - crhs_gauss171*crhs_gauss194 - crhs_gauss176*crhs_gauss211 - crhs_gauss189*(crhs_gauss207 + crhs_gauss210) - crhs_gauss48*(N(1)*crhs_gauss42 + crhs_gauss156*crhs_gauss204 + crhs_gauss156*crhs_gauss205 + crhs_gauss191*crhs_gauss199 + crhs_gauss192*crhs_gauss199) - crhs_gauss85*(-DN_DX(1,0)*crhs_gauss180 - crhs_gauss119*crhs_gauss198 - crhs_gauss178*crhs_gauss212 + crhs_gauss184*crhs_gauss211 + crhs_gauss196) - crhs_gauss98*(-DN_DX(1,1)*crhs_gauss186 - crhs_gauss119*crhs_gauss209 - crhs_gauss185*crhs_gauss212 + crhs_gauss188*crhs_gauss211 + crhs_gauss208);
            rhs_gauss[8] = DN_DX(2,0)*crhs_gauss19 - DN_DX(2,0)*crhs_gauss85 + DN_DX(2,1)*crhs_gauss21 - DN_DX(2,1)*crhs_gauss98 - N(2)*crhs_gauss16 - crhs_gauss213*crhs_gauss49 + crhs_gauss213;
            rhs_gauss[9] = -DN_DX(2,0)*crhs_gauss158 - N(2)*crhs_gauss111 + N(2)*crhs_gauss50 - crhs_gauss102*crhs_gauss214 - crhs_gauss107*crhs_gauss215 - crhs_gauss128*(-crhs_gauss119*crhs_gauss220 + crhs_gauss125*crhs_gauss222 + crhs_gauss217 - crhs_gauss221) - crhs_gauss137*(crhs_gauss109*crhs_gauss223 - crhs_gauss109*crhs_gauss224 + crhs_gauss227) - crhs_gauss48*(DN_DX(2,0)*crhs_gauss74 - crhs_gauss117*crhs_gauss219 + crhs_gauss121*crhs_gauss219 + crhs_gauss216 - crhs_gauss218);
            rhs_gauss[10] = -DN_DX(2,1)*crhs_gauss158 - N(2)*crhs_gauss161 + N(2)*crhs_gauss86 - crhs_gauss102*crhs_gauss215 - crhs_gauss128*(-crhs_gauss109*crhs_gauss225 + crhs_gauss109*crhs_gauss226 + crhs_gauss230) - crhs_gauss137*(-crhs_gauss119*crhs_gauss217 + crhs_gauss125*crhs_gauss221 + crhs_gauss220 - crhs_gauss222) - crhs_gauss159*crhs_gauss214 - crhs_gauss48*(DN_DX(2,1)*crhs_gauss94 - crhs_gauss165*crhs_gauss219 + crhs_gauss167*crhs_gauss219 + crhs_gauss228 - crhs_gauss229);
            rhs_gauss[11] = N(2)*crhs_gauss169 - crhs_gauss170*crhs_gauss215 - crhs_gauss171*crhs_gauss214 - crhs_gauss176*crhs_gauss231 - crhs_gauss189*(crhs_gauss227 + crhs_gauss230) - crhs_gauss48*(N(2)*crhs_gauss42 + crhs_gauss156*crhs_gauss224 + crhs_gauss156*crhs_gauss225 + crhs_gauss191*crhs_gauss219 + crhs_gauss192*crhs_gauss219) - crhs_gauss85*(-DN_DX(2,0)*crhs_gauss180 - crhs_gauss119*crhs_gauss218 - crhs_gauss178*crhs_gauss232 + crhs_gauss184*crhs_gauss231 + crhs_gauss216) - crhs_gauss98*(-DN_DX(2,1)*crhs_gauss186 - crhs_gauss119*crhs_gauss229 - crhs_gauss185*crhs_gauss232 + crhs_gauss188*crhs_gauss231 + crhs_gauss228);
            rhs_gauss[12] = DN_DX(3,0)*crhs_gauss19 - DN_DX(3,0)*crhs_gauss85 + DN_DX(3,1)*crhs_gauss21 - DN_DX(3,1)*crhs_gauss98 - N(3)*crhs_gauss16 - crhs_gauss233*crhs_gauss49 + crhs_gauss233;
            rhs_gauss[13] = -DN_DX(3,0)*crhs_gauss158 - N(3)*crhs_gauss111 + N(3)*crhs_gauss50 - crhs_gauss102*crhs_gauss234 - crhs_gauss107*crhs_gauss235 - crhs_gauss128*(-crhs_gauss119*crhs_gauss240 + crhs_gauss125*crhs_gauss242 + crhs_gauss237 - crhs_gauss241) - crhs_gauss137*(crhs_gauss109*crhs_gauss243 - crhs_gauss109*crhs_gauss244 + crhs_gauss247) - crhs_gauss48*(DN_DX(3,0)*crhs_gauss74 - crhs_gauss117*crhs_gauss239 + crhs_gauss121*crhs_gauss239 + crhs_gauss236 - crhs_gauss238);
            rhs_gauss[14] = -DN_DX(3,1)*crhs_gauss158 - N(3)*crhs_gauss161 + N(3)*crhs_gauss86 - crhs_gauss102*crhs_gauss235 - crhs_gauss128*(-crhs_gauss109*crhs_gauss245 + crhs_gauss109*crhs_gauss246 + crhs_gauss250) - crhs_gauss137*(-crhs_gauss119*crhs_gauss237 + crhs_gauss125*crhs_gauss241 + crhs_gauss240 - crhs_gauss242) - crhs_gauss159*crhs_gauss234 - crhs_gauss48*(DN_DX(3,1)*crhs_gauss94 - crhs_gauss165*crhs_gauss239 + crhs_gauss167*crhs_gauss239 + crhs_gauss248 - crhs_gauss249);
            rhs_gauss[15] = N(3)*crhs_gauss169 - crhs_gauss170*crhs_gauss235 - crhs_gauss171*crhs_gauss234 - crhs_gauss176*crhs_gauss251 - crhs_gauss189*(crhs_gauss247 + crhs_gauss250) - crhs_gauss48*(N(3)*crhs_gauss42 + crhs_gauss156*crhs_gauss244 + crhs_gauss156*crhs_gauss245 + crhs_gauss191*crhs_gauss239 + crhs_gauss192*crhs_gauss239) - crhs_gauss85*(-DN_DX(3,0)*crhs_gauss180 - crhs_gauss119*crhs_gauss238 - crhs_gauss178*crhs_gauss252 + crhs_gauss184*crhs_gauss251 + crhs_gauss236) - crhs_gauss98*(-DN_DX(3,1)*crhs_gauss186 - crhs_gauss119*crhs_gauss249 - crhs_gauss185*crhs_gauss252 + crhs_gauss188*crhs_gauss251 + crhs_gauss248);


            rRightHandSideBoundedVector += w * detJ * rhs_gauss;
        }
    }
    else
    {
        for(const auto& gauss_point: gauss_points)
        {

            const double w = gauss_point.Weight();
            r_geometry.ShapeFunctionsValues(N, gauss_point.Coordinates());
            r_geometry.InverseOfJacobian(Jinv, gauss_point.Coordinates());
            r_geometry.ShapeFunctionsLocalGradients(DN_DX_iso, gauss_point.Coordinates());
            GeometryUtils::ShapeFunctionsGradients(DN_DX_iso, Jinv, DN_DX);

const double crRightHandSideBoundedVector0 =             N(0)*data.m_ext(0);
const double crRightHandSideBoundedVector1 =             N(1)*data.m_ext(1);
const double crRightHandSideBoundedVector2 =             N(2)*data.m_ext(2);
const double crRightHandSideBoundedVector3 =             N(3)*data.m_ext(3);
const double crRightHandSideBoundedVector4 =             crRightHandSideBoundedVector0 + crRightHandSideBoundedVector1 + crRightHandSideBoundedVector2 + crRightHandSideBoundedVector3;
const double crRightHandSideBoundedVector5 =             N(0)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector6 =             DN_DX(0,1)*data.U(0,2);
const double crRightHandSideBoundedVector7 =             DN_DX(1,1)*data.U(1,2);
const double crRightHandSideBoundedVector8 =             DN_DX(2,1)*data.U(2,2);
const double crRightHandSideBoundedVector9 =             DN_DX(3,1)*data.U(3,2);
const double crRightHandSideBoundedVector10 =             crRightHandSideBoundedVector6 + crRightHandSideBoundedVector7 + crRightHandSideBoundedVector8 + crRightHandSideBoundedVector9;
const double crRightHandSideBoundedVector11 =             DN_DX(0,0)*data.U(0,1);
const double crRightHandSideBoundedVector12 =             DN_DX(1,0)*data.U(1,1);
const double crRightHandSideBoundedVector13 =             DN_DX(2,0)*data.U(2,1);
const double crRightHandSideBoundedVector14 =             DN_DX(3,0)*data.U(3,1);
const double crRightHandSideBoundedVector15 =             crRightHandSideBoundedVector11 + crRightHandSideBoundedVector12 + crRightHandSideBoundedVector13 + crRightHandSideBoundedVector14;
const double crRightHandSideBoundedVector16 =             crRightHandSideBoundedVector10 + crRightHandSideBoundedVector15;
const double crRightHandSideBoundedVector17 =             DN_DX(0,0)*data.U(0,0) + DN_DX(1,0)*data.U(1,0) + DN_DX(2,0)*data.U(2,0) + DN_DX(3,0)*data.U(3,0);
const double crRightHandSideBoundedVector18 =             N(0)*data.alpha_sc_nodes(0) + N(1)*data.alpha_sc_nodes(1) + N(2)*data.alpha_sc_nodes(2) + N(3)*data.alpha_sc_nodes(3);
const double crRightHandSideBoundedVector19 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector18;
const double crRightHandSideBoundedVector20 =             DN_DX(0,1)*data.U(0,0) + DN_DX(1,1)*data.U(1,0) + DN_DX(2,1)*data.U(2,0) + DN_DX(3,1)*data.U(3,0);
const double crRightHandSideBoundedVector21 =             crRightHandSideBoundedVector18*crRightHandSideBoundedVector20;
const double crRightHandSideBoundedVector22 =             N(0)*data.U(0,0) + N(1)*data.U(1,0) + N(2)*data.U(2,0) + N(3)*data.U(3,0);
const double crRightHandSideBoundedVector23 =             1.0/crRightHandSideBoundedVector22;
const double crRightHandSideBoundedVector24 =             fabs(crRightHandSideBoundedVector22);
const double crRightHandSideBoundedVector25 =             N(0)*data.U(0,1) + N(1)*data.U(1,1) + N(2)*data.U(2,1) + N(3)*data.U(3,1);
const double crRightHandSideBoundedVector26 =             pow(crRightHandSideBoundedVector25, 2);
const double crRightHandSideBoundedVector27 =             N(0)*data.U(0,2) + N(1)*data.U(1,2) + N(2)*data.U(2,2) + N(3)*data.U(3,2);
const double crRightHandSideBoundedVector28 =             pow(crRightHandSideBoundedVector27, 2);
const double crRightHandSideBoundedVector29 =             data.gamma - 1;
const double crRightHandSideBoundedVector30 =             0.5*crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector31 =             0.5*crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector32 =             crRightHandSideBoundedVector30 + crRightHandSideBoundedVector31;
const double crRightHandSideBoundedVector33 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector32;
const double crRightHandSideBoundedVector34 =             N(0)*data.U(0,3);
const double crRightHandSideBoundedVector35 =             N(1)*data.U(1,3);
const double crRightHandSideBoundedVector36 =             N(2)*data.U(2,3);
const double crRightHandSideBoundedVector37 =             N(3)*data.U(3,3);
const double crRightHandSideBoundedVector38 =             crRightHandSideBoundedVector34 + crRightHandSideBoundedVector35 + crRightHandSideBoundedVector36 + crRightHandSideBoundedVector37;
const double crRightHandSideBoundedVector39 =             -crRightHandSideBoundedVector33 + crRightHandSideBoundedVector38;
const double crRightHandSideBoundedVector40 =             crRightHandSideBoundedVector29*crRightHandSideBoundedVector39;
const double crRightHandSideBoundedVector41 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector42 =             1.0/data.gamma;
const double crRightHandSideBoundedVector43 =             N(0)*data.r_ext(0) + N(1)*data.r_ext(1) + N(2)*data.r_ext(2) + N(3)*data.r_ext(3);
const double crRightHandSideBoundedVector44 =             pow(crRightHandSideBoundedVector43, 2);
const double crRightHandSideBoundedVector45 =             N(0)*data.f_ext(0,0) + N(1)*data.f_ext(1,0) + N(2)*data.f_ext(2,0) + N(3)*data.f_ext(3,0);
const double crRightHandSideBoundedVector46 =             N(0)*data.f_ext(0,1) + N(1)*data.f_ext(1,1) + N(2)*data.f_ext(2,1) + N(3)*data.f_ext(3,1);
const double crRightHandSideBoundedVector47 =             crRightHandSideBoundedVector41*data.gamma*(pow(crRightHandSideBoundedVector45, 2) + pow(crRightHandSideBoundedVector46, 2));
const double crRightHandSideBoundedVector48 =             0.70710678118654757*crRightHandSideBoundedVector24*crRightHandSideBoundedVector42*stab_c3*sqrt((crRightHandSideBoundedVector44 + 2.0*crRightHandSideBoundedVector47 + 2.0*sqrt(0.25*crRightHandSideBoundedVector44 + crRightHandSideBoundedVector47)*fabs(crRightHandSideBoundedVector43))/(pow(crRightHandSideBoundedVector29, 2)*pow(crRightHandSideBoundedVector39, 2))) + stab_c2*(sqrt(crRightHandSideBoundedVector41)*sqrt(data.gamma) + sqrt(crRightHandSideBoundedVector26 + crRightHandSideBoundedVector28)/crRightHandSideBoundedVector24)/data.h;
const double crRightHandSideBoundedVector49 =             1.0*(N(0)*data.dUdt(0,0) + N(1)*data.dUdt(1,0) + N(2)*data.dUdt(2,0) + N(3)*data.dUdt(3,0) - crRightHandSideBoundedVector0 - crRightHandSideBoundedVector1 + crRightHandSideBoundedVector16 - crRightHandSideBoundedVector2 - crRightHandSideBoundedVector3)/crRightHandSideBoundedVector48;
const double crRightHandSideBoundedVector50 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector49;
const double crRightHandSideBoundedVector51 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector52 =             crRightHandSideBoundedVector29*crRightHandSideBoundedVector32;
const double crRightHandSideBoundedVector53 =             pow(crRightHandSideBoundedVector22, 2);
const double crRightHandSideBoundedVector54 =             1.0/crRightHandSideBoundedVector53;
const double crRightHandSideBoundedVector55 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector56 =             1.0*data.gamma;
const double crRightHandSideBoundedVector57 =             3.0 - crRightHandSideBoundedVector56;
const double crRightHandSideBoundedVector58 =             crRightHandSideBoundedVector15*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector59 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector58;
const double crRightHandSideBoundedVector60 =             DN_DX(0,0)*data.U(0,2);
const double crRightHandSideBoundedVector61 =             DN_DX(1,0)*data.U(1,2);
const double crRightHandSideBoundedVector62 =             DN_DX(2,0)*data.U(2,2);
const double crRightHandSideBoundedVector63 =             DN_DX(3,0)*data.U(3,2);
const double crRightHandSideBoundedVector64 =             crRightHandSideBoundedVector60 + crRightHandSideBoundedVector61 + crRightHandSideBoundedVector62 + crRightHandSideBoundedVector63;
const double crRightHandSideBoundedVector65 =             1.0*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector66 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector65;
const double crRightHandSideBoundedVector67 =             crRightHandSideBoundedVector64*crRightHandSideBoundedVector66;
const double crRightHandSideBoundedVector68 =             -crRightHandSideBoundedVector23*crRightHandSideBoundedVector67;
const double crRightHandSideBoundedVector69 =             DN_DX(0,0)*data.U(0,3) + DN_DX(1,0)*data.U(1,3) + DN_DX(2,0)*data.U(2,3) + DN_DX(3,0)*data.U(3,3);
const double crRightHandSideBoundedVector70 =             DN_DX(0,1)*data.U(0,1);
const double crRightHandSideBoundedVector71 =             DN_DX(1,1)*data.U(1,1);
const double crRightHandSideBoundedVector72 =             DN_DX(2,1)*data.U(2,1);
const double crRightHandSideBoundedVector73 =             DN_DX(3,1)*data.U(3,1);
const double crRightHandSideBoundedVector74 =             crRightHandSideBoundedVector70 + crRightHandSideBoundedVector71 + crRightHandSideBoundedVector72 + crRightHandSideBoundedVector73;
const double crRightHandSideBoundedVector75 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector74;
const double crRightHandSideBoundedVector76 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector75;
const double crRightHandSideBoundedVector77 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector78 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector79 =             crRightHandSideBoundedVector54*crRightHandSideBoundedVector78;
const double crRightHandSideBoundedVector80 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector77 - crRightHandSideBoundedVector25*crRightHandSideBoundedVector79 + crRightHandSideBoundedVector29*crRightHandSideBoundedVector69 + crRightHandSideBoundedVector68 + crRightHandSideBoundedVector76;
const double crRightHandSideBoundedVector81 =             N(0)*data.mu_sc_nodes(0);
const double crRightHandSideBoundedVector82 =             N(1)*data.mu_sc_nodes(1);
const double crRightHandSideBoundedVector83 =             N(2)*data.mu_sc_nodes(2);
const double crRightHandSideBoundedVector84 =             N(3)*data.mu_sc_nodes(3);
const double crRightHandSideBoundedVector85 =             crRightHandSideBoundedVector81 + crRightHandSideBoundedVector82 + crRightHandSideBoundedVector83 + crRightHandSideBoundedVector84 + data.mu;
const double crRightHandSideBoundedVector86 =             crRightHandSideBoundedVector23*stab_c1/pow(data.h, 2);
const double crRightHandSideBoundedVector87 =             1.0/(crRightHandSideBoundedVector48 + 1.3333333333333333*crRightHandSideBoundedVector85*crRightHandSideBoundedVector86);
const double crRightHandSideBoundedVector88 =             crRightHandSideBoundedVector87*(N(0)*data.dUdt(0,1) + N(1)*data.dUdt(1,1) + N(2)*data.dUdt(2,1) + N(3)*data.dUdt(3,1) - crRightHandSideBoundedVector51 + crRightHandSideBoundedVector55*(-crRightHandSideBoundedVector26 + crRightHandSideBoundedVector52) + crRightHandSideBoundedVector57*crRightHandSideBoundedVector59 + crRightHandSideBoundedVector80);
const double crRightHandSideBoundedVector89 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector90 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector91 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector92 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector91;
const double crRightHandSideBoundedVector93 =             crRightHandSideBoundedVector25*crRightHandSideBoundedVector65;
const double crRightHandSideBoundedVector94 =             crRightHandSideBoundedVector74*crRightHandSideBoundedVector93;
const double crRightHandSideBoundedVector95 =             -crRightHandSideBoundedVector23*crRightHandSideBoundedVector94;
const double crRightHandSideBoundedVector96 =             DN_DX(0,1)*data.U(0,3) + DN_DX(1,1)*data.U(1,3) + DN_DX(2,1)*data.U(2,3) + DN_DX(3,1)*data.U(3,3);
const double crRightHandSideBoundedVector97 =             crRightHandSideBoundedVector15*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector98 =             crRightHandSideBoundedVector25*crRightHandSideBoundedVector64;
const double crRightHandSideBoundedVector99 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector98;
const double crRightHandSideBoundedVector100 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector101 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector102 =             -crRightHandSideBoundedVector100*crRightHandSideBoundedVector101 + crRightHandSideBoundedVector23*crRightHandSideBoundedVector97 + crRightHandSideBoundedVector29*crRightHandSideBoundedVector96 + crRightHandSideBoundedVector95 + crRightHandSideBoundedVector99;
const double crRightHandSideBoundedVector103 =             crRightHandSideBoundedVector87*(N(0)*data.dUdt(0,2) + N(1)*data.dUdt(1,2) + N(2)*data.dUdt(2,2) + N(3)*data.dUdt(3,2) + crRightHandSideBoundedVector102 + crRightHandSideBoundedVector57*crRightHandSideBoundedVector92 - crRightHandSideBoundedVector89 + crRightHandSideBoundedVector90*(-crRightHandSideBoundedVector28 + crRightHandSideBoundedVector52));
const double crRightHandSideBoundedVector104 =             DN_DX(0,1)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector105 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector64;
const double crRightHandSideBoundedVector106 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector74;
const double crRightHandSideBoundedVector107 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector108 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector109 =             crRightHandSideBoundedVector85*(crRightHandSideBoundedVector105 + crRightHandSideBoundedVector106 - crRightHandSideBoundedVector107 - crRightHandSideBoundedVector108);
const double crRightHandSideBoundedVector110 =             crRightHandSideBoundedVector15*crRightHandSideBoundedVector22;
const double crRightHandSideBoundedVector111 =             -crRightHandSideBoundedVector100 + crRightHandSideBoundedVector110;
const double crRightHandSideBoundedVector112 =             2*crRightHandSideBoundedVector85;
const double crRightHandSideBoundedVector113 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector22;
const double crRightHandSideBoundedVector114 =             crRightHandSideBoundedVector113 - crRightHandSideBoundedVector78;
const double crRightHandSideBoundedVector115 =             (crRightHandSideBoundedVector111 + crRightHandSideBoundedVector114)*(-N(0)*data.beta_sc_nodes(0) - N(1)*data.beta_sc_nodes(1) - N(2)*data.beta_sc_nodes(2) - N(3)*data.beta_sc_nodes(3) + 0.66666666666666663*crRightHandSideBoundedVector81 + 0.66666666666666663*crRightHandSideBoundedVector82 + 0.66666666666666663*crRightHandSideBoundedVector83 + 0.66666666666666663*crRightHandSideBoundedVector84 + 0.66666666666666663*data.mu);
const double crRightHandSideBoundedVector116 =             crRightHandSideBoundedVector111*crRightHandSideBoundedVector112 + crRightHandSideBoundedVector115;
const double crRightHandSideBoundedVector117 =             DN_DX(0,0)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector118 =             -crRightHandSideBoundedVector52;
const double crRightHandSideBoundedVector119 =             crRightHandSideBoundedVector118 + crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector120 =             crRightHandSideBoundedVector56 - 3.0;
const double crRightHandSideBoundedVector121 =             crRightHandSideBoundedVector120*crRightHandSideBoundedVector58;
const double crRightHandSideBoundedVector122 =             -crRightHandSideBoundedVector119*crRightHandSideBoundedVector55 - crRightHandSideBoundedVector121*crRightHandSideBoundedVector23 + crRightHandSideBoundedVector80;
const double crRightHandSideBoundedVector123 =             N(0)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector124 =             DN_DX(0,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector125 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector124;
const double crRightHandSideBoundedVector126 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector78;
const double crRightHandSideBoundedVector127 =             crRightHandSideBoundedVector126*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector128 =             -2*crRightHandSideBoundedVector127 + crRightHandSideBoundedVector75 + crRightHandSideBoundedVector77;
const double crRightHandSideBoundedVector129 =             N(0)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector130 =             1.0*crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector131 =             1.0*crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector132 =             crRightHandSideBoundedVector29*(-crRightHandSideBoundedVector130 - crRightHandSideBoundedVector131);
const double crRightHandSideBoundedVector133 =             crRightHandSideBoundedVector17*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector134 =             crRightHandSideBoundedVector121 + crRightHandSideBoundedVector133*(crRightHandSideBoundedVector132 + 2*crRightHandSideBoundedVector26) + crRightHandSideBoundedVector67;
const double crRightHandSideBoundedVector135 =             DN_DX(0,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector136 =             crRightHandSideBoundedVector108*crRightHandSideBoundedVector23 - crRightHandSideBoundedVector70 - crRightHandSideBoundedVector71 - crRightHandSideBoundedVector72 - crRightHandSideBoundedVector73;
const double crRightHandSideBoundedVector137 =             N(0)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector138 =             crRightHandSideBoundedVector56 - 1.0;
const double crRightHandSideBoundedVector139 =             crRightHandSideBoundedVector107*crRightHandSideBoundedVector23 - crRightHandSideBoundedVector60 - crRightHandSideBoundedVector61 - crRightHandSideBoundedVector62 - crRightHandSideBoundedVector63;
const double crRightHandSideBoundedVector140 =             N(0)*crRightHandSideBoundedVector139;
const double crRightHandSideBoundedVector141 =             crRightHandSideBoundedVector103*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector142 =             crRightHandSideBoundedVector100*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector143 =             -crRightHandSideBoundedVector11 - crRightHandSideBoundedVector12 - crRightHandSideBoundedVector13 - crRightHandSideBoundedVector14 + crRightHandSideBoundedVector142;
const double crRightHandSideBoundedVector144 =             N(0)*crRightHandSideBoundedVector143;
const double crRightHandSideBoundedVector145 =             DN_DX(0,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector146 =             DN_DX(0,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector147 =             crRightHandSideBoundedVector126 - crRightHandSideBoundedVector6 - crRightHandSideBoundedVector7 - crRightHandSideBoundedVector8 - crRightHandSideBoundedVector9;
const double crRightHandSideBoundedVector148 =             N(0)*crRightHandSideBoundedVector147;
const double crRightHandSideBoundedVector149 =             crRightHandSideBoundedVector146 - crRightHandSideBoundedVector148;
const double crRightHandSideBoundedVector150 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector88;
const double crRightHandSideBoundedVector151 =             (N(0)*data.lamb_sc_nodes(0) + N(1)*data.lamb_sc_nodes(1) + N(2)*data.lamb_sc_nodes(2) + N(3)*data.lamb_sc_nodes(3) + data.lambda)/data.c_v;
const double crRightHandSideBoundedVector152 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector43;
const double crRightHandSideBoundedVector153 =             crRightHandSideBoundedVector25*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector154 =             crRightHandSideBoundedVector27*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector155 =             crRightHandSideBoundedVector69*data.gamma;
const double crRightHandSideBoundedVector156 =             crRightHandSideBoundedVector155*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector157 =             crRightHandSideBoundedVector96*data.gamma;
const double crRightHandSideBoundedVector158 =             crRightHandSideBoundedVector157*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector159 =             1.0*crRightHandSideBoundedVector98;
const double crRightHandSideBoundedVector160 =             1.0*crRightHandSideBoundedVector75;
const double crRightHandSideBoundedVector161 =             crRightHandSideBoundedVector25*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector162 =             crRightHandSideBoundedVector23*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector163 =             crRightHandSideBoundedVector130*crRightHandSideBoundedVector162;
const double crRightHandSideBoundedVector164 =             crRightHandSideBoundedVector38 + crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector165 =             crRightHandSideBoundedVector131*crRightHandSideBoundedVector162;
const double crRightHandSideBoundedVector166 =             crRightHandSideBoundedVector29*crRightHandSideBoundedVector33;
const double crRightHandSideBoundedVector167 =             -crRightHandSideBoundedVector34 - crRightHandSideBoundedVector35 - crRightHandSideBoundedVector36 - crRightHandSideBoundedVector37 - crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector168 =             crRightHandSideBoundedVector166 + crRightHandSideBoundedVector167;
const double crRightHandSideBoundedVector169 =             (N(0)*data.dUdt(0,3) + N(1)*data.dUdt(1,3) + N(2)*data.dUdt(2,3) + N(3)*data.dUdt(3,3) + crRightHandSideBoundedVector100*crRightHandSideBoundedVector168*crRightHandSideBoundedVector54 - crRightHandSideBoundedVector101*crRightHandSideBoundedVector159*crRightHandSideBoundedVector29 + crRightHandSideBoundedVector15*crRightHandSideBoundedVector23*(-crRightHandSideBoundedVector163 + crRightHandSideBoundedVector164) - crRightHandSideBoundedVector152 - crRightHandSideBoundedVector153 - crRightHandSideBoundedVector154 + crRightHandSideBoundedVector156*crRightHandSideBoundedVector23 + crRightHandSideBoundedVector158*crRightHandSideBoundedVector23 - crRightHandSideBoundedVector160*crRightHandSideBoundedVector161*crRightHandSideBoundedVector54 + crRightHandSideBoundedVector168*crRightHandSideBoundedVector79 + crRightHandSideBoundedVector91*(crRightHandSideBoundedVector164 - crRightHandSideBoundedVector165))/(crRightHandSideBoundedVector151*crRightHandSideBoundedVector42*crRightHandSideBoundedVector86 + crRightHandSideBoundedVector48);
const double crRightHandSideBoundedVector170 =             crRightHandSideBoundedVector169*crRightHandSideBoundedVector65;
const double crRightHandSideBoundedVector171 =             crRightHandSideBoundedVector112*crRightHandSideBoundedVector114 + crRightHandSideBoundedVector115;
const double crRightHandSideBoundedVector172 =             crRightHandSideBoundedVector118 + crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector173 =             crRightHandSideBoundedVector120*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector174 =             crRightHandSideBoundedVector102 - crRightHandSideBoundedVector172*crRightHandSideBoundedVector90 - crRightHandSideBoundedVector173*crRightHandSideBoundedVector91;
const double crRightHandSideBoundedVector175 =             N(0)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector176 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector145;
const double crRightHandSideBoundedVector177 =             crRightHandSideBoundedVector142*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector178 =             -2*crRightHandSideBoundedVector177 + crRightHandSideBoundedVector97 + crRightHandSideBoundedVector98;
const double crRightHandSideBoundedVector179 =             crRightHandSideBoundedVector20*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector180 =             crRightHandSideBoundedVector10*crRightHandSideBoundedVector173 + crRightHandSideBoundedVector179*(crRightHandSideBoundedVector132 + 2*crRightHandSideBoundedVector28) + crRightHandSideBoundedVector94;
const double crRightHandSideBoundedVector181 =             -crRightHandSideBoundedVector144 + crRightHandSideBoundedVector145;
const double crRightHandSideBoundedVector182 =             crRightHandSideBoundedVector152 + crRightHandSideBoundedVector153 + crRightHandSideBoundedVector154;
const double crRightHandSideBoundedVector183 =             pow(crRightHandSideBoundedVector22, -3);
const double crRightHandSideBoundedVector184 =             crRightHandSideBoundedVector22*crRightHandSideBoundedVector38;
const double crRightHandSideBoundedVector185 =             1.0*crRightHandSideBoundedVector151;
const double crRightHandSideBoundedVector186 =             crRightHandSideBoundedVector183*(crRightHandSideBoundedVector109*crRightHandSideBoundedVector27 + crRightHandSideBoundedVector116*crRightHandSideBoundedVector25 + crRightHandSideBoundedVector185*(-crRightHandSideBoundedVector105*crRightHandSideBoundedVector27 - crRightHandSideBoundedVector110*crRightHandSideBoundedVector25 - crRightHandSideBoundedVector17*crRightHandSideBoundedVector184 + crRightHandSideBoundedVector17*crRightHandSideBoundedVector26 + crRightHandSideBoundedVector17*crRightHandSideBoundedVector28 + crRightHandSideBoundedVector53*crRightHandSideBoundedVector69));
const double crRightHandSideBoundedVector187 =             crRightHandSideBoundedVector183*(crRightHandSideBoundedVector109*crRightHandSideBoundedVector25 + crRightHandSideBoundedVector171*crRightHandSideBoundedVector27 + crRightHandSideBoundedVector185*(-crRightHandSideBoundedVector106*crRightHandSideBoundedVector25 - crRightHandSideBoundedVector113*crRightHandSideBoundedVector27 - crRightHandSideBoundedVector184*crRightHandSideBoundedVector20 + crRightHandSideBoundedVector20*crRightHandSideBoundedVector26 + crRightHandSideBoundedVector20*crRightHandSideBoundedVector28 + crRightHandSideBoundedVector53*crRightHandSideBoundedVector96));
const double crRightHandSideBoundedVector188 =             crRightHandSideBoundedVector163 + crRightHandSideBoundedVector167;
const double crRightHandSideBoundedVector189 =             crRightHandSideBoundedVector165 + crRightHandSideBoundedVector167;
const double crRightHandSideBoundedVector190 =             crRightHandSideBoundedVector164 - crRightHandSideBoundedVector166;
const double crRightHandSideBoundedVector191 =             -crRightHandSideBoundedVector10*crRightHandSideBoundedVector189 - crRightHandSideBoundedVector126*crRightHandSideBoundedVector190 - crRightHandSideBoundedVector142*crRightHandSideBoundedVector190 - crRightHandSideBoundedVector15*crRightHandSideBoundedVector188 + crRightHandSideBoundedVector156 + crRightHandSideBoundedVector158 - crRightHandSideBoundedVector66*crRightHandSideBoundedVector99 - crRightHandSideBoundedVector76*crRightHandSideBoundedVector93;
const double crRightHandSideBoundedVector192 =             N(0)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector193 =             -2.0*crRightHandSideBoundedVector127 + crRightHandSideBoundedVector160 + 1.0*crRightHandSideBoundedVector77;
const double crRightHandSideBoundedVector194 =             crRightHandSideBoundedVector129*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector195 =             crRightHandSideBoundedVector188*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector196 =             3.0*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector197 =             2.0*crRightHandSideBoundedVector162;
const double crRightHandSideBoundedVector198 =             crRightHandSideBoundedVector190 - crRightHandSideBoundedVector197*crRightHandSideBoundedVector26;
const double crRightHandSideBoundedVector199 =             -crRightHandSideBoundedVector133*crRightHandSideBoundedVector198 + crRightHandSideBoundedVector155 - crRightHandSideBoundedVector196*crRightHandSideBoundedVector59 + crRightHandSideBoundedVector68;
const double crRightHandSideBoundedVector200 =             crRightHandSideBoundedVector159 - 2.0*crRightHandSideBoundedVector177 + 1.0*crRightHandSideBoundedVector97;
const double crRightHandSideBoundedVector201 =             crRightHandSideBoundedVector189*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector202 =             crRightHandSideBoundedVector190 - crRightHandSideBoundedVector197*crRightHandSideBoundedVector28;
const double crRightHandSideBoundedVector203 =             crRightHandSideBoundedVector157 - crRightHandSideBoundedVector179*crRightHandSideBoundedVector202 - crRightHandSideBoundedVector196*crRightHandSideBoundedVector92 + crRightHandSideBoundedVector95;
const double crRightHandSideBoundedVector204 =             crRightHandSideBoundedVector169*crRightHandSideBoundedVector23*crRightHandSideBoundedVector56;
const double crRightHandSideBoundedVector205 =             crRightHandSideBoundedVector190*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector206 =             crRightHandSideBoundedVector132*crRightHandSideBoundedVector23 + 2*crRightHandSideBoundedVector162*(-crRightHandSideBoundedVector30 - crRightHandSideBoundedVector31) + 2*crRightHandSideBoundedVector34 + 2*crRightHandSideBoundedVector35 + 2*crRightHandSideBoundedVector36 + 2*crRightHandSideBoundedVector37 + 2*crRightHandSideBoundedVector40;
const double crRightHandSideBoundedVector207 =             crRightHandSideBoundedVector142*crRightHandSideBoundedVector206 - crRightHandSideBoundedVector15*crRightHandSideBoundedVector198 - crRightHandSideBoundedVector156 + 2.0*crRightHandSideBoundedVector27*crRightHandSideBoundedVector29*crRightHandSideBoundedVector99;
const double crRightHandSideBoundedVector208 =             -crRightHandSideBoundedVector10*crRightHandSideBoundedVector202 + crRightHandSideBoundedVector126*crRightHandSideBoundedVector206 - crRightHandSideBoundedVector158 + 2.0*crRightHandSideBoundedVector161*crRightHandSideBoundedVector76;
const double crRightHandSideBoundedVector209 =             N(1)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector210 =             DN_DX(1,1)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector211 =             DN_DX(1,0)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector212 =             N(1)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector213 =             DN_DX(1,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector214 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector213;
const double crRightHandSideBoundedVector215 =             N(1)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector216 =             DN_DX(1,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector217 =             N(1)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector218 =             N(1)*crRightHandSideBoundedVector139;
const double crRightHandSideBoundedVector219 =             N(1)*crRightHandSideBoundedVector143;
const double crRightHandSideBoundedVector220 =             DN_DX(1,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector221 =             DN_DX(1,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector222 =             N(1)*crRightHandSideBoundedVector147;
const double crRightHandSideBoundedVector223 =             crRightHandSideBoundedVector221 - crRightHandSideBoundedVector222;
const double crRightHandSideBoundedVector224 =             N(1)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector225 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector220;
const double crRightHandSideBoundedVector226 =             -crRightHandSideBoundedVector219 + crRightHandSideBoundedVector220;
const double crRightHandSideBoundedVector227 =             N(1)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector228 =             crRightHandSideBoundedVector215*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector229 =             N(2)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector230 =             DN_DX(2,1)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector231 =             DN_DX(2,0)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector232 =             N(2)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector233 =             DN_DX(2,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector234 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector233;
const double crRightHandSideBoundedVector235 =             N(2)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector236 =             DN_DX(2,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector237 =             N(2)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector238 =             N(2)*crRightHandSideBoundedVector139;
const double crRightHandSideBoundedVector239 =             N(2)*crRightHandSideBoundedVector143;
const double crRightHandSideBoundedVector240 =             DN_DX(2,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector241 =             DN_DX(2,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector242 =             N(2)*crRightHandSideBoundedVector147;
const double crRightHandSideBoundedVector243 =             crRightHandSideBoundedVector241 - crRightHandSideBoundedVector242;
const double crRightHandSideBoundedVector244 =             N(2)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector245 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector240;
const double crRightHandSideBoundedVector246 =             -crRightHandSideBoundedVector239 + crRightHandSideBoundedVector240;
const double crRightHandSideBoundedVector247 =             N(2)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector248 =             crRightHandSideBoundedVector235*crRightHandSideBoundedVector29;
const double crRightHandSideBoundedVector249 =             N(3)*crRightHandSideBoundedVector4;
const double crRightHandSideBoundedVector250 =             DN_DX(3,1)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector251 =             DN_DX(3,0)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector252 =             N(3)*crRightHandSideBoundedVector45;
const double crRightHandSideBoundedVector253 =             DN_DX(3,1)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector254 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector253;
const double crRightHandSideBoundedVector255 =             N(3)*crRightHandSideBoundedVector54;
const double crRightHandSideBoundedVector256 =             DN_DX(3,0)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector257 =             N(3)*crRightHandSideBoundedVector136;
const double crRightHandSideBoundedVector258 =             N(3)*crRightHandSideBoundedVector139;
const double crRightHandSideBoundedVector259 =             N(3)*crRightHandSideBoundedVector143;
const double crRightHandSideBoundedVector260 =             DN_DX(3,0)*crRightHandSideBoundedVector25;
const double crRightHandSideBoundedVector261 =             DN_DX(3,1)*crRightHandSideBoundedVector27;
const double crRightHandSideBoundedVector262 =             N(3)*crRightHandSideBoundedVector147;
const double crRightHandSideBoundedVector263 =             crRightHandSideBoundedVector261 - crRightHandSideBoundedVector262;
const double crRightHandSideBoundedVector264 =             N(3)*crRightHandSideBoundedVector46;
const double crRightHandSideBoundedVector265 =             crRightHandSideBoundedVector101*crRightHandSideBoundedVector260;
const double crRightHandSideBoundedVector266 =             -crRightHandSideBoundedVector259 + crRightHandSideBoundedVector260;
const double crRightHandSideBoundedVector267 =             N(3)*crRightHandSideBoundedVector23;
const double crRightHandSideBoundedVector268 =             crRightHandSideBoundedVector255*crRightHandSideBoundedVector29;
            rRightHandSideBoundedVector[0] += DN_DX(0,0)*crRightHandSideBoundedVector19 - DN_DX(0,0)*crRightHandSideBoundedVector88 - DN_DX(0,1)*crRightHandSideBoundedVector103 + DN_DX(0,1)*crRightHandSideBoundedVector21 - N(0)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector5*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector5;
            rRightHandSideBoundedVector[1] += -DN_DX(0,0)*crRightHandSideBoundedVector170 - N(0)*crRightHandSideBoundedVector122 + N(0)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector104*crRightHandSideBoundedVector109 - crRightHandSideBoundedVector116*crRightHandSideBoundedVector117 - crRightHandSideBoundedVector141*(crRightHandSideBoundedVector124 - crRightHandSideBoundedVector135*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector137 + crRightHandSideBoundedVector138*crRightHandSideBoundedVector140) - crRightHandSideBoundedVector150*(crRightHandSideBoundedVector120*crRightHandSideBoundedVector144 - crRightHandSideBoundedVector120*crRightHandSideBoundedVector145 + crRightHandSideBoundedVector149) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector117*crRightHandSideBoundedVector119 + crRightHandSideBoundedVector123 - crRightHandSideBoundedVector125 - crRightHandSideBoundedVector128*crRightHandSideBoundedVector129 + crRightHandSideBoundedVector129*crRightHandSideBoundedVector134);
            rRightHandSideBoundedVector[2] += -DN_DX(0,1)*crRightHandSideBoundedVector170 - N(0)*crRightHandSideBoundedVector174 + N(0)*crRightHandSideBoundedVector89 - crRightHandSideBoundedVector104*crRightHandSideBoundedVector171 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector117 - crRightHandSideBoundedVector141*(-crRightHandSideBoundedVector120*crRightHandSideBoundedVector146 + crRightHandSideBoundedVector120*crRightHandSideBoundedVector148 + crRightHandSideBoundedVector181) - crRightHandSideBoundedVector150*(-crRightHandSideBoundedVector124*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector135 + crRightHandSideBoundedVector137*crRightHandSideBoundedVector138 - crRightHandSideBoundedVector140) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector104*crRightHandSideBoundedVector172 - crRightHandSideBoundedVector129*crRightHandSideBoundedVector178 + crRightHandSideBoundedVector129*crRightHandSideBoundedVector180 + crRightHandSideBoundedVector175 - crRightHandSideBoundedVector176);
            rRightHandSideBoundedVector[3] += -DN_DX(0,0)*crRightHandSideBoundedVector186 - DN_DX(0,1)*crRightHandSideBoundedVector187 + N(0)*crRightHandSideBoundedVector182 - crRightHandSideBoundedVector103*(-DN_DX(0,1)*crRightHandSideBoundedVector201 + crRightHandSideBoundedVector175 - crRightHandSideBoundedVector176*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector192*crRightHandSideBoundedVector203 - crRightHandSideBoundedVector194*crRightHandSideBoundedVector200) - crRightHandSideBoundedVector191*crRightHandSideBoundedVector192 - crRightHandSideBoundedVector204*(crRightHandSideBoundedVector149 + crRightHandSideBoundedVector181) - crRightHandSideBoundedVector49*(N(0)*crRightHandSideBoundedVector43 + crRightHandSideBoundedVector129*crRightHandSideBoundedVector207 + crRightHandSideBoundedVector129*crRightHandSideBoundedVector208 - crRightHandSideBoundedVector145*crRightHandSideBoundedVector205 - crRightHandSideBoundedVector146*crRightHandSideBoundedVector205) - crRightHandSideBoundedVector88*(-DN_DX(0,0)*crRightHandSideBoundedVector195 + crRightHandSideBoundedVector123 - crRightHandSideBoundedVector125*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector192*crRightHandSideBoundedVector199 - crRightHandSideBoundedVector193*crRightHandSideBoundedVector194);
            rRightHandSideBoundedVector[4] += DN_DX(1,0)*crRightHandSideBoundedVector19 - DN_DX(1,0)*crRightHandSideBoundedVector88 - DN_DX(1,1)*crRightHandSideBoundedVector103 + DN_DX(1,1)*crRightHandSideBoundedVector21 - N(1)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector209*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector209;
            rRightHandSideBoundedVector[5] += -DN_DX(1,0)*crRightHandSideBoundedVector170 - N(1)*crRightHandSideBoundedVector122 + N(1)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector210 - crRightHandSideBoundedVector116*crRightHandSideBoundedVector211 - crRightHandSideBoundedVector141*(crRightHandSideBoundedVector138*crRightHandSideBoundedVector218 + crRightHandSideBoundedVector213 - crRightHandSideBoundedVector216*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector217) - crRightHandSideBoundedVector150*(crRightHandSideBoundedVector120*crRightHandSideBoundedVector219 - crRightHandSideBoundedVector120*crRightHandSideBoundedVector220 + crRightHandSideBoundedVector223) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector119*crRightHandSideBoundedVector211 - crRightHandSideBoundedVector128*crRightHandSideBoundedVector215 + crRightHandSideBoundedVector134*crRightHandSideBoundedVector215 + crRightHandSideBoundedVector212 - crRightHandSideBoundedVector214);
            rRightHandSideBoundedVector[6] += -DN_DX(1,1)*crRightHandSideBoundedVector170 - N(1)*crRightHandSideBoundedVector174 + N(1)*crRightHandSideBoundedVector89 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector211 - crRightHandSideBoundedVector141*(-crRightHandSideBoundedVector120*crRightHandSideBoundedVector221 + crRightHandSideBoundedVector120*crRightHandSideBoundedVector222 + crRightHandSideBoundedVector226) - crRightHandSideBoundedVector150*(crRightHandSideBoundedVector138*crRightHandSideBoundedVector217 - crRightHandSideBoundedVector213*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector216 - crRightHandSideBoundedVector218) - crRightHandSideBoundedVector171*crRightHandSideBoundedVector210 - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector172*crRightHandSideBoundedVector210 - crRightHandSideBoundedVector178*crRightHandSideBoundedVector215 + crRightHandSideBoundedVector180*crRightHandSideBoundedVector215 + crRightHandSideBoundedVector224 - crRightHandSideBoundedVector225);
            rRightHandSideBoundedVector[7] += -DN_DX(1,0)*crRightHandSideBoundedVector186 - DN_DX(1,1)*crRightHandSideBoundedVector187 + N(1)*crRightHandSideBoundedVector182 - crRightHandSideBoundedVector103*(-DN_DX(1,1)*crRightHandSideBoundedVector201 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector228 + crRightHandSideBoundedVector203*crRightHandSideBoundedVector227 + crRightHandSideBoundedVector224 - crRightHandSideBoundedVector225*crRightHandSideBoundedVector65) - crRightHandSideBoundedVector191*crRightHandSideBoundedVector227 - crRightHandSideBoundedVector204*(crRightHandSideBoundedVector223 + crRightHandSideBoundedVector226) - crRightHandSideBoundedVector49*(N(1)*crRightHandSideBoundedVector43 - crRightHandSideBoundedVector205*crRightHandSideBoundedVector220 - crRightHandSideBoundedVector205*crRightHandSideBoundedVector221 + crRightHandSideBoundedVector207*crRightHandSideBoundedVector215 + crRightHandSideBoundedVector208*crRightHandSideBoundedVector215) - crRightHandSideBoundedVector88*(-DN_DX(1,0)*crRightHandSideBoundedVector195 - crRightHandSideBoundedVector193*crRightHandSideBoundedVector228 + crRightHandSideBoundedVector199*crRightHandSideBoundedVector227 + crRightHandSideBoundedVector212 - crRightHandSideBoundedVector214*crRightHandSideBoundedVector65);
            rRightHandSideBoundedVector[8] += DN_DX(2,0)*crRightHandSideBoundedVector19 - DN_DX(2,0)*crRightHandSideBoundedVector88 - DN_DX(2,1)*crRightHandSideBoundedVector103 + DN_DX(2,1)*crRightHandSideBoundedVector21 - N(2)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector229*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector229;
            rRightHandSideBoundedVector[9] += -DN_DX(2,0)*crRightHandSideBoundedVector170 - N(2)*crRightHandSideBoundedVector122 + N(2)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector230 - crRightHandSideBoundedVector116*crRightHandSideBoundedVector231 - crRightHandSideBoundedVector141*(crRightHandSideBoundedVector138*crRightHandSideBoundedVector238 + crRightHandSideBoundedVector233 - crRightHandSideBoundedVector236*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector237) - crRightHandSideBoundedVector150*(crRightHandSideBoundedVector120*crRightHandSideBoundedVector239 - crRightHandSideBoundedVector120*crRightHandSideBoundedVector240 + crRightHandSideBoundedVector243) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector119*crRightHandSideBoundedVector231 - crRightHandSideBoundedVector128*crRightHandSideBoundedVector235 + crRightHandSideBoundedVector134*crRightHandSideBoundedVector235 + crRightHandSideBoundedVector232 - crRightHandSideBoundedVector234);
            rRightHandSideBoundedVector[10] += -DN_DX(2,1)*crRightHandSideBoundedVector170 - N(2)*crRightHandSideBoundedVector174 + N(2)*crRightHandSideBoundedVector89 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector231 - crRightHandSideBoundedVector141*(-crRightHandSideBoundedVector120*crRightHandSideBoundedVector241 + crRightHandSideBoundedVector120*crRightHandSideBoundedVector242 + crRightHandSideBoundedVector246) - crRightHandSideBoundedVector150*(crRightHandSideBoundedVector138*crRightHandSideBoundedVector237 - crRightHandSideBoundedVector233*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector236 - crRightHandSideBoundedVector238) - crRightHandSideBoundedVector171*crRightHandSideBoundedVector230 - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector172*crRightHandSideBoundedVector230 - crRightHandSideBoundedVector178*crRightHandSideBoundedVector235 + crRightHandSideBoundedVector180*crRightHandSideBoundedVector235 + crRightHandSideBoundedVector244 - crRightHandSideBoundedVector245);
            rRightHandSideBoundedVector[11] += -DN_DX(2,0)*crRightHandSideBoundedVector186 - DN_DX(2,1)*crRightHandSideBoundedVector187 + N(2)*crRightHandSideBoundedVector182 - crRightHandSideBoundedVector103*(-DN_DX(2,1)*crRightHandSideBoundedVector201 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector248 + crRightHandSideBoundedVector203*crRightHandSideBoundedVector247 + crRightHandSideBoundedVector244 - crRightHandSideBoundedVector245*crRightHandSideBoundedVector65) - crRightHandSideBoundedVector191*crRightHandSideBoundedVector247 - crRightHandSideBoundedVector204*(crRightHandSideBoundedVector243 + crRightHandSideBoundedVector246) - crRightHandSideBoundedVector49*(N(2)*crRightHandSideBoundedVector43 - crRightHandSideBoundedVector205*crRightHandSideBoundedVector240 - crRightHandSideBoundedVector205*crRightHandSideBoundedVector241 + crRightHandSideBoundedVector207*crRightHandSideBoundedVector235 + crRightHandSideBoundedVector208*crRightHandSideBoundedVector235) - crRightHandSideBoundedVector88*(-DN_DX(2,0)*crRightHandSideBoundedVector195 - crRightHandSideBoundedVector193*crRightHandSideBoundedVector248 + crRightHandSideBoundedVector199*crRightHandSideBoundedVector247 + crRightHandSideBoundedVector232 - crRightHandSideBoundedVector234*crRightHandSideBoundedVector65);
            rRightHandSideBoundedVector[12] += DN_DX(3,0)*crRightHandSideBoundedVector19 - DN_DX(3,0)*crRightHandSideBoundedVector88 - DN_DX(3,1)*crRightHandSideBoundedVector103 + DN_DX(3,1)*crRightHandSideBoundedVector21 - N(3)*crRightHandSideBoundedVector16 - crRightHandSideBoundedVector249*crRightHandSideBoundedVector50 + crRightHandSideBoundedVector249;
            rRightHandSideBoundedVector[13] += -DN_DX(3,0)*crRightHandSideBoundedVector170 - N(3)*crRightHandSideBoundedVector122 + N(3)*crRightHandSideBoundedVector51 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector250 - crRightHandSideBoundedVector116*crRightHandSideBoundedVector251 - crRightHandSideBoundedVector141*(crRightHandSideBoundedVector138*crRightHandSideBoundedVector258 + crRightHandSideBoundedVector253 - crRightHandSideBoundedVector256*crRightHandSideBoundedVector65 - crRightHandSideBoundedVector257) - crRightHandSideBoundedVector150*(crRightHandSideBoundedVector120*crRightHandSideBoundedVector259 - crRightHandSideBoundedVector120*crRightHandSideBoundedVector260 + crRightHandSideBoundedVector263) - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector119*crRightHandSideBoundedVector251 - crRightHandSideBoundedVector128*crRightHandSideBoundedVector255 + crRightHandSideBoundedVector134*crRightHandSideBoundedVector255 + crRightHandSideBoundedVector252 - crRightHandSideBoundedVector254);
            rRightHandSideBoundedVector[14] += -DN_DX(3,1)*crRightHandSideBoundedVector170 - N(3)*crRightHandSideBoundedVector174 + N(3)*crRightHandSideBoundedVector89 - crRightHandSideBoundedVector109*crRightHandSideBoundedVector251 - crRightHandSideBoundedVector141*(-crRightHandSideBoundedVector120*crRightHandSideBoundedVector261 + crRightHandSideBoundedVector120*crRightHandSideBoundedVector262 + crRightHandSideBoundedVector266) - crRightHandSideBoundedVector150*(crRightHandSideBoundedVector138*crRightHandSideBoundedVector257 - crRightHandSideBoundedVector253*crRightHandSideBoundedVector65 + crRightHandSideBoundedVector256 - crRightHandSideBoundedVector258) - crRightHandSideBoundedVector171*crRightHandSideBoundedVector250 - crRightHandSideBoundedVector49*(-crRightHandSideBoundedVector172*crRightHandSideBoundedVector250 - crRightHandSideBoundedVector178*crRightHandSideBoundedVector255 + crRightHandSideBoundedVector180*crRightHandSideBoundedVector255 + crRightHandSideBoundedVector264 - crRightHandSideBoundedVector265);
            rRightHandSideBoundedVector[15] += -DN_DX(3,0)*crRightHandSideBoundedVector186 - DN_DX(3,1)*crRightHandSideBoundedVector187 + N(3)*crRightHandSideBoundedVector182 - crRightHandSideBoundedVector103*(-DN_DX(3,1)*crRightHandSideBoundedVector201 - crRightHandSideBoundedVector200*crRightHandSideBoundedVector268 + crRightHandSideBoundedVector203*crRightHandSideBoundedVector267 + crRightHandSideBoundedVector264 - crRightHandSideBoundedVector265*crRightHandSideBoundedVector65) - crRightHandSideBoundedVector191*crRightHandSideBoundedVector267 - crRightHandSideBoundedVector204*(crRightHandSideBoundedVector263 + crRightHandSideBoundedVector266) - crRightHandSideBoundedVector49*(N(3)*crRightHandSideBoundedVector43 - crRightHandSideBoundedVector205*crRightHandSideBoundedVector260 - crRightHandSideBoundedVector205*crRightHandSideBoundedVector261 + crRightHandSideBoundedVector207*crRightHandSideBoundedVector255 + crRightHandSideBoundedVector208*crRightHandSideBoundedVector255) - crRightHandSideBoundedVector88*(-DN_DX(3,0)*crRightHandSideBoundedVector195 - crRightHandSideBoundedVector193*crRightHandSideBoundedVector268 + crRightHandSideBoundedVector199*crRightHandSideBoundedVector267 + crRightHandSideBoundedVector252 - crRightHandSideBoundedVector254*crRightHandSideBoundedVector65);

            double detJ;
            r_geometry.Jacobian(J, gauss_point.Coordinates());
            MathUtils<double>::InvertMatrix(J, Jinv, detJ);

            r_geometry.ShapeFunctionsLocalGradients(DN_De, gauss_point.Coordinates());
            GeometryUtils::ShapeFunctionsGradients(DN_De, Jinv, DN_DX);

            BoundedVector<double, DofSize> rhs_gauss(DofSize);

const double crhs_gauss0 =             N(0)*data.m_ext(0);
const double crhs_gauss1 =             N(1)*data.m_ext(1);
const double crhs_gauss2 =             N(2)*data.m_ext(2);
const double crhs_gauss3 =             N(3)*data.m_ext(3);
const double crhs_gauss4 =             crhs_gauss0 + crhs_gauss1 + crhs_gauss2 + crhs_gauss3;
const double crhs_gauss5 =             N(0)*crhs_gauss4;
const double crhs_gauss6 =             DN_DX(0,1)*data.U(0,2);
const double crhs_gauss7 =             DN_DX(1,1)*data.U(1,2);
const double crhs_gauss8 =             DN_DX(2,1)*data.U(2,2);
const double crhs_gauss9 =             DN_DX(3,1)*data.U(3,2);
const double crhs_gauss10 =             crhs_gauss6 + crhs_gauss7 + crhs_gauss8 + crhs_gauss9;
const double crhs_gauss11 =             DN_DX(0,0)*data.U(0,1);
const double crhs_gauss12 =             DN_DX(1,0)*data.U(1,1);
const double crhs_gauss13 =             DN_DX(2,0)*data.U(2,1);
const double crhs_gauss14 =             DN_DX(3,0)*data.U(3,1);
const double crhs_gauss15 =             crhs_gauss11 + crhs_gauss12 + crhs_gauss13 + crhs_gauss14;
const double crhs_gauss16 =             crhs_gauss10 + crhs_gauss15;
const double crhs_gauss17 =             DN_DX(0,0)*data.U(0,0) + DN_DX(1,0)*data.U(1,0) + DN_DX(2,0)*data.U(2,0) + DN_DX(3,0)*data.U(3,0);
const double crhs_gauss18 =             N(0)*data.alpha_sc_nodes(0) + N(1)*data.alpha_sc_nodes(1) + N(2)*data.alpha_sc_nodes(2) + N(3)*data.alpha_sc_nodes(3);
const double crhs_gauss19 =             crhs_gauss17*crhs_gauss18;
const double crhs_gauss20 =             DN_DX(0,1)*data.U(0,0) + DN_DX(1,1)*data.U(1,0) + DN_DX(2,1)*data.U(2,0) + DN_DX(3,1)*data.U(3,0);
const double crhs_gauss21 =             crhs_gauss18*crhs_gauss20;
const double crhs_gauss22 =             N(0)*data.U(0,0) + N(1)*data.U(1,0) + N(2)*data.U(2,0) + N(3)*data.U(3,0);
const double crhs_gauss23 =             1.0/crhs_gauss22;
const double crhs_gauss24 =             fabs(crhs_gauss22);
const double crhs_gauss25 =             N(0)*data.U(0,1) + N(1)*data.U(1,1) + N(2)*data.U(2,1) + N(3)*data.U(3,1);
const double crhs_gauss26 =             pow(crhs_gauss25, 2);
const double crhs_gauss27 =             N(0)*data.U(0,2) + N(1)*data.U(1,2) + N(2)*data.U(2,2) + N(3)*data.U(3,2);
const double crhs_gauss28 =             pow(crhs_gauss27, 2);
const double crhs_gauss29 =             crhs_gauss26 + crhs_gauss28;
const double crhs_gauss30 =             0.5*crhs_gauss26;
const double crhs_gauss31 =             0.5*crhs_gauss28;
const double crhs_gauss32 =             N(0)*data.U(0,3);
const double crhs_gauss33 =             N(1)*data.U(1,3);
const double crhs_gauss34 =             N(2)*data.U(2,3);
const double crhs_gauss35 =             N(3)*data.U(3,3);
const double crhs_gauss36 =             -crhs_gauss32 - crhs_gauss33 - crhs_gauss34 - crhs_gauss35;
const double crhs_gauss37 =             crhs_gauss23*crhs_gauss30 + crhs_gauss23*crhs_gauss31 + crhs_gauss36;
const double crhs_gauss38 =             data.gamma - 1;
const double crhs_gauss39 =             crhs_gauss23*crhs_gauss38;
const double crhs_gauss40 =             crhs_gauss37*crhs_gauss39;
const double crhs_gauss41 =             1.0/data.gamma;
const double crhs_gauss42 =             N(0)*data.r_ext(0) + N(1)*data.r_ext(1) + N(2)*data.r_ext(2) + N(3)*data.r_ext(3);
const double crhs_gauss43 =             pow(crhs_gauss42, 2);
const double crhs_gauss44 =             N(0)*data.f_ext(0,0) + N(1)*data.f_ext(1,0) + N(2)*data.f_ext(2,0) + N(3)*data.f_ext(3,0);
const double crhs_gauss45 =             N(0)*data.f_ext(0,1) + N(1)*data.f_ext(1,1) + N(2)*data.f_ext(2,1) + N(3)*data.f_ext(3,1);
const double crhs_gauss46 =             crhs_gauss40*data.gamma*(pow(crhs_gauss44, 2) + pow(crhs_gauss45, 2));
const double crhs_gauss47 =             0.70710678118654757*crhs_gauss24*crhs_gauss41*stab_c3*sqrt((crhs_gauss43 - 2.0*crhs_gauss46 + 2.0*sqrt(0.25*crhs_gauss43 - crhs_gauss46)*fabs(crhs_gauss42))/(pow(crhs_gauss37, 2)*pow(crhs_gauss38, 2))) + stab_c2*(sqrt(data.gamma)*sqrt(-crhs_gauss40) + sqrt(crhs_gauss29)/crhs_gauss24)/data.h;
const double crhs_gauss48 =             1.0*(N(0)*data.dUdt(0,0) + N(1)*data.dUdt(1,0) + N(2)*data.dUdt(2,0) + N(3)*data.dUdt(3,0) - crhs_gauss0 - crhs_gauss1 + crhs_gauss16 - crhs_gauss2 - crhs_gauss3)/crhs_gauss47;
const double crhs_gauss49 =             crhs_gauss23*crhs_gauss48;
const double crhs_gauss50 =             crhs_gauss22*crhs_gauss44;
const double crhs_gauss51 =             crhs_gauss15*crhs_gauss25;
const double crhs_gauss52 =             1.0*data.gamma;
const double crhs_gauss53 =             crhs_gauss23*(3.0 - crhs_gauss52);
const double crhs_gauss54 =             DN_DX(0,0)*data.U(0,2);
const double crhs_gauss55 =             DN_DX(1,0)*data.U(1,2);
const double crhs_gauss56 =             DN_DX(2,0)*data.U(2,2);
const double crhs_gauss57 =             DN_DX(3,0)*data.U(3,2);
const double crhs_gauss58 =             crhs_gauss54 + crhs_gauss55 + crhs_gauss56 + crhs_gauss57;
const double crhs_gauss59 =             crhs_gauss27*crhs_gauss58;
const double crhs_gauss60 =             1.0*crhs_gauss39;
const double crhs_gauss61 =             -crhs_gauss59*crhs_gauss60;
const double crhs_gauss62 =             DN_DX(0,0)*data.U(0,3) + DN_DX(1,0)*data.U(1,3) + DN_DX(2,0)*data.U(2,3) + DN_DX(3,0)*data.U(3,3);
const double crhs_gauss63 =             DN_DX(0,1)*data.U(0,1);
const double crhs_gauss64 =             DN_DX(1,1)*data.U(1,1);
const double crhs_gauss65 =             DN_DX(2,1)*data.U(2,1);
const double crhs_gauss66 =             DN_DX(3,1)*data.U(3,1);
const double crhs_gauss67 =             crhs_gauss63 + crhs_gauss64 + crhs_gauss65 + crhs_gauss66;
const double crhs_gauss68 =             crhs_gauss27*crhs_gauss67;
const double crhs_gauss69 =             crhs_gauss10*crhs_gauss25;
const double crhs_gauss70 =             pow(crhs_gauss22, -2);
const double crhs_gauss71 =             0.5*crhs_gauss29;
const double crhs_gauss72 =             crhs_gauss38*crhs_gauss71;
const double crhs_gauss73 =             -crhs_gauss26 + crhs_gauss72;
const double crhs_gauss74 =             crhs_gauss70*crhs_gauss73;
const double crhs_gauss75 =             crhs_gauss20*crhs_gauss27;
const double crhs_gauss76 =             crhs_gauss70*crhs_gauss75;
const double crhs_gauss77 =             crhs_gauss17*crhs_gauss74 + crhs_gauss23*crhs_gauss68 + crhs_gauss23*crhs_gauss69 - crhs_gauss25*crhs_gauss76 + crhs_gauss38*crhs_gauss62 + crhs_gauss61;
const double crhs_gauss78 =             N(0)*data.mu_sc_nodes(0);
const double crhs_gauss79 =             N(1)*data.mu_sc_nodes(1);
const double crhs_gauss80 =             N(2)*data.mu_sc_nodes(2);
const double crhs_gauss81 =             N(3)*data.mu_sc_nodes(3);
const double crhs_gauss82 =             crhs_gauss78 + crhs_gauss79 + crhs_gauss80 + crhs_gauss81 + data.mu;
const double crhs_gauss83 =             crhs_gauss23*stab_c1/pow(data.h, 2);
const double crhs_gauss84 =             1.0/(crhs_gauss47 + 1.3333333333333333*crhs_gauss82*crhs_gauss83);
const double crhs_gauss85 =             crhs_gauss84*(N(0)*data.dUdt(0,1) + N(1)*data.dUdt(1,1) + N(2)*data.dUdt(2,1) + N(3)*data.dUdt(3,1) - crhs_gauss50 + crhs_gauss51*crhs_gauss53 + crhs_gauss77);
const double crhs_gauss86 =             crhs_gauss22*crhs_gauss45;
const double crhs_gauss87 =             crhs_gauss10*crhs_gauss27;
const double crhs_gauss88 =             crhs_gauss25*crhs_gauss67;
const double crhs_gauss89 =             -crhs_gauss60*crhs_gauss88;
const double crhs_gauss90 =             DN_DX(0,1)*data.U(0,3) + DN_DX(1,1)*data.U(1,3) + DN_DX(2,1)*data.U(2,3) + DN_DX(3,1)*data.U(3,3);
const double crhs_gauss91 =             crhs_gauss15*crhs_gauss27;
const double crhs_gauss92 =             crhs_gauss25*crhs_gauss58;
const double crhs_gauss93 =             -crhs_gauss28 + crhs_gauss72;
const double crhs_gauss94 =             crhs_gauss70*crhs_gauss93;
const double crhs_gauss95 =             crhs_gauss17*crhs_gauss25;
const double crhs_gauss96 =             crhs_gauss27*crhs_gauss70;
const double crhs_gauss97 =             crhs_gauss20*crhs_gauss94 + crhs_gauss23*crhs_gauss91 + crhs_gauss23*crhs_gauss92 + crhs_gauss38*crhs_gauss90 + crhs_gauss89 - crhs_gauss95*crhs_gauss96;
const double crhs_gauss98 =             crhs_gauss84*(N(0)*data.dUdt(0,2) + N(1)*data.dUdt(1,2) + N(2)*data.dUdt(2,2) + N(3)*data.dUdt(3,2) + crhs_gauss53*crhs_gauss87 - crhs_gauss86 + crhs_gauss97);
const double crhs_gauss99 =             DN_DX(0,1)*crhs_gauss70;
const double crhs_gauss100 =             crhs_gauss17*crhs_gauss27;
const double crhs_gauss101 =             crhs_gauss20*crhs_gauss25;
const double crhs_gauss102 =             crhs_gauss82*(-crhs_gauss100 - crhs_gauss101 + crhs_gauss22*crhs_gauss58 + crhs_gauss22*crhs_gauss67);
const double crhs_gauss103 =             crhs_gauss15*crhs_gauss22 - crhs_gauss95;
const double crhs_gauss104 =             2*crhs_gauss82;
const double crhs_gauss105 =             crhs_gauss10*crhs_gauss22 - crhs_gauss75;
const double crhs_gauss106 =             (crhs_gauss103 + crhs_gauss105)*(N(0)*data.beta_sc_nodes(0) + N(1)*data.beta_sc_nodes(1) + N(2)*data.beta_sc_nodes(2) + N(3)*data.beta_sc_nodes(3) - 0.66666666666666663*crhs_gauss78 - 0.66666666666666663*crhs_gauss79 - 0.66666666666666663*crhs_gauss80 - 0.66666666666666663*crhs_gauss81 - 0.66666666666666663*data.mu);
const double crhs_gauss107 =             crhs_gauss103*crhs_gauss104 + crhs_gauss106;
const double crhs_gauss108 =             DN_DX(0,0)*crhs_gauss70;
const double crhs_gauss109 =             crhs_gauss52 - 3.0;
const double crhs_gauss110 =             crhs_gauss109*crhs_gauss51;
const double crhs_gauss111 =             -crhs_gauss110*crhs_gauss23 + crhs_gauss77;
const double crhs_gauss112 =             N(0)*crhs_gauss44;
const double crhs_gauss113 =             DN_DX(0,1)*crhs_gauss25;
const double crhs_gauss114 =             crhs_gauss113*crhs_gauss96;
const double crhs_gauss115 =             crhs_gauss23*crhs_gauss75;
const double crhs_gauss116 =             2*crhs_gauss115;
const double crhs_gauss117 =             -crhs_gauss116*crhs_gauss25 + crhs_gauss68 + crhs_gauss69;
const double crhs_gauss118 =             N(0)*crhs_gauss70;
const double crhs_gauss119 =             1.0*crhs_gauss38;
const double crhs_gauss120 =             crhs_gauss17*crhs_gauss23;
const double crhs_gauss121 =             crhs_gauss110 + crhs_gauss119*crhs_gauss59 - 2*crhs_gauss120*crhs_gauss73;
const double crhs_gauss122 =             DN_DX(0,0)*crhs_gauss27;
const double crhs_gauss123 =             crhs_gauss101*crhs_gauss23 - crhs_gauss63 - crhs_gauss64 - crhs_gauss65 - crhs_gauss66;
const double crhs_gauss124 =             N(0)*crhs_gauss123;
const double crhs_gauss125 =             crhs_gauss52 - 1.0;
const double crhs_gauss126 =             crhs_gauss100*crhs_gauss23 - crhs_gauss54 - crhs_gauss55 - crhs_gauss56 - crhs_gauss57;
const double crhs_gauss127 =             N(0)*crhs_gauss126;
const double crhs_gauss128 =             crhs_gauss23*crhs_gauss98;
const double crhs_gauss129 =             crhs_gauss23*crhs_gauss95;
const double crhs_gauss130 =             -crhs_gauss11 - crhs_gauss12 + crhs_gauss129 - crhs_gauss13 - crhs_gauss14;
const double crhs_gauss131 =             N(0)*crhs_gauss130;
const double crhs_gauss132 =             DN_DX(0,0)*crhs_gauss25;
const double crhs_gauss133 =             DN_DX(0,1)*crhs_gauss27;
const double crhs_gauss134 =             crhs_gauss115 - crhs_gauss6 - crhs_gauss7 - crhs_gauss8 - crhs_gauss9;
const double crhs_gauss135 =             N(0)*crhs_gauss134;
const double crhs_gauss136 =             crhs_gauss133 - crhs_gauss135;
const double crhs_gauss137 =             crhs_gauss23*crhs_gauss85;
const double crhs_gauss138 =             (N(0)*data.lamb_sc_nodes(0) + N(1)*data.lamb_sc_nodes(1) + N(2)*data.lamb_sc_nodes(2) + N(3)*data.lamb_sc_nodes(3) + data.lambda)/data.c_v;
const double crhs_gauss139 =             crhs_gauss22*crhs_gauss42;
const double crhs_gauss140 =             crhs_gauss25*crhs_gauss44;
const double crhs_gauss141 =             crhs_gauss27*crhs_gauss45;
const double crhs_gauss142 =             crhs_gauss62*data.gamma;
const double crhs_gauss143 =             crhs_gauss23*crhs_gauss25;
const double crhs_gauss144 =             crhs_gauss90*data.gamma;
const double crhs_gauss145 =             crhs_gauss23*crhs_gauss27;
const double crhs_gauss146 =             1.0*crhs_gauss92;
const double crhs_gauss147 =             1.0*crhs_gauss68;
const double crhs_gauss148 =             crhs_gauss147*crhs_gauss25;
const double crhs_gauss149 =             crhs_gauss26*crhs_gauss60;
const double crhs_gauss150 =             crhs_gauss32 + crhs_gauss33 + crhs_gauss34 + crhs_gauss35;
const double crhs_gauss151 =             crhs_gauss38*(crhs_gauss150 - crhs_gauss23*(crhs_gauss30 + crhs_gauss31));
const double crhs_gauss152 =             crhs_gauss150 + crhs_gauss151;
const double crhs_gauss153 =             crhs_gauss28*crhs_gauss60;
const double crhs_gauss154 =             -crhs_gauss151 + crhs_gauss36;
const double crhs_gauss155 =             crhs_gauss154 + crhs_gauss39*crhs_gauss71;
const double crhs_gauss156 =             crhs_gauss155*crhs_gauss70;
const double crhs_gauss157 =             (N(0)*data.dUdt(0,3) + N(1)*data.dUdt(1,3) + N(2)*data.dUdt(2,3) + N(3)*data.dUdt(3,3) + crhs_gauss10*crhs_gauss23*(crhs_gauss152 - crhs_gauss153) - crhs_gauss139 - crhs_gauss140 - crhs_gauss141 + crhs_gauss142*crhs_gauss143 + crhs_gauss144*crhs_gauss145 - crhs_gauss146*crhs_gauss38*crhs_gauss96 - crhs_gauss148*crhs_gauss38*crhs_gauss70 + crhs_gauss15*crhs_gauss23*(-crhs_gauss149 + crhs_gauss152) + crhs_gauss155*crhs_gauss76 + crhs_gauss156*crhs_gauss95)/(crhs_gauss138*crhs_gauss41*crhs_gauss83 + crhs_gauss47);
const double crhs_gauss158 =             crhs_gauss119*crhs_gauss157;
const double crhs_gauss159 =             crhs_gauss104*crhs_gauss105 + crhs_gauss106;
const double crhs_gauss160 =             crhs_gauss109*crhs_gauss87;
const double crhs_gauss161 =             -crhs_gauss160*crhs_gauss23 + crhs_gauss97;
const double crhs_gauss162 =             N(0)*crhs_gauss45;
const double crhs_gauss163 =             crhs_gauss132*crhs_gauss96;
const double crhs_gauss164 =             2*crhs_gauss129;
const double crhs_gauss165 =             -crhs_gauss164*crhs_gauss27 + crhs_gauss91 + crhs_gauss92;
const double crhs_gauss166 =             crhs_gauss20*crhs_gauss23;
const double crhs_gauss167 =             crhs_gauss119*crhs_gauss88 + crhs_gauss160 - 2*crhs_gauss166*crhs_gauss93;
const double crhs_gauss168 =             -crhs_gauss131 + crhs_gauss132;
const double crhs_gauss169 =             crhs_gauss139 + crhs_gauss140 + crhs_gauss141;
const double crhs_gauss170 =             crhs_gauss102*crhs_gauss145 + crhs_gauss107*crhs_gauss143 + crhs_gauss138*(crhs_gauss120*crhs_gauss26 + crhs_gauss120*crhs_gauss28 - crhs_gauss150*crhs_gauss17 + crhs_gauss22*crhs_gauss62 - crhs_gauss51 - crhs_gauss59);
const double crhs_gauss171 =             crhs_gauss102*crhs_gauss143 + crhs_gauss138*(-crhs_gauss150*crhs_gauss20 + crhs_gauss166*crhs_gauss26 + crhs_gauss166*crhs_gauss28 + crhs_gauss22*crhs_gauss90 - crhs_gauss87 - crhs_gauss88) + crhs_gauss145*crhs_gauss159;
const double crhs_gauss172 =             crhs_gauss142*crhs_gauss25;
const double crhs_gauss173 =             crhs_gauss144*crhs_gauss27;
const double crhs_gauss174 =             crhs_gauss149 + crhs_gauss154;
const double crhs_gauss175 =             crhs_gauss153 + crhs_gauss154;
const double crhs_gauss176 =             -crhs_gauss10*crhs_gauss175 + crhs_gauss115*crhs_gauss155 + crhs_gauss129*crhs_gauss155 - crhs_gauss146*crhs_gauss27*crhs_gauss39 - crhs_gauss148*crhs_gauss39 - crhs_gauss15*crhs_gauss174 + crhs_gauss172 + crhs_gauss173;
const double crhs_gauss177 =             N(0)*crhs_gauss23;
const double crhs_gauss178 =             -2.0*crhs_gauss115*crhs_gauss25 + crhs_gauss147 + 1.0*crhs_gauss69;
const double crhs_gauss179 =             crhs_gauss118*crhs_gauss38;
const double crhs_gauss180 =             crhs_gauss174*crhs_gauss23;
const double crhs_gauss181 =             3.0*crhs_gauss39;
const double crhs_gauss182 =             2.0*crhs_gauss39;
const double crhs_gauss183 =             crhs_gauss155 + crhs_gauss182*crhs_gauss26;
const double crhs_gauss184 =             crhs_gauss120*crhs_gauss183 + crhs_gauss142 - crhs_gauss181*crhs_gauss51 + crhs_gauss61;
const double crhs_gauss185 =             -2.0*crhs_gauss129*crhs_gauss27 + crhs_gauss146 + 1.0*crhs_gauss91;
const double crhs_gauss186 =             crhs_gauss175*crhs_gauss23;
const double crhs_gauss187 =             crhs_gauss155 + crhs_gauss182*crhs_gauss28;
const double crhs_gauss188 =             crhs_gauss144 + crhs_gauss166*crhs_gauss187 - crhs_gauss181*crhs_gauss87 + crhs_gauss89;
const double crhs_gauss189 =             crhs_gauss157*crhs_gauss23*crhs_gauss52;
const double crhs_gauss190 =             crhs_gauss154 + crhs_gauss29*crhs_gauss39;
const double crhs_gauss191 =             crhs_gauss15*crhs_gauss183 - crhs_gauss164*crhs_gauss190 - crhs_gauss172 + crhs_gauss182*crhs_gauss27*crhs_gauss92;
const double crhs_gauss192 =             crhs_gauss10*crhs_gauss187 - crhs_gauss116*crhs_gauss190 - crhs_gauss173 + crhs_gauss182*crhs_gauss25*crhs_gauss68;
const double crhs_gauss193 =             N(1)*crhs_gauss4;
const double crhs_gauss194 =             DN_DX(1,1)*crhs_gauss70;
const double crhs_gauss195 =             DN_DX(1,0)*crhs_gauss70;
const double crhs_gauss196 =             N(1)*crhs_gauss44;
const double crhs_gauss197 =             DN_DX(1,1)*crhs_gauss25;
const double crhs_gauss198 =             crhs_gauss197*crhs_gauss96;
const double crhs_gauss199 =             N(1)*crhs_gauss70;
const double crhs_gauss200 =             DN_DX(1,0)*crhs_gauss27;
const double crhs_gauss201 =             N(1)*crhs_gauss123;
const double crhs_gauss202 =             N(1)*crhs_gauss126;
const double crhs_gauss203 =             N(1)*crhs_gauss130;
const double crhs_gauss204 =             DN_DX(1,0)*crhs_gauss25;
const double crhs_gauss205 =             DN_DX(1,1)*crhs_gauss27;
const double crhs_gauss206 =             N(1)*crhs_gauss134;
const double crhs_gauss207 =             crhs_gauss205 - crhs_gauss206;
const double crhs_gauss208 =             N(1)*crhs_gauss45;
const double crhs_gauss209 =             crhs_gauss204*crhs_gauss96;
const double crhs_gauss210 =             -crhs_gauss203 + crhs_gauss204;
const double crhs_gauss211 =             N(1)*crhs_gauss23;
const double crhs_gauss212 =             crhs_gauss199*crhs_gauss38;
const double crhs_gauss213 =             N(2)*crhs_gauss4;
const double crhs_gauss214 =             DN_DX(2,1)*crhs_gauss70;
const double crhs_gauss215 =             DN_DX(2,0)*crhs_gauss70;
const double crhs_gauss216 =             N(2)*crhs_gauss44;
const double crhs_gauss217 =             DN_DX(2,1)*crhs_gauss25;
const double crhs_gauss218 =             crhs_gauss217*crhs_gauss96;
const double crhs_gauss219 =             N(2)*crhs_gauss70;
const double crhs_gauss220 =             DN_DX(2,0)*crhs_gauss27;
const double crhs_gauss221 =             N(2)*crhs_gauss123;
const double crhs_gauss222 =             N(2)*crhs_gauss126;
const double crhs_gauss223 =             N(2)*crhs_gauss130;
const double crhs_gauss224 =             DN_DX(2,0)*crhs_gauss25;
const double crhs_gauss225 =             DN_DX(2,1)*crhs_gauss27;
const double crhs_gauss226 =             N(2)*crhs_gauss134;
const double crhs_gauss227 =             crhs_gauss225 - crhs_gauss226;
const double crhs_gauss228 =             N(2)*crhs_gauss45;
const double crhs_gauss229 =             crhs_gauss224*crhs_gauss96;
const double crhs_gauss230 =             -crhs_gauss223 + crhs_gauss224;
const double crhs_gauss231 =             N(2)*crhs_gauss23;
const double crhs_gauss232 =             crhs_gauss219*crhs_gauss38;
const double crhs_gauss233 =             N(3)*crhs_gauss4;
const double crhs_gauss234 =             DN_DX(3,1)*crhs_gauss70;
const double crhs_gauss235 =             DN_DX(3,0)*crhs_gauss70;
const double crhs_gauss236 =             N(3)*crhs_gauss44;
const double crhs_gauss237 =             DN_DX(3,1)*crhs_gauss25;
const double crhs_gauss238 =             crhs_gauss237*crhs_gauss96;
const double crhs_gauss239 =             N(3)*crhs_gauss70;
const double crhs_gauss240 =             DN_DX(3,0)*crhs_gauss27;
const double crhs_gauss241 =             N(3)*crhs_gauss123;
const double crhs_gauss242 =             N(3)*crhs_gauss126;
const double crhs_gauss243 =             N(3)*crhs_gauss130;
const double crhs_gauss244 =             DN_DX(3,0)*crhs_gauss25;
const double crhs_gauss245 =             DN_DX(3,1)*crhs_gauss27;
const double crhs_gauss246 =             N(3)*crhs_gauss134;
const double crhs_gauss247 =             crhs_gauss245 - crhs_gauss246;
const double crhs_gauss248 =             N(3)*crhs_gauss45;
const double crhs_gauss249 =             crhs_gauss244*crhs_gauss96;
const double crhs_gauss250 =             -crhs_gauss243 + crhs_gauss244;
const double crhs_gauss251 =             N(3)*crhs_gauss23;
const double crhs_gauss252 =             crhs_gauss239*crhs_gauss38;
            rhs_gauss[0] = DN_DX(0,0)*crhs_gauss19 - DN_DX(0,0)*crhs_gauss85 + DN_DX(0,1)*crhs_gauss21 - DN_DX(0,1)*crhs_gauss98 - N(0)*crhs_gauss16 - crhs_gauss49*crhs_gauss5 + crhs_gauss5;
            rhs_gauss[1] = -DN_DX(0,0)*crhs_gauss158 - N(0)*crhs_gauss111 + N(0)*crhs_gauss50 - crhs_gauss102*crhs_gauss99 - crhs_gauss107*crhs_gauss108 - crhs_gauss128*(crhs_gauss113 - crhs_gauss119*crhs_gauss122 - crhs_gauss124 + crhs_gauss125*crhs_gauss127) - crhs_gauss137*(crhs_gauss109*crhs_gauss131 - crhs_gauss109*crhs_gauss132 + crhs_gauss136) - crhs_gauss48*(DN_DX(0,0)*crhs_gauss74 + crhs_gauss112 - crhs_gauss114 - crhs_gauss117*crhs_gauss118 + crhs_gauss118*crhs_gauss121);
            rhs_gauss[2] = -DN_DX(0,1)*crhs_gauss158 - N(0)*crhs_gauss161 + N(0)*crhs_gauss86 - crhs_gauss102*crhs_gauss108 - crhs_gauss128*(-crhs_gauss109*crhs_gauss133 + crhs_gauss109*crhs_gauss135 + crhs_gauss168) - crhs_gauss137*(-crhs_gauss113*crhs_gauss119 + crhs_gauss122 + crhs_gauss124*crhs_gauss125 - crhs_gauss127) - crhs_gauss159*crhs_gauss99 - crhs_gauss48*(DN_DX(0,1)*crhs_gauss94 - crhs_gauss118*crhs_gauss165 + crhs_gauss118*crhs_gauss167 + crhs_gauss162 - crhs_gauss163);
            rhs_gauss[3] = N(0)*crhs_gauss169 - crhs_gauss108*crhs_gauss170 - crhs_gauss171*crhs_gauss99 - crhs_gauss176*crhs_gauss177 - crhs_gauss189*(crhs_gauss136 + crhs_gauss168) - crhs_gauss48*(N(0)*crhs_gauss42 + crhs_gauss118*crhs_gauss191 + crhs_gauss118*crhs_gauss192 + crhs_gauss132*crhs_gauss156 + crhs_gauss133*crhs_gauss156) - crhs_gauss85*(-DN_DX(0,0)*crhs_gauss180 + crhs_gauss112 - crhs_gauss114*crhs_gauss119 + crhs_gauss177*crhs_gauss184 - crhs_gauss178*crhs_gauss179) - crhs_gauss98*(-DN_DX(0,1)*crhs_gauss186 - crhs_gauss119*crhs_gauss163 + crhs_gauss162 + crhs_gauss177*crhs_gauss188 - crhs_gauss179*crhs_gauss185);
            rhs_gauss[4] = DN_DX(1,0)*crhs_gauss19 - DN_DX(1,0)*crhs_gauss85 + DN_DX(1,1)*crhs_gauss21 - DN_DX(1,1)*crhs_gauss98 - N(1)*crhs_gauss16 - crhs_gauss193*crhs_gauss49 + crhs_gauss193;
            rhs_gauss[5] = -DN_DX(1,0)*crhs_gauss158 - N(1)*crhs_gauss111 + N(1)*crhs_gauss50 - crhs_gauss102*crhs_gauss194 - crhs_gauss107*crhs_gauss195 - crhs_gauss128*(-crhs_gauss119*crhs_gauss200 + crhs_gauss125*crhs_gauss202 + crhs_gauss197 - crhs_gauss201) - crhs_gauss137*(crhs_gauss109*crhs_gauss203 - crhs_gauss109*crhs_gauss204 + crhs_gauss207) - crhs_gauss48*(DN_DX(1,0)*crhs_gauss74 - crhs_gauss117*crhs_gauss199 + crhs_gauss121*crhs_gauss199 + crhs_gauss196 - crhs_gauss198);
            rhs_gauss[6] = -DN_DX(1,1)*crhs_gauss158 - N(1)*crhs_gauss161 + N(1)*crhs_gauss86 - crhs_gauss102*crhs_gauss195 - crhs_gauss128*(-crhs_gauss109*crhs_gauss205 + crhs_gauss109*crhs_gauss206 + crhs_gauss210) - crhs_gauss137*(-crhs_gauss119*crhs_gauss197 + crhs_gauss125*crhs_gauss201 + crhs_gauss200 - crhs_gauss202) - crhs_gauss159*crhs_gauss194 - crhs_gauss48*(DN_DX(1,1)*crhs_gauss94 - crhs_gauss165*crhs_gauss199 + crhs_gauss167*crhs_gauss199 + crhs_gauss208 - crhs_gauss209);
            rhs_gauss[7] = N(1)*crhs_gauss169 - crhs_gauss170*crhs_gauss195 - crhs_gauss171*crhs_gauss194 - crhs_gauss176*crhs_gauss211 - crhs_gauss189*(crhs_gauss207 + crhs_gauss210) - crhs_gauss48*(N(1)*crhs_gauss42 + crhs_gauss156*crhs_gauss204 + crhs_gauss156*crhs_gauss205 + crhs_gauss191*crhs_gauss199 + crhs_gauss192*crhs_gauss199) - crhs_gauss85*(-DN_DX(1,0)*crhs_gauss180 - crhs_gauss119*crhs_gauss198 - crhs_gauss178*crhs_gauss212 + crhs_gauss184*crhs_gauss211 + crhs_gauss196) - crhs_gauss98*(-DN_DX(1,1)*crhs_gauss186 - crhs_gauss119*crhs_gauss209 - crhs_gauss185*crhs_gauss212 + crhs_gauss188*crhs_gauss211 + crhs_gauss208);
            rhs_gauss[8] = DN_DX(2,0)*crhs_gauss19 - DN_DX(2,0)*crhs_gauss85 + DN_DX(2,1)*crhs_gauss21 - DN_DX(2,1)*crhs_gauss98 - N(2)*crhs_gauss16 - crhs_gauss213*crhs_gauss49 + crhs_gauss213;
            rhs_gauss[9] = -DN_DX(2,0)*crhs_gauss158 - N(2)*crhs_gauss111 + N(2)*crhs_gauss50 - crhs_gauss102*crhs_gauss214 - crhs_gauss107*crhs_gauss215 - crhs_gauss128*(-crhs_gauss119*crhs_gauss220 + crhs_gauss125*crhs_gauss222 + crhs_gauss217 - crhs_gauss221) - crhs_gauss137*(crhs_gauss109*crhs_gauss223 - crhs_gauss109*crhs_gauss224 + crhs_gauss227) - crhs_gauss48*(DN_DX(2,0)*crhs_gauss74 - crhs_gauss117*crhs_gauss219 + crhs_gauss121*crhs_gauss219 + crhs_gauss216 - crhs_gauss218);
            rhs_gauss[10] = -DN_DX(2,1)*crhs_gauss158 - N(2)*crhs_gauss161 + N(2)*crhs_gauss86 - crhs_gauss102*crhs_gauss215 - crhs_gauss128*(-crhs_gauss109*crhs_gauss225 + crhs_gauss109*crhs_gauss226 + crhs_gauss230) - crhs_gauss137*(-crhs_gauss119*crhs_gauss217 + crhs_gauss125*crhs_gauss221 + crhs_gauss220 - crhs_gauss222) - crhs_gauss159*crhs_gauss214 - crhs_gauss48*(DN_DX(2,1)*crhs_gauss94 - crhs_gauss165*crhs_gauss219 + crhs_gauss167*crhs_gauss219 + crhs_gauss228 - crhs_gauss229);
            rhs_gauss[11] = N(2)*crhs_gauss169 - crhs_gauss170*crhs_gauss215 - crhs_gauss171*crhs_gauss214 - crhs_gauss176*crhs_gauss231 - crhs_gauss189*(crhs_gauss227 + crhs_gauss230) - crhs_gauss48*(N(2)*crhs_gauss42 + crhs_gauss156*crhs_gauss224 + crhs_gauss156*crhs_gauss225 + crhs_gauss191*crhs_gauss219 + crhs_gauss192*crhs_gauss219) - crhs_gauss85*(-DN_DX(2,0)*crhs_gauss180 - crhs_gauss119*crhs_gauss218 - crhs_gauss178*crhs_gauss232 + crhs_gauss184*crhs_gauss231 + crhs_gauss216) - crhs_gauss98*(-DN_DX(2,1)*crhs_gauss186 - crhs_gauss119*crhs_gauss229 - crhs_gauss185*crhs_gauss232 + crhs_gauss188*crhs_gauss231 + crhs_gauss228);
            rhs_gauss[12] = DN_DX(3,0)*crhs_gauss19 - DN_DX(3,0)*crhs_gauss85 + DN_DX(3,1)*crhs_gauss21 - DN_DX(3,1)*crhs_gauss98 - N(3)*crhs_gauss16 - crhs_gauss233*crhs_gauss49 + crhs_gauss233;
            rhs_gauss[13] = -DN_DX(3,0)*crhs_gauss158 - N(3)*crhs_gauss111 + N(3)*crhs_gauss50 - crhs_gauss102*crhs_gauss234 - crhs_gauss107*crhs_gauss235 - crhs_gauss128*(-crhs_gauss119*crhs_gauss240 + crhs_gauss125*crhs_gauss242 + crhs_gauss237 - crhs_gauss241) - crhs_gauss137*(crhs_gauss109*crhs_gauss243 - crhs_gauss109*crhs_gauss244 + crhs_gauss247) - crhs_gauss48*(DN_DX(3,0)*crhs_gauss74 - crhs_gauss117*crhs_gauss239 + crhs_gauss121*crhs_gauss239 + crhs_gauss236 - crhs_gauss238);
            rhs_gauss[14] = -DN_DX(3,1)*crhs_gauss158 - N(3)*crhs_gauss161 + N(3)*crhs_gauss86 - crhs_gauss102*crhs_gauss235 - crhs_gauss128*(-crhs_gauss109*crhs_gauss245 + crhs_gauss109*crhs_gauss246 + crhs_gauss250) - crhs_gauss137*(-crhs_gauss119*crhs_gauss237 + crhs_gauss125*crhs_gauss241 + crhs_gauss240 - crhs_gauss242) - crhs_gauss159*crhs_gauss234 - crhs_gauss48*(DN_DX(3,1)*crhs_gauss94 - crhs_gauss165*crhs_gauss239 + crhs_gauss167*crhs_gauss239 + crhs_gauss248 - crhs_gauss249);
            rhs_gauss[15] = N(3)*crhs_gauss169 - crhs_gauss170*crhs_gauss235 - crhs_gauss171*crhs_gauss234 - crhs_gauss176*crhs_gauss251 - crhs_gauss189*(crhs_gauss247 + crhs_gauss250) - crhs_gauss48*(N(3)*crhs_gauss42 + crhs_gauss156*crhs_gauss244 + crhs_gauss156*crhs_gauss245 + crhs_gauss191*crhs_gauss239 + crhs_gauss192*crhs_gauss239) - crhs_gauss85*(-DN_DX(3,0)*crhs_gauss180 - crhs_gauss119*crhs_gauss238 - crhs_gauss178*crhs_gauss252 + crhs_gauss184*crhs_gauss251 + crhs_gauss236) - crhs_gauss98*(-DN_DX(3,1)*crhs_gauss186 - crhs_gauss119*crhs_gauss249 - crhs_gauss185*crhs_gauss252 + crhs_gauss188*crhs_gauss251 + crhs_gauss248);


            rRightHandSideBoundedVector += w * detJ * rhs_gauss;
        }
    }

    KRATOS_CATCH("")
}


template <>
void CompressibleNavierStokesExplicit<2,4>::CalculateMassMatrix(
    MatrixType &rMassMatrix,
    const ProcessInfo &rCurrentProcessInfo)
{
    const auto& r_geometry = GetGeometry();
    const auto& gauss_points = r_geometry.IntegrationPoints(GetIntegrationMethod());

    Vector N;
    Matrix J;
    Matrix Jinv;

    c_matrix<double, NumNodes, NumNodes> M = ZeroMatrix(NumNodes, NumNodes);
    for(const auto& gauss_point: gauss_points)
    {
        const double w = gauss_point.Weight();
        r_geometry.ShapeFunctionsValues(N, gauss_point.Coordinates());

        double detJ;
        r_geometry.Jacobian(J, gauss_point.Coordinates());
        MathUtils<double>::InvertMatrix(J, Jinv, detJ);

        noalias(M) += outer_prod(N, N) * detJ * w;
    }

    // Distributing 4x4 matrix to 16x16 matrix
    rMassMatrix = ZeroMatrix(DofSize, DofSize);
    for(std::size_t i_dof=0; i_dof < BlockSize; ++i_dof)
    {
        for(std::size_t i_node=0; i_node < NumNodes; ++i_node)
        {
            const std::size_t I = i_dof*BlockSize + i_node;
            for(std::size_t j_node=0; j_node < NumNodes; ++j_node)
            {
                const std::size_t J = i_dof*BlockSize + j_node;
                rMassMatrix(I, J) = M(i_node, j_node);
            }
        }
    }
}

///////////////////////////////////////////////////////////////////////////////////////////////////
// Class template instantiation

template class CompressibleNavierStokesExplicit<2,4>;

}
